!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=335)}([function(e,t,n){var r=n(2),i=n(18),o=n(11),s=n(12),a=n(19),c=function(e,t,n){var l,u,d,f,h=e&c.F,v=e&c.G,p=e&c.S,m=e&c.P,g=e&c.B,y=v?r:p?r[t]||(r[t]={}):(r[t]||{}).prototype,_=v?i:i[t]||(i[t]={}),S=_.prototype||(_.prototype={});for(l in v&&(n=t),n)d=((u=!h&&y&&void 0!==y[l])?y:n)[l],f=g&&u?a(d,r):m&&"function"==typeof d?a(Function.call,d):d,y&&s(y,l,d,e&c.U),_[l]!=d&&o(_,l,f),m&&S[l]!=d&&(S[l]=d)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,n){var r=n(4);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var r=n(48)("wks"),i=n(33),o=n(2).Symbol,s="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=s&&o[e]||(s?o:i)("Symbol."+e))}).store=r},function(e,t,n){var r=n(21),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){e.exports=!n(3)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(1),i=n(97),o=n(23),s=Object.defineProperty;t.f=n(7)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(24);e.exports=function(e){return Object(r(e))}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(8),i=n(32);e.exports=n(7)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(2),i=n(11),o=n(14),s=n(33)("src"),a=n(136),c=(""+a).split("toString");n(18).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,n,a){var l="function"==typeof n;l&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(l&&(o(n,s)||i(n,s,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:a?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[s]||a.call(this)}))},function(e,t,n){var r=n(0),i=n(3),o=n(24),s=/"/g,a=function(e,t,n,r){var i=String(o(e)),a="<"+t;return""!==n&&(a+=" "+n+'="'+String(r).replace(s,"&quot;")+'"'),a+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(a),r(r.P+r.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(49),i=n(24);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(50),i=n(32),o=n(15),s=n(23),a=n(14),c=n(97),l=Object.getOwnPropertyDescriptor;t.f=n(7)?l:function(e,t){if(e=o(e),t=s(t,!0),c)try{return l(e,t)}catch(e){}if(a(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(14),i=n(9),o=n(69)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t){var n=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(10);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){"use strict";var r=n(3);e.exports=function(e,t){return!!e&&r((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,n){var r=n(4);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(0),i=n(18),o=n(3);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],s={};s[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",s)}},function(e,t,n){var r=n(19),i=n(49),o=n(9),s=n(6),a=n(85);e.exports=function(e,t){var n=1==e,c=2==e,l=3==e,u=4==e,d=6==e,f=5==e||d,h=t||a;return function(t,a,v){for(var p,m,g=o(t),y=i(g),_=r(a,v,3),S=s(y.length),C=0,E=n?h(t,S):c?h(t,0):void 0;S>C;C++)if((f||C in y)&&(m=_(p=y[C],C,g),e))if(n)E[C]=m;else if(m)switch(e){case 3:return!0;case 5:return p;case 6:return C;case 2:E.push(p)}else if(u)return!1;return d?-1:l||u?u:E}}},function(e,t,n){"use strict";if(n(7)){var r=n(29),i=n(2),o=n(3),s=n(0),a=n(63),c=n(93),l=n(19),u=n(39),d=n(32),f=n(11),h=n(41),v=n(21),p=n(6),m=n(125),g=n(35),y=n(23),_=n(14),S=n(45),C=n(4),E=n(9),I=n(82),T=n(36),R=n(17),b=n(37).f,O=n(84),k=n(33),A=n(5),w=n(26),M=n(53),P=n(52),D=n(87),N=n(47),x=n(58),L=n(38),F=n(86),V=n(114),j=n(8),U=n(16),G=j.f,H=U.f,q=i.RangeError,B=i.TypeError,W=i.Uint8Array,K=Array.prototype,z=c.ArrayBuffer,J=c.DataView,Y=w(0),Q=w(2),$=w(3),X=w(4),Z=w(5),ee=w(6),te=M(!0),ne=M(!1),re=D.values,ie=D.keys,oe=D.entries,se=K.lastIndexOf,ae=K.reduce,ce=K.reduceRight,le=K.join,ue=K.sort,de=K.slice,fe=K.toString,he=K.toLocaleString,ve=A("iterator"),pe=A("toStringTag"),me=k("typed_constructor"),ge=k("def_constructor"),ye=a.CONSTR,_e=a.TYPED,Se=a.VIEW,Ce=w(1,(function(e,t){return be(P(e,e[ge]),t)})),Ee=o((function(){return 1===new W(new Uint16Array([1]).buffer)[0]})),Ie=!!W&&!!W.prototype.set&&o((function(){new W(1).set({})})),Te=function(e,t){var n=v(e);if(n<0||n%t)throw q("Wrong offset!");return n},Re=function(e){if(C(e)&&_e in e)return e;throw B(e+" is not a typed array!")},be=function(e,t){if(!C(e)||!(me in e))throw B("It is not a typed array constructor!");return new e(t)},Oe=function(e,t){return ke(P(e,e[ge]),t)},ke=function(e,t){for(var n=0,r=t.length,i=be(e,r);r>n;)i[n]=t[n++];return i},Ae=function(e,t,n){G(e,t,{get:function(){return this._d[n]}})},we=function(e){var t,n,r,i,o,s,a=E(e),c=arguments.length,u=c>1?arguments[1]:void 0,d=void 0!==u,f=O(a);if(null!=f&&!I(f)){for(s=f.call(a),r=[],t=0;!(o=s.next()).done;t++)r.push(o.value);a=r}for(d&&c>2&&(u=l(u,arguments[2],2)),t=0,n=p(a.length),i=be(this,n);n>t;t++)i[t]=d?u(a[t],t):a[t];return i},Me=function(){for(var e=0,t=arguments.length,n=be(this,t);t>e;)n[e]=arguments[e++];return n},Pe=!!W&&o((function(){he.call(new W(1))})),De=function(){return he.apply(Pe?de.call(Re(this)):Re(this),arguments)},Ne={copyWithin:function(e,t){return V.call(Re(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return X(Re(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return F.apply(Re(this),arguments)},filter:function(e){return Oe(this,Q(Re(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return Z(Re(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(Re(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){Y(Re(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ne(Re(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(Re(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return le.apply(Re(this),arguments)},lastIndexOf:function(e){return se.apply(Re(this),arguments)},map:function(e){return Ce(Re(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return ae.apply(Re(this),arguments)},reduceRight:function(e){return ce.apply(Re(this),arguments)},reverse:function(){for(var e,t=Re(this).length,n=Math.floor(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this},some:function(e){return $(Re(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return ue.call(Re(this),e)},subarray:function(e,t){var n=Re(this),r=n.length,i=g(e,r);return new(P(n,n[ge]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,p((void 0===t?r:g(t,r))-i))}},xe=function(e,t){return Oe(this,de.call(Re(this),e,t))},Le=function(e){Re(this);var t=Te(arguments[1],1),n=this.length,r=E(e),i=p(r.length),o=0;if(i+t>n)throw q("Wrong length!");for(;o<i;)this[t+o]=r[o++]},Fe={entries:function(){return oe.call(Re(this))},keys:function(){return ie.call(Re(this))},values:function(){return re.call(Re(this))}},Ve=function(e,t){return C(e)&&e[_e]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},je=function(e,t){return Ve(e,t=y(t,!0))?d(2,e[t]):H(e,t)},Ue=function(e,t,n){return!(Ve(e,t=y(t,!0))&&C(n)&&_(n,"value"))||_(n,"get")||_(n,"set")||n.configurable||_(n,"writable")&&!n.writable||_(n,"enumerable")&&!n.enumerable?G(e,t,n):(e[t]=n.value,e)};ye||(U.f=je,j.f=Ue),s(s.S+s.F*!ye,"Object",{getOwnPropertyDescriptor:je,defineProperty:Ue}),o((function(){fe.call({})}))&&(fe=he=function(){return le.call(this)});var Ge=h({},Ne);h(Ge,Fe),f(Ge,ve,Fe.values),h(Ge,{slice:xe,set:Le,constructor:function(){},toString:fe,toLocaleString:De}),Ae(Ge,"buffer","b"),Ae(Ge,"byteOffset","o"),Ae(Ge,"byteLength","l"),Ae(Ge,"length","e"),G(Ge,pe,{get:function(){return this[_e]}}),e.exports=function(e,t,n,c){var l=e+((c=!!c)?"Clamped":"")+"Array",d="get"+e,h="set"+e,v=i[l],g=v||{},y=v&&R(v),_=!v||!a.ABV,E={},I=v&&v.prototype,O=function(e,n){G(e,n,{get:function(){return function(e,n){var r=e._d;return r.v[d](n*t+r.o,Ee)}(this,n)},set:function(e){return function(e,n,r){var i=e._d;c&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[h](n*t+i.o,r,Ee)}(this,n,e)},enumerable:!0})};_?(v=n((function(e,n,r,i){u(e,v,l,"_d");var o,s,a,c,d=0,h=0;if(C(n)){if(!(n instanceof z||"ArrayBuffer"==(c=S(n))||"SharedArrayBuffer"==c))return _e in n?ke(v,n):we.call(v,n);o=n,h=Te(r,t);var g=n.byteLength;if(void 0===i){if(g%t)throw q("Wrong length!");if((s=g-h)<0)throw q("Wrong length!")}else if((s=p(i)*t)+h>g)throw q("Wrong length!");a=s/t}else a=m(n),o=new z(s=a*t);for(f(e,"_d",{b:o,o:h,l:s,e:a,v:new J(o)});d<a;)O(e,d++)})),I=v.prototype=T(Ge),f(I,"constructor",v)):o((function(){v(1)}))&&o((function(){new v(-1)}))&&x((function(e){new v,new v(null),new v(1.5),new v(e)}),!0)||(v=n((function(e,n,r,i){var o;return u(e,v,l),C(n)?n instanceof z||"ArrayBuffer"==(o=S(n))||"SharedArrayBuffer"==o?void 0!==i?new g(n,Te(r,t),i):void 0!==r?new g(n,Te(r,t)):new g(n):_e in n?ke(v,n):we.call(v,n):new g(m(n))})),Y(y!==Function.prototype?b(g).concat(b(y)):b(g),(function(e){e in v||f(v,e,g[e])})),v.prototype=I,r||(I.constructor=v));var k=I[ve],A=!!k&&("values"==k.name||null==k.name),w=Fe.values;f(v,me,!0),f(I,_e,l),f(I,Se,!0),f(I,ge,v),(c?new v(1)[pe]==l:pe in I)||G(I,pe,{get:function(){return l}}),E[l]=v,s(s.G+s.W+s.F*(v!=g),E),s(s.S,l,{BYTES_PER_ELEMENT:t}),s(s.S+s.F*o((function(){g.of.call(v,1)})),l,{from:we,of:Me}),"BYTES_PER_ELEMENT"in I||f(I,"BYTES_PER_ELEMENT",t),s(s.P,l,Ne),L(l),s(s.P+s.F*Ie,l,{set:Le}),s(s.P+s.F*!A,l,Fe),r||I.toString==fe||(I.toString=fe),s(s.P+s.F*o((function(){new v(1).slice()})),l,{slice:xe}),s(s.P+s.F*(o((function(){return[1,2].toLocaleString()!=new v([1,2]).toLocaleString()}))||!o((function(){I.toLocaleString.call([1,2])}))),l,{toLocaleString:De}),N[l]=A?k:w,r||A||f(I,ve,w)}}else e.exports=function(){}},function(e,t,n){var r=n(120),i=n(0),o=n(48)("metadata"),s=o.store||(o.store=new(n(123))),a=function(e,t,n){var i=s.get(e);if(!i){if(!n)return;s.set(e,i=new r)}var o=i.get(t);if(!o){if(!n)return;i.set(t,o=new r)}return o};e.exports={store:s,map:a,has:function(e,t,n){var r=a(t,n,!1);return void 0!==r&&r.has(e)},get:function(e,t,n){var r=a(t,n,!1);return void 0===r?void 0:r.get(e)},set:function(e,t,n,r){a(n,r,!0).set(e,t)},keys:function(e,t){var n=a(e,t,!1),r=[];return n&&n.forEach((function(e,t){r.push(t)})),r},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){i(i.S,"Reflect",e)}}},function(e,t){e.exports=!1},function(e,t,n){var r=n(33)("meta"),i=n(4),o=n(14),s=n(8).f,a=0,c=Object.isExtensible||function(){return!0},l=!n(3)((function(){return c(Object.preventExtensions({}))})),u=function(e){s(e,r,{value:{i:"O"+ ++a,w:{}}})},d=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!c(e))return"F";if(!t)return"E";u(e)}return e[r].i},getWeak:function(e,t){if(!o(e,r)){if(!c(e))return!0;if(!t)return!1;u(e)}return e[r].w},onFreeze:function(e){return l&&d.NEED&&c(e)&&!o(e,r)&&u(e),e}}},function(e,t,n){var r=n(5)("unscopables"),i=Array.prototype;null==i[r]&&n(11)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(99),i=n(70);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(21),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){var r=n(1),i=n(100),o=n(70),s=n(69)("IE_PROTO"),a=function(){},c=function(){var e,t=n(67)("iframe"),r=o.length;for(t.style.display="none",n(71).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;r--;)delete c.prototype[o[r]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=r(e),n=new a,a.prototype=null,n[s]=e):n=c(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(99),i=n(70).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){"use strict";var r=n(2),i=n(8),o=n(7),s=n(5)("species");e.exports=function(e){var t=r[e];o&&t&&!t[s]&&i.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(19),i=n(112),o=n(82),s=n(1),a=n(6),c=n(84),l={},u={};(t=e.exports=function(e,t,n,d,f){var h,v,p,m,g=f?function(){return e}:c(e),y=r(n,d,t?2:1),_=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(o(g)){for(h=a(e.length);h>_;_++)if((m=t?y(s(v=e[_])[0],v[1]):y(e[_]))===l||m===u)return m}else for(p=g.call(e);!(v=p.next()).done;)if((m=i(p,y,v.value,t))===l||m===u)return m}).BREAK=l,t.RETURN=u},function(e,t,n){var r=n(12);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){var r=n(4);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){"use strict";const r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map(e=>e.trim())},r.splitSections=function(e){return e.split("\nm=").map((e,t)=>(t>0?"m="+e:e).trim()+"\r\n")},r.getDescription=function(e){const t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){const t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter(e=>0===e.indexOf(t))},r.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let e=8;e<t.length;e+=2)switch(t[e]){case"raddr":n.relatedAddress=t[e+1];break;case"rport":n.relatedPort=parseInt(t[e+1],10);break;case"tcptype":n.tcpType=t[e+1];break;case"ufrag":n.ufrag=t[e+1],n.usernameFragment=t[e+1];break;default:void 0===n[t[e]]&&(n[t[e]]=t[e+1])}return n},r.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){let t=e.substr(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){const t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){const t={};let n;const r=e.substr(e.indexOf(" ")+1).split(";");for(let e=0;e<r.length;e++)n=r[e].trim().split("="),t[n[0].trim()]=n[1];return t},r.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const r=[];Object.keys(e.parameters).forEach(t=>{void 0!==e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){const t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},r.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){const t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(e=>parseInt(e,10))}},r.getMid=function(e){const t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){const t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},r.parseCryptoLine=function(e){const t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},r.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?r.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},r.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},r.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},r.getCryptoParameters=function(e,t){return r.matchPrefix(e+t,"a=crypto:").map(r.parseCryptoLine)},r.getIceParameters=function(e,t){const n=r.matchPrefix(e+t,"a=ice-ufrag:")[0],i=r.matchPrefix(e+t,"a=ice-pwd:")[0];return n&&i?{usernameFragment:n.substr(12),password:i.substr(10)}:null},r.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},r.parseRtpParameters=function(e){const t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" ");for(let i=3;i<n.length;i++){const o=n[i],s=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){const n=r.parseRtpMap(s),i=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(n.parameters=i.length?r.parseFmtp(i[0]):{},n.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(n),n.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(n.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(e=>{t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){let n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(e=>{n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)});let i=0;return t.codecs.forEach(e=>{e.maxptime>i&&(i=e.maxptime)}),i>0&&(n+="a=maxptime:"+i+"\r\n"),t.headerExtensions&&t.headerExtensions.forEach(e=>{n+=r.writeExtmap(e)}),n},r.parseRtpEncodingParameters=function(e){const t=[],n=r.parseRtpParameters(e),i=-1!==n.fecMechanisms.indexOf("RED"),o=-1!==n.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map(e=>r.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute),a=s.length>0&&s[0].ssrc;let c;const l=r.matchPrefix(e,"a=ssrc-group:FID").map(e=>e.substr(17).split(" ").map(e=>parseInt(e,10)));l.length>0&&l[0].length>1&&l[0][0]===a&&(c=l[0][1]),n.codecs.forEach(e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let n={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)};a&&c&&(n.rtx={ssrc:c}),t.push(n),i&&(n=JSON.parse(JSON.stringify(n)),n.fec={ssrc:a,mechanism:o?"red+ulpfec":"red"},t.push(n))}}),0===t.length&&a&&t.push({ssrc:a});let u=r.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,t.forEach(e=>{e.maxBitrate=u})),t},r.parseRtcpParameters=function(e){const t={},n=r.matchPrefix(e,"a=ssrc:").map(e=>r.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute)[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);const i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;const o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},r.parseMsid=function(e){let t;const n=r.matchPrefix(e,"a=msid:");if(1===n.length)return t=n[0].substr(7).split(" "),{stream:t[0],track:t[1]};const i=r.matchPrefix(e,"a=ssrc:").map(e=>r.parseSsrcMedia(e)).filter(e=>"msid"===e.attribute);return i.length>0?(t=i[0].value.split(" "),{stream:t[0],track:t[1]}):void 0},r.parseSctpDescription=function(e){const t=r.parseMLine(e),n=r.matchPrefix(e,"a=max-message-size:");let i;n.length>0&&(i=parseInt(n[0].substr(19),10)),isNaN(i)&&(i=65536);const o=r.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:t.fmt,maxMessageSize:i};const s=r.matchPrefix(e,"a=sctpmap:");if(s.length>0){const e=s[0].substr(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:i}}},r.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){let i;const o=void 0!==t?t:2;i=e||r.generateSessionId();return"v=0\r\no="+(n||"thisisadapterortc")+" "+i+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.getDirection=function(e,t){const n=r.splitLines(e);for(let e=0;e<n.length;e++)switch(n[e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[e].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){const t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){const t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const t=r.splitLines(e);for(let e=0;e<t.length;e++)if(t[e].length<2||"="!==t[e].charAt(1))return!1;return!0},e.exports=r},function(e,t,n){var r=n(8).f,i=n(14),o=n(5)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){var r=n(20),i=n(5)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:o?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){var r=n(0),i=n(24),o=n(3),s=n(73),a="["+s+"]",c=RegExp("^"+a+a+"*"),l=RegExp(a+a+"*$"),u=function(e,t,n){var i={},a=o((function(){return!!s[e]()||"​"!="​"[e]()})),c=i[e]=a?t(d):s[e];n&&(i[n]=c),r(r.P+r.F*a,"String",i)},d=u.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(l,"")),e};e.exports=u},function(e,t){e.exports={}},function(e,t,n){var r=n(18),i=n(2),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(29)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(20);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";var r=n(1);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){var r=n(1),i=n(10),o=n(5)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||null==(n=r(s)[o])?t:i(n)}},function(e,t,n){var r=n(15),i=n(6),o=n(35);e.exports=function(e){return function(t,n,s){var a,c=r(t),l=i(c.length),u=o(s,l);if(e&&n!=n){for(;l>u;)if((a=c[u++])!=a)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(20);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(21),i=n(24);e.exports=function(e){return function(t,n){var o,s,a=String(i(t)),c=r(n),l=a.length;return c<0||c>=l?e?"":void 0:(o=a.charCodeAt(c))<55296||o>56319||c+1===l||(s=a.charCodeAt(c+1))<56320||s>57343?e?a.charAt(c):o:e?a.slice(c,c+2):s-56320+(o-55296<<10)+65536}}},function(e,t,n){var r=n(4),i=n(20),o=n(5)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(5)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(45),i=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var o=n.call(e,t);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){"use strict";n(116);var r=n(12),i=n(11),o=n(3),s=n(24),a=n(5),c=n(88),l=a("species"),u=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();e.exports=function(e,t,n){var f=a(e),h=!o((function(){var t={};return t[f]=function(){return 7},7!=""[e](t)})),v=h?!o((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[l]=function(){return n}),n[f](""),!t})):void 0;if(!h||!v||"replace"===e&&!u||"split"===e&&!d){var p=/./[f],m=n(s,f,""[e],(function(e,t,n,r,i){return t.exec===c?h&&!i?{done:!0,value:p.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),g=m[0],y=m[1];r(String.prototype,e,g),i(RegExp.prototype,f,2==t?function(e,t){return y.call(e,this,t)}:function(e){return y.call(e,this)})}}},function(e,t,n){var r=n(2).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){"use strict";var r=n(2),i=n(0),o=n(12),s=n(41),a=n(30),c=n(40),l=n(39),u=n(4),d=n(3),f=n(58),h=n(44),v=n(74);e.exports=function(e,t,n,p,m,g){var y=r[e],_=y,S=m?"set":"add",C=_&&_.prototype,E={},I=function(e){var t=C[e];o(C,e,"delete"==e||"has"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!u(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof _&&(g||C.forEach&&!d((function(){(new _).entries().next()})))){var T=new _,R=T[S](g?{}:-0,1)!=T,b=d((function(){T.has(1)})),O=f((function(e){new _(e)})),k=!g&&d((function(){for(var e=new _,t=5;t--;)e[S](t,t);return!e.has(-0)}));O||((_=t((function(t,n){l(t,_,e);var r=v(new y,t,_);return null!=n&&c(n,m,r[S],r),r}))).prototype=C,C.constructor=_),(b||k)&&(I("delete"),I("has"),m&&I("get")),(k||R)&&I(S),g&&C.clear&&delete C.clear}else _=p.getConstructor(t,e,m,S),s(_.prototype,n),a.NEED=!0;return h(_,e),E[e]=_,i(i.G+i.W+i.F*(_!=y),E),g||p.setStrong(_,e,m),_}},function(e,t,n){for(var r,i=n(2),o=n(11),s=n(33),a=s("typed_array"),c=s("view"),l=!(!i.ArrayBuffer||!i.DataView),u=l,d=0,f="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");d<9;)(r=i[f[d++]])?(o(r.prototype,a,!0),o(r.prototype,c,!0)):u=!1;e.exports={ABV:l,CONSTR:u,TYPED:a,VIEW:c}},function(e,t,n){"use strict";e.exports=n(29)||!n(3)((function(){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete n(2)[e]}))},function(e,t,n){"use strict";var r=n(0);e.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(19),s=n(40);e.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,a,c=arguments[1];return i(this),(t=void 0!==c)&&i(c),null==e?new this:(n=[],t?(r=0,a=o(c,arguments[2],2),s(e,!1,(function(e){n.push(a(e,r++))}))):s(e,!1,n.push,n),new this(n))}})}},function(e,t,n){var r=n(4),i=n(2).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(2),i=n(18),o=n(29),s=n(98),a=n(8).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:s.f(e)})}},function(e,t,n){var r=n(48)("keys"),i=n(33);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(2).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(4),i=n(1),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(19)(Function.call,n(16).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(4),i=n(72).set;e.exports=function(e,t,n){var o,s=t.constructor;return s!==n&&"function"==typeof s&&(o=s.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t,n){"use strict";var r=n(21),i=n(24);e.exports=function(e){var t=String(i(this)),n="",o=r(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:n},function(e,t,n){"use strict";var r=n(29),i=n(0),o=n(12),s=n(11),a=n(47),c=n(79),l=n(44),u=n(17),d=n(5)("iterator"),f=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,v,p,m,g){c(n,t,v);var y,_,S,C=function(e){if(!f&&e in R)return R[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},E=t+" Iterator",I="values"==p,T=!1,R=e.prototype,b=R[d]||R["@@iterator"]||p&&R[p],O=b||C(p),k=p?I?C("entries"):O:void 0,A="Array"==t&&R.entries||b;if(A&&(S=u(A.call(new e)))!==Object.prototype&&S.next&&(l(S,E,!0),r||"function"==typeof S[d]||s(S,d,h)),I&&b&&"values"!==b.name&&(T=!0,O=function(){return b.call(this)}),r&&!g||!f&&!T&&R[d]||s(R,d,O),a[t]=O,a[E]=h,p)if(y={values:I?O:C("values"),keys:m?O:C("keys"),entries:k},g)for(_ in y)_ in R||o(R,_,y[_]);else i(i.P+i.F*(f||T),t,y);return y}},function(e,t,n){"use strict";var r=n(36),i=n(32),o=n(44),s={};n(11)(s,n(5)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(s,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(57),i=n(24);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},function(e,t,n){var r=n(5)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){var r=n(47),i=n(5)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){"use strict";var r=n(8),i=n(32);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(45),i=n(5)("iterator"),o=n(47);e.exports=n(18).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){var r=n(225);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){"use strict";var r=n(9),i=n(35),o=n(6);e.exports=function(e){for(var t=r(this),n=o(t.length),s=arguments.length,a=i(s>1?arguments[1]:void 0,n),c=s>2?arguments[2]:void 0,l=void 0===c?n:i(c,n);l>a;)t[a++]=e;return t}},function(e,t,n){"use strict";var r=n(31),i=n(115),o=n(47),s=n(15);e.exports=n(78)(Array,"Array",(function(e,t){this._t=s(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r,i,o=n(51),s=RegExp.prototype.exec,a=String.prototype.replace,c=s,l=(r=/a/,i=/b*/g,s.call(r,"a"),s.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),u=void 0!==/()??/.exec("")[1];(l||u)&&(c=function(e){var t,n,r,i,c=this;return u&&(n=new RegExp("^"+c.source+"$(?!\\s)",o.call(c))),l&&(t=c.lastIndex),r=s.call(c,e),l&&r&&(c.lastIndex=c.global?r.index+r[0].length:t),u&&r&&r.length>1&&a.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r}),e.exports=c},function(e,t,n){"use strict";var r=n(56)(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r,i,o,s=n(19),a=n(105),c=n(71),l=n(67),u=n(2),d=u.process,f=u.setImmediate,h=u.clearImmediate,v=u.MessageChannel,p=u.Dispatch,m=0,g={},y=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},_=function(e){y.call(e.data)};f&&h||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return g[++m]=function(){a("function"==typeof e?e:Function(e),t)},r(m),m},h=function(e){delete g[e]},"process"==n(20)(d)?r=function(e){d.nextTick(s(y,e,1))}:p&&p.now?r=function(e){p.now(s(y,e,1))}:v?(o=(i=new v).port2,i.port1.onmessage=_,r=s(o.postMessage,o,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(r=function(e){u.postMessage(e+"","*")},u.addEventListener("message",_,!1)):r="onreadystatechange"in l("script")?function(e){c.appendChild(l("script")).onreadystatechange=function(){c.removeChild(this),y.call(e)}}:function(e){setTimeout(s(y,e,1),0)}),e.exports={set:f,clear:h}},function(e,t,n){var r=n(2),i=n(90).set,o=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,c="process"==n(20)(s);e.exports=function(){var e,t,n,l=function(){var r,i;for(c&&(r=s.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(c)n=function(){s.nextTick(l)};else if(!o||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var u=a.resolve(void 0);n=function(){u.then(l)}}else n=function(){i.call(r,l)};else{var d=!0,f=document.createTextNode("");new o(l).observe(f,{characterData:!0}),n=function(){f.data=d=!d}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t,n){"use strict";var r=n(10);function i(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new i(e)}},function(e,t,n){"use strict";var r=n(2),i=n(7),o=n(29),s=n(63),a=n(11),c=n(41),l=n(3),u=n(39),d=n(21),f=n(6),h=n(125),v=n(37).f,p=n(8).f,m=n(86),g=n(44),y=r.ArrayBuffer,_=r.DataView,S=r.Math,C=r.RangeError,E=r.Infinity,I=y,T=S.abs,R=S.pow,b=S.floor,O=S.log,k=S.LN2,A=i?"_b":"buffer",w=i?"_l":"byteLength",M=i?"_o":"byteOffset";function P(e,t,n){var r,i,o,s=new Array(n),a=8*n-t-1,c=(1<<a)-1,l=c>>1,u=23===t?R(2,-24)-R(2,-77):0,d=0,f=e<0||0===e&&1/e<0?1:0;for((e=T(e))!=e||e===E?(i=e!=e?1:0,r=c):(r=b(O(e)/k),e*(o=R(2,-r))<1&&(r--,o*=2),(e+=r+l>=1?u/o:u*R(2,1-l))*o>=2&&(r++,o/=2),r+l>=c?(i=0,r=c):r+l>=1?(i=(e*o-1)*R(2,t),r+=l):(i=e*R(2,l-1)*R(2,t),r=0));t>=8;s[d++]=255&i,i/=256,t-=8);for(r=r<<t|i,a+=t;a>0;s[d++]=255&r,r/=256,a-=8);return s[--d]|=128*f,s}function D(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,s=o>>1,a=i-7,c=n-1,l=e[c--],u=127&l;for(l>>=7;a>0;u=256*u+e[c],c--,a-=8);for(r=u&(1<<-a)-1,u>>=-a,a+=t;a>0;r=256*r+e[c],c--,a-=8);if(0===u)u=1-s;else{if(u===o)return r?NaN:l?-E:E;r+=R(2,t),u-=s}return(l?-1:1)*r*R(2,u-t)}function N(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function x(e){return[255&e]}function L(e){return[255&e,e>>8&255]}function F(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function V(e){return P(e,52,8)}function j(e){return P(e,23,4)}function U(e,t,n){p(e.prototype,t,{get:function(){return this[n]}})}function G(e,t,n,r){var i=h(+n);if(i+t>e[w])throw C("Wrong index!");var o=e[A]._b,s=i+e[M],a=o.slice(s,s+t);return r?a:a.reverse()}function H(e,t,n,r,i,o){var s=h(+n);if(s+t>e[w])throw C("Wrong index!");for(var a=e[A]._b,c=s+e[M],l=r(+i),u=0;u<t;u++)a[c+u]=l[o?u:t-u-1]}if(s.ABV){if(!l((function(){y(1)}))||!l((function(){new y(-1)}))||l((function(){return new y,new y(1.5),new y(NaN),"ArrayBuffer"!=y.name}))){for(var q,B=(y=function(e){return u(this,y),new I(h(e))}).prototype=I.prototype,W=v(I),K=0;W.length>K;)(q=W[K++])in y||a(y,q,I[q]);o||(B.constructor=y)}var z=new _(new y(2)),J=_.prototype.setInt8;z.setInt8(0,2147483648),z.setInt8(1,2147483649),!z.getInt8(0)&&z.getInt8(1)||c(_.prototype,{setInt8:function(e,t){J.call(this,e,t<<24>>24)},setUint8:function(e,t){J.call(this,e,t<<24>>24)}},!0)}else y=function(e){u(this,y,"ArrayBuffer");var t=h(e);this._b=m.call(new Array(t),0),this[w]=t},_=function(e,t,n){u(this,_,"DataView"),u(e,y,"DataView");var r=e[w],i=d(t);if(i<0||i>r)throw C("Wrong offset!");if(i+(n=void 0===n?r-i:f(n))>r)throw C("Wrong length!");this[A]=e,this[M]=i,this[w]=n},i&&(U(y,"byteLength","_l"),U(_,"buffer","_b"),U(_,"byteLength","_l"),U(_,"byteOffset","_o")),c(_.prototype,{getInt8:function(e){return G(this,1,e)[0]<<24>>24},getUint8:function(e){return G(this,1,e)[0]},getInt16:function(e){var t=G(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=G(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return N(G(this,4,e,arguments[1]))},getUint32:function(e){return N(G(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return D(G(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return D(G(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){H(this,1,e,x,t)},setUint8:function(e,t){H(this,1,e,x,t)},setInt16:function(e,t){H(this,2,e,L,t,arguments[2])},setUint16:function(e,t){H(this,2,e,L,t,arguments[2])},setInt32:function(e,t){H(this,4,e,F,t,arguments[2])},setUint32:function(e,t){H(this,4,e,F,t,arguments[2])},setFloat32:function(e,t){H(this,4,e,j,t,arguments[2])},setFloat64:function(e,t){H(this,8,e,V,t,arguments[2])}});g(y,"ArrayBuffer"),g(_,"DataView"),a(_.prototype,s.VIEW,!0),t.ArrayBuffer=y,t.DataView=_},function(e,t,n){e.exports=n(133)},function(e,t,n){"use strict";(function(e){if(n(134),n(331),n(332),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;function t(e,t,n){e[t]||Object.defineProperty(e,t,{writable:!0,configurable:!0,value:n})}t(String.prototype,"padLeft","".padStart),t(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach((function(e){[][e]&&t(Array,e,Function.call.bind([][e]))}))}).call(this,n(96))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){e.exports=!n(7)&&!n(3)((function(){return 7!=Object.defineProperty(n(67)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){t.f=n(5)},function(e,t,n){var r=n(14),i=n(15),o=n(53)(!1),s=n(69)("IE_PROTO");e.exports=function(e,t){var n,a=i(e),c=0,l=[];for(n in a)n!=s&&r(a,n)&&l.push(n);for(;t.length>c;)r(a,n=t[c++])&&(~o(l,n)||l.push(n));return l}},function(e,t,n){var r=n(8),i=n(1),o=n(34);e.exports=n(7)?Object.defineProperties:function(e,t){i(e);for(var n,s=o(t),a=s.length,c=0;a>c;)r.f(e,n=s[c++],t[n]);return e}},function(e,t,n){var r=n(15),i=n(37).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return s.slice()}}(e):i(r(e))}},function(e,t,n){"use strict";var r=n(7),i=n(34),o=n(54),s=n(50),a=n(9),c=n(49),l=Object.assign;e.exports=!l||n(3)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r}))?function(e,t){for(var n=a(e),l=arguments.length,u=1,d=o.f,f=s.f;l>u;)for(var h,v=c(arguments[u++]),p=d?i(v).concat(d(v)):i(v),m=p.length,g=0;m>g;)h=p[g++],r&&!f.call(v,h)||(n[h]=v[h]);return n}:l},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){"use strict";var r=n(10),i=n(4),o=n(105),s=[].slice,a={},c=function(e,t,n){if(!(t in a)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";a[t]=Function("F,a","return new F("+r.join(",")+")")}return a[t](e,n)};e.exports=Function.bind||function(e){var t=r(this),n=s.call(arguments,1),a=function(){var r=n.concat(s.call(arguments));return this instanceof a?c(t,r.length,r):o(t,r,e)};return i(t.prototype)&&(a.prototype=t.prototype),a}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(2).parseInt,i=n(46).trim,o=n(73),s=/^[-+]?0[xX]/;e.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(e,t){var n=i(String(e),3);return r(n,t>>>0||(s.test(n)?16:10))}:r},function(e,t,n){var r=n(2).parseFloat,i=n(46).trim;e.exports=1/r(n(73)+"-0")!=-1/0?function(e){var t=i(String(e),3),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},function(e,t,n){var r=n(20);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},function(e,t,n){var r=n(4),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,n){var r=n(76),i=Math.pow,o=i(2,-52),s=i(2,-23),a=i(2,127)*(2-s),c=i(2,-126);e.exports=Math.fround||function(e){var t,n,i=Math.abs(e),l=r(e);return i<c?l*(i/c/s+1/o-1/o)*c*s:(n=(t=(1+s/o)*i)-(t-i))>a||n!=n?l*(1/0):l*n}},function(e,t,n){var r=n(1);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){var r=n(10),i=n(9),o=n(49),s=n(6);e.exports=function(e,t,n,a,c){r(t);var l=i(e),u=o(l),d=s(l.length),f=c?d-1:0,h=c?-1:1;if(n<2)for(;;){if(f in u){a=u[f],f+=h;break}if(f+=h,c?f<0:d<=f)throw TypeError("Reduce of empty array with no initial value")}for(;c?f>=0:d>f;f+=h)f in u&&(a=t(a,u[f],f,l));return a}},function(e,t,n){"use strict";var r=n(9),i=n(35),o=n(6);e.exports=[].copyWithin||function(e,t){var n=r(this),s=o(n.length),a=i(e,s),c=i(t,s),l=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===l?s:i(l,s))-c,s-a),d=1;for(c<a&&a<c+u&&(d=-1,c+=u-1,a+=u-1);u-- >0;)c in n?n[a]=n[c]:delete n[a],a+=d,c+=d;return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(88);n(0)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){n(7)&&"g"!=/./g.flags&&n(8).f(RegExp.prototype,"flags",{configurable:!0,get:n(51)})},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(1),i=n(4),o=n(92);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(121),i=n(42);e.exports=n(62)("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=r.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(i(this,"Map"),0===e?0:e,t)}},r,!0)},function(e,t,n){"use strict";var r=n(8).f,i=n(36),o=n(41),s=n(19),a=n(39),c=n(40),l=n(78),u=n(115),d=n(38),f=n(7),h=n(30).fastKey,v=n(42),p=f?"_s":"size",m=function(e,t){var n,r=h(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,l){var u=e((function(e,r){a(e,u,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[p]=0,null!=r&&c(r,n,e[l],e)}));return o(u.prototype,{clear:function(){for(var e=v(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[p]=0},delete:function(e){var n=v(this,t),r=m(n,e);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[p]--}return!!r},forEach:function(e){v(this,t);for(var n,r=s(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!m(v(this,t),e)}}),f&&r(u.prototype,"size",{get:function(){return v(this,t)[p]}}),u},def:function(e,t,n){var r,i,o=m(e,t);return o?o.v=n:(e._l=o={i:i=h(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[p]++,"F"!==i&&(e._i[i]=o)),e},getEntry:m,setStrong:function(e,t,n){l(e,t,(function(e,n){this._t=v(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?u(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,u(1))}),n?"entries":"values",!n,!0),d(t)}}},function(e,t,n){"use strict";var r=n(121),i=n(42);e.exports=n(62)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";var r,i=n(2),o=n(26)(0),s=n(12),a=n(30),c=n(102),l=n(124),u=n(4),d=n(42),f=n(42),h=!i.ActiveXObject&&"ActiveXObject"in i,v=a.getWeak,p=Object.isExtensible,m=l.ufstore,g=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(e){if(u(e)){var t=v(e);return!0===t?m(d(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return l.def(d(this,"WeakMap"),e,t)}},_=e.exports=n(62)("WeakMap",g,y,l,!0,!0);f&&h&&(c((r=l.getConstructor(g,"WeakMap")).prototype,y),a.NEED=!0,o(["delete","has","get","set"],(function(e){var t=_.prototype,n=t[e];s(t,e,(function(t,i){if(u(t)&&!p(t)){this._f||(this._f=new r);var o=this._f[e](t,i);return"set"==e?this:o}return n.call(this,t,i)}))})))},function(e,t,n){"use strict";var r=n(41),i=n(30).getWeak,o=n(1),s=n(4),a=n(39),c=n(40),l=n(26),u=n(14),d=n(42),f=l(5),h=l(6),v=0,p=function(e){return e._l||(e._l=new m)},m=function(){this.a=[]},g=function(e,t){return f(e.a,(function(e){return e[0]===t}))};m.prototype={get:function(e){var t=g(this,e);if(t)return t[1]},has:function(e){return!!g(this,e)},set:function(e,t){var n=g(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=h(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,o){var l=e((function(e,r){a(e,l,t,"_i"),e._t=t,e._i=v++,e._l=void 0,null!=r&&c(r,n,e[o],e)}));return r(l.prototype,{delete:function(e){if(!s(e))return!1;var n=i(e);return!0===n?p(d(this,t)).delete(e):n&&u(n,this._i)&&delete n[this._i]},has:function(e){if(!s(e))return!1;var n=i(e);return!0===n?p(d(this,t)).has(e):n&&u(n,this._i)}}),l},def:function(e,t,n){var r=i(o(t),!0);return!0===r?p(e).set(t,n):r[e._i]=n,e},ufstore:p}},function(e,t,n){var r=n(21),i=n(6);e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=i(t);if(t!==n)throw RangeError("Wrong length!");return n}},function(e,t,n){var r=n(37),i=n(54),o=n(1),s=n(2).Reflect;e.exports=s&&s.ownKeys||function(e){var t=r.f(o(e)),n=i.f;return n?t.concat(n(e)):t}},function(e,t,n){"use strict";var r=n(55),i=n(4),o=n(6),s=n(19),a=n(5)("isConcatSpreadable");e.exports=function e(t,n,c,l,u,d,f,h){for(var v,p,m=u,g=0,y=!!f&&s(f,h,3);g<l;){if(g in c){if(v=y?y(c[g],g,n):c[g],p=!1,i(v)&&(p=void 0!==(p=v[a])?!!p:r(v)),p&&d>0)m=e(t,n,v,o(v.length),m,d-1)-1;else{if(m>=9007199254740991)throw TypeError();t[m]=v}m++}g++}return m}},function(e,t,n){var r=n(6),i=n(75),o=n(24);e.exports=function(e,t,n,s){var a=String(o(e)),c=a.length,l=void 0===n?" ":String(n),u=r(t);if(u<=c||""==l)return a;var d=u-c,f=i.call(l,Math.ceil(d/l.length));return f.length>d&&(f=f.slice(0,d)),s?f+a:a+f}},function(e,t,n){var r=n(7),i=n(34),o=n(15),s=n(50).f;e.exports=function(e){return function(t){for(var n,a=o(t),c=i(a),l=c.length,u=0,d=[];l>u;)n=c[u++],r&&!s.call(a,n)||d.push(e?[n,a[n]]:a[n]);return d}}},function(e,t,n){var r=n(45),i=n(131);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t,n){var r=n(40);e.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},function(e,t){e.exports=Math.scale||function(e,t,n,r,i){return 0===arguments.length||e!=e||t!=t||n!=n||r!=r||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-r)/(n-t)+r}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(){},e.exports=t.default},function(e,t,n){n(135),n(138),n(139),n(140),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(149),n(150),n(151),n(152),n(153),n(154),n(155),n(156),n(157),n(158),n(159),n(160),n(161),n(162),n(163),n(164),n(165),n(166),n(167),n(168),n(169),n(170),n(171),n(172),n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(181),n(182),n(183),n(184),n(185),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(215),n(216),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(235),n(236),n(237),n(238),n(87),n(239),n(116),n(240),n(117),n(241),n(242),n(243),n(244),n(245),n(120),n(122),n(123),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(258),n(259),n(260),n(261),n(262),n(263),n(264),n(265),n(266),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),e.exports=n(18)},function(e,t,n){"use strict";var r=n(2),i=n(14),o=n(7),s=n(0),a=n(12),c=n(30).KEY,l=n(3),u=n(48),d=n(44),f=n(33),h=n(5),v=n(98),p=n(68),m=n(137),g=n(55),y=n(1),_=n(4),S=n(9),C=n(15),E=n(23),I=n(32),T=n(36),R=n(101),b=n(16),O=n(54),k=n(8),A=n(34),w=b.f,M=k.f,P=R.f,D=r.Symbol,N=r.JSON,x=N&&N.stringify,L=h("_hidden"),F=h("toPrimitive"),V={}.propertyIsEnumerable,j=u("symbol-registry"),U=u("symbols"),G=u("op-symbols"),H=Object.prototype,q="function"==typeof D&&!!O.f,B=r.QObject,W=!B||!B.prototype||!B.prototype.findChild,K=o&&l((function(){return 7!=T(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=w(H,t);r&&delete H[t],M(e,t,n),r&&e!==H&&M(H,t,r)}:M,z=function(e){var t=U[e]=T(D.prototype);return t._k=e,t},J=q&&"symbol"==typeof D.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof D},Y=function(e,t,n){return e===H&&Y(G,t,n),y(e),t=E(t,!0),y(n),i(U,t)?(n.enumerable?(i(e,L)&&e[L][t]&&(e[L][t]=!1),n=T(n,{enumerable:I(0,!1)})):(i(e,L)||M(e,L,I(1,{})),e[L][t]=!0),K(e,t,n)):M(e,t,n)},Q=function(e,t){y(e);for(var n,r=m(t=C(t)),i=0,o=r.length;o>i;)Y(e,n=r[i++],t[n]);return e},$=function(e){var t=V.call(this,e=E(e,!0));return!(this===H&&i(U,e)&&!i(G,e))&&(!(t||!i(this,e)||!i(U,e)||i(this,L)&&this[L][e])||t)},X=function(e,t){if(e=C(e),t=E(t,!0),e!==H||!i(U,t)||i(G,t)){var n=w(e,t);return!n||!i(U,t)||i(e,L)&&e[L][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=P(C(e)),r=[],o=0;n.length>o;)i(U,t=n[o++])||t==L||t==c||r.push(t);return r},ee=function(e){for(var t,n=e===H,r=P(n?G:C(e)),o=[],s=0;r.length>s;)!i(U,t=r[s++])||n&&!i(H,t)||o.push(U[t]);return o};q||(a((D=function(){if(this instanceof D)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function(n){this===H&&t.call(G,n),i(this,L)&&i(this[L],e)&&(this[L][e]=!1),K(this,e,I(1,n))};return o&&W&&K(H,e,{configurable:!0,set:t}),z(e)}).prototype,"toString",(function(){return this._k})),b.f=X,k.f=Y,n(37).f=R.f=Z,n(50).f=$,O.f=ee,o&&!n(29)&&a(H,"propertyIsEnumerable",$,!0),v.f=function(e){return z(h(e))}),s(s.G+s.W+s.F*!q,{Symbol:D});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)h(te[ne++]);for(var re=A(h.store),ie=0;re.length>ie;)p(re[ie++]);s(s.S+s.F*!q,"Symbol",{for:function(e){return i(j,e+="")?j[e]:j[e]=D(e)},keyFor:function(e){if(!J(e))throw TypeError(e+" is not a symbol!");for(var t in j)if(j[t]===e)return t},useSetter:function(){W=!0},useSimple:function(){W=!1}}),s(s.S+s.F*!q,"Object",{create:function(e,t){return void 0===t?T(e):Q(T(e),t)},defineProperty:Y,defineProperties:Q,getOwnPropertyDescriptor:X,getOwnPropertyNames:Z,getOwnPropertySymbols:ee});var oe=l((function(){O.f(1)}));s(s.S+s.F*oe,"Object",{getOwnPropertySymbols:function(e){return O.f(S(e))}}),N&&s(s.S+s.F*(!q||l((function(){var e=D();return"[null]"!=x([e])||"{}"!=x({a:e})||"{}"!=x(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(_(t)||void 0!==e)&&!J(e))return g(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!J(t))return t}),r[1]=t,x.apply(N,r)}}),D.prototype[F]||n(11)(D.prototype,F,D.prototype.valueOf),d(D,"Symbol"),d(Math,"Math",!0),d(r.JSON,"JSON",!0)},function(e,t,n){e.exports=n(48)("native-function-to-string",Function.toString)},function(e,t,n){var r=n(34),i=n(54),o=n(50);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var s,a=n(e),c=o.f,l=0;a.length>l;)c.call(e,s=a[l++])&&t.push(s);return t}},function(e,t,n){var r=n(0);r(r.S,"Object",{create:n(36)})},function(e,t,n){var r=n(0);r(r.S+r.F*!n(7),"Object",{defineProperty:n(8).f})},function(e,t,n){var r=n(0);r(r.S+r.F*!n(7),"Object",{defineProperties:n(100)})},function(e,t,n){var r=n(15),i=n(16).f;n(25)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(r(e),t)}}))},function(e,t,n){var r=n(9),i=n(17);n(25)("getPrototypeOf",(function(){return function(e){return i(r(e))}}))},function(e,t,n){var r=n(9),i=n(34);n(25)("keys",(function(){return function(e){return i(r(e))}}))},function(e,t,n){n(25)("getOwnPropertyNames",(function(){return n(101).f}))},function(e,t,n){var r=n(4),i=n(30).onFreeze;n(25)("freeze",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(4),i=n(30).onFreeze;n(25)("seal",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(4),i=n(30).onFreeze;n(25)("preventExtensions",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(4);n(25)("isFrozen",(function(e){return function(t){return!r(t)||!!e&&e(t)}}))},function(e,t,n){var r=n(4);n(25)("isSealed",(function(e){return function(t){return!r(t)||!!e&&e(t)}}))},function(e,t,n){var r=n(4);n(25)("isExtensible",(function(e){return function(t){return!!r(t)&&(!e||e(t))}}))},function(e,t,n){var r=n(0);r(r.S+r.F,"Object",{assign:n(102)})},function(e,t,n){var r=n(0);r(r.S,"Object",{is:n(103)})},function(e,t,n){var r=n(0);r(r.S,"Object",{setPrototypeOf:n(72).set})},function(e,t,n){"use strict";var r=n(45),i={};i[n(5)("toStringTag")]="z",i+""!="[object z]"&&n(12)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,n){var r=n(0);r(r.P,"Function",{bind:n(104)})},function(e,t,n){var r=n(8).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(7)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(4),i=n(17),o=n(5)("hasInstance"),s=Function.prototype;o in s||n(8).f(s,o,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){var r=n(0),i=n(106);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(e,t,n){var r=n(0),i=n(107);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(e,t,n){"use strict";var r=n(2),i=n(14),o=n(20),s=n(74),a=n(23),c=n(3),l=n(37).f,u=n(16).f,d=n(8).f,f=n(46).trim,h=r.Number,v=h,p=h.prototype,m="Number"==o(n(36)(p)),g="trim"in String.prototype,y=function(e){var t=a(e,!1);if("string"==typeof t&&t.length>2){var n,r,i,o=(t=g?t.trim():f(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var s,c=t.slice(2),l=0,u=c.length;l<u;l++)if((s=c.charCodeAt(l))<48||s>i)return NaN;return parseInt(c,r)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof h&&(m?c((function(){p.valueOf.call(n)})):"Number"!=o(n))?s(new v(y(t)),n,h):y(t)};for(var _,S=n(7)?l(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),C=0;S.length>C;C++)i(v,_=S[C])&&!i(h,_)&&d(h,_,u(v,_));h.prototype=p,p.constructor=h,n(12)(r,"Number",h)}},function(e,t,n){"use strict";var r=n(0),i=n(21),o=n(108),s=n(75),a=1..toFixed,c=Math.floor,l=[0,0,0,0,0,0],u="Number.toFixed: incorrect invocation!",d=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*l[n],l[n]=r%1e7,r=c(r/1e7)},f=function(e){for(var t=6,n=0;--t>=0;)n+=l[t],l[t]=c(n/e),n=n%e*1e7},h=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==l[e]){var n=String(l[e]);t=""===t?n:t+s.call("0",7-n.length)+n}return t},v=function(e,t,n){return 0===t?n:t%2==1?v(e,t-1,n*e):v(e*e,t/2,n)};r(r.P+r.F*(!!a&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(3)((function(){a.call({})}))),"Number",{toFixed:function(e){var t,n,r,a,c=o(this,u),l=i(e),p="",m="0";if(l<0||l>20)throw RangeError(u);if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(p="-",c=-c),c>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(c*v(2,69,1))-69)<0?c*v(2,-t,1):c/v(2,t,1),n*=4503599627370496,(t=52-t)>0){for(d(0,n),r=l;r>=7;)d(1e7,0),r-=7;for(d(v(10,r,1),0),r=t-1;r>=23;)f(1<<23),r-=23;f(1<<r),d(1,1),f(2),m=h()}else d(0,n),d(1<<-t,0),m=h()+s.call("0",l);return m=l>0?p+((a=m.length)<=l?"0."+s.call("0",l-a)+m:m.slice(0,a-l)+"."+m.slice(a-l)):p+m}})},function(e,t,n){"use strict";var r=n(0),i=n(3),o=n(108),s=1..toPrecision;r(r.P+r.F*(i((function(){return"1"!==s.call(1,void 0)}))||!i((function(){s.call({})}))),"Number",{toPrecision:function(e){var t=o(this,"Number#toPrecision: incorrect invocation!");return void 0===e?s.call(t):s.call(t,e)}})},function(e,t,n){var r=n(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var r=n(0),i=n(2).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},function(e,t,n){var r=n(0);r(r.S,"Number",{isInteger:n(109)})},function(e,t,n){var r=n(0);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var r=n(0),i=n(109),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},function(e,t,n){var r=n(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(0),i=n(107);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(e,t,n){var r=n(0),i=n(106);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(e,t,n){var r=n(0),i=n(110),o=Math.sqrt,s=Math.acosh;r(r.S+r.F*!(s&&710==Math.floor(s(Number.MAX_VALUE))&&s(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+o(e-1)*o(e+1))}})},function(e,t,n){var r=n(0),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},function(e,t,n){var r=n(0),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,n){var r=n(0),i=n(76);r(r.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,n){var r=n(0),i=Math.exp;r(r.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},function(e,t,n){var r=n(0),i=n(77);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(e,t,n){var r=n(0);r(r.S,"Math",{fround:n(111)})},function(e,t,n){var r=n(0),i=Math.abs;r(r.S,"Math",{hypot:function(e,t){for(var n,r,o=0,s=0,a=arguments.length,c=0;s<a;)c<(n=i(arguments[s++]))?(o=o*(r=c/n)*r+1,c=n):o+=n>0?(r=n/c)*r:n;return c===1/0?1/0:c*Math.sqrt(o)}})},function(e,t,n){var r=n(0),i=Math.imul;r(r.S+r.F*n(3)((function(){return-5!=i(4294967295,5)||2!=i.length})),"Math",{imul:function(e,t){var n=+e,r=+t,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,n){var r=n(0);r(r.S,"Math",{log1p:n(110)})},function(e,t,n){var r=n(0);r(r.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){var r=n(0);r(r.S,"Math",{sign:n(76)})},function(e,t,n){var r=n(0),i=n(77),o=Math.exp;r(r.S+r.F*n(3)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},function(e,t,n){var r=n(0),i=n(77),o=Math.exp;r(r.S,"Math",{tanh:function(e){var t=i(e=+e),n=i(-e);return t==1/0?1:n==1/0?-1:(t-n)/(o(e)+o(-e))}})},function(e,t,n){var r=n(0);r(r.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,n){var r=n(0),i=n(35),o=String.fromCharCode,s=String.fromCodePoint;r(r.S+r.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,s=0;r>s;){if(t=+arguments[s++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){var r=n(0),i=n(15),o=n(6);r(r.S,"String",{raw:function(e){for(var t=i(e.raw),n=o(t.length),r=arguments.length,s=[],a=0;n>a;)s.push(String(t[a++])),a<r&&s.push(String(arguments[a]));return s.join("")}})},function(e,t,n){"use strict";n(46)("trim",(function(e){return function(){return e(this,3)}}))},function(e,t,n){"use strict";var r=n(56)(!0);n(78)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";var r=n(0),i=n(56)(!1);r(r.P,"String",{codePointAt:function(e){return i(this,e)}})},function(e,t,n){"use strict";var r=n(0),i=n(6),o=n(80),s="".endsWith;r(r.P+r.F*n(81)("endsWith"),"String",{endsWith:function(e){var t=o(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(t.length),a=void 0===n?r:Math.min(i(n),r),c=String(e);return s?s.call(t,c,a):t.slice(a-c.length,a)===c}})},function(e,t,n){"use strict";var r=n(0),i=n(80);r(r.P+r.F*n(81)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(0);r(r.P,"String",{repeat:n(75)})},function(e,t,n){"use strict";var r=n(0),i=n(6),o=n(80),s="".startsWith;r(r.P+r.F*n(81)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return s?s.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){"use strict";n(13)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))},function(e,t,n){"use strict";n(13)("big",(function(e){return function(){return e(this,"big","","")}}))},function(e,t,n){"use strict";n(13)("blink",(function(e){return function(){return e(this,"blink","","")}}))},function(e,t,n){"use strict";n(13)("bold",(function(e){return function(){return e(this,"b","","")}}))},function(e,t,n){"use strict";n(13)("fixed",(function(e){return function(){return e(this,"tt","","")}}))},function(e,t,n){"use strict";n(13)("fontcolor",(function(e){return function(t){return e(this,"font","color",t)}}))},function(e,t,n){"use strict";n(13)("fontsize",(function(e){return function(t){return e(this,"font","size",t)}}))},function(e,t,n){"use strict";n(13)("italics",(function(e){return function(){return e(this,"i","","")}}))},function(e,t,n){"use strict";n(13)("link",(function(e){return function(t){return e(this,"a","href",t)}}))},function(e,t,n){"use strict";n(13)("small",(function(e){return function(){return e(this,"small","","")}}))},function(e,t,n){"use strict";n(13)("strike",(function(e){return function(){return e(this,"strike","","")}}))},function(e,t,n){"use strict";n(13)("sub",(function(e){return function(){return e(this,"sub","","")}}))},function(e,t,n){"use strict";n(13)("sup",(function(e){return function(){return e(this,"sup","","")}}))},function(e,t,n){var r=n(0);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(23);r(r.P+r.F*n(3)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=i(this),n=o(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){var r=n(0),i=n(214);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(e,t,n){"use strict";var r=n(3),i=Date.prototype.getTime,o=Date.prototype.toISOString,s=function(e){return e>9?e:"0"+e};e.exports=r((function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-50000000000001))}))||!r((function(){o.call(new Date(NaN))}))?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+s(e.getUTCMonth()+1)+"-"+s(e.getUTCDate())+"T"+s(e.getUTCHours())+":"+s(e.getUTCMinutes())+":"+s(e.getUTCSeconds())+"."+(n>99?n:"0"+s(n))+"Z"}:o},function(e,t,n){var r=Date.prototype,i=r.toString,o=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(12)(r,"toString",(function(){var e=o.call(this);return e==e?i.call(this):"Invalid Date"}))},function(e,t,n){var r=n(5)("toPrimitive"),i=Date.prototype;r in i||n(11)(i,r,n(217))},function(e,t,n){"use strict";var r=n(1),i=n(23);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(r(this),"number"!=e)}},function(e,t,n){var r=n(0);r(r.S,"Array",{isArray:n(55)})},function(e,t,n){"use strict";var r=n(19),i=n(0),o=n(9),s=n(112),a=n(82),c=n(6),l=n(83),u=n(84);i(i.S+i.F*!n(58)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,d,f=o(e),h="function"==typeof this?this:Array,v=arguments.length,p=v>1?arguments[1]:void 0,m=void 0!==p,g=0,y=u(f);if(m&&(p=r(p,v>2?arguments[2]:void 0,2)),null==y||h==Array&&a(y))for(n=new h(t=c(f.length));t>g;g++)l(n,g,m?p(f[g],g):f[g]);else for(d=y.call(f),n=new h;!(i=d.next()).done;g++)l(n,g,m?s(d,p,[i.value,g],!0):i.value);return n.length=g,n}})},function(e,t,n){"use strict";var r=n(0),i=n(83);r(r.S+r.F*n(3)((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)i(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var r=n(0),i=n(15),o=[].join;r(r.P+r.F*(n(49)!=Object||!n(22)(o)),"Array",{join:function(e){return o.call(i(this),void 0===e?",":e)}})},function(e,t,n){"use strict";var r=n(0),i=n(71),o=n(20),s=n(35),a=n(6),c=[].slice;r(r.P+r.F*n(3)((function(){i&&c.call(i)})),"Array",{slice:function(e,t){var n=a(this.length),r=o(this);if(t=void 0===t?n:t,"Array"==r)return c.call(this,e,t);for(var i=s(e,n),l=s(t,n),u=a(l-i),d=new Array(u),f=0;f<u;f++)d[f]="String"==r?this.charAt(i+f):this[i+f];return d}})},function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(9),s=n(3),a=[].sort,c=[1,2,3];r(r.P+r.F*(s((function(){c.sort(void 0)}))||!s((function(){c.sort(null)}))||!n(22)(a)),"Array",{sort:function(e){return void 0===e?a.call(o(this)):a.call(o(this),i(e))}})},function(e,t,n){"use strict";var r=n(0),i=n(26)(0),o=n(22)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},function(e,t,n){var r=n(4),i=n(55),o=n(5)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(0),i=n(26)(1);r(r.P+r.F*!n(22)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(26)(2);r(r.P+r.F*!n(22)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(26)(3);r(r.P+r.F*!n(22)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(26)(4);r(r.P+r.F*!n(22)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(113);r(r.P+r.F*!n(22)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},function(e,t,n){"use strict";var r=n(0),i=n(113);r(r.P+r.F*!n(22)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},function(e,t,n){"use strict";var r=n(0),i=n(53)(!1),o=[].indexOf,s=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(s||!n(22)(o)),"Array",{indexOf:function(e){return s?o.apply(this,arguments)||0:i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(15),o=n(21),s=n(6),a=[].lastIndexOf,c=!!a&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(c||!n(22)(a)),"Array",{lastIndexOf:function(e){if(c)return a.apply(this,arguments)||0;var t=i(this),n=s(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}})},function(e,t,n){var r=n(0);r(r.P,"Array",{copyWithin:n(114)}),n(31)("copyWithin")},function(e,t,n){var r=n(0);r(r.P,"Array",{fill:n(86)}),n(31)("fill")},function(e,t,n){"use strict";var r=n(0),i=n(26)(5),o=!0;"find"in[]&&Array(1).find((function(){o=!1})),r(r.P+r.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(31)("find")},function(e,t,n){"use strict";var r=n(0),i=n(26)(6),o="findIndex",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),r(r.P+r.F*s,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(31)(o)},function(e,t,n){n(38)("Array")},function(e,t,n){var r=n(2),i=n(74),o=n(8).f,s=n(37).f,a=n(57),c=n(51),l=r.RegExp,u=l,d=l.prototype,f=/a/g,h=/a/g,v=new l(f)!==f;if(n(7)&&(!v||n(3)((function(){return h[n(5)("match")]=!1,l(f)!=f||l(h)==h||"/a/i"!=l(f,"i")})))){l=function(e,t){var n=this instanceof l,r=a(e),o=void 0===t;return!n&&r&&e.constructor===l&&o?e:i(v?new u(r&&!o?e.source:e,t):u((r=e instanceof l)?e.source:e,r&&o?c.call(e):t),n?this:d,l)};for(var p=function(e){e in l||o(l,e,{configurable:!0,get:function(){return u[e]},set:function(t){u[e]=t}})},m=s(u),g=0;m.length>g;)p(m[g++]);d.constructor=l,l.prototype=d,n(12)(r,"RegExp",l)}n(38)("RegExp")},function(e,t,n){"use strict";n(117);var r=n(1),i=n(51),o=n(7),s=/./.toString,a=function(e){n(12)(RegExp.prototype,"toString",e,!0)};n(3)((function(){return"/a/b"!=s.call({source:"a",flags:"b"})}))?a((function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)})):"toString"!=s.name&&a((function(){return s.call(this)}))},function(e,t,n){"use strict";var r=n(1),i=n(6),o=n(89),s=n(59);n(60)("match",1,(function(e,t,n,a){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=a(n,e,this);if(t.done)return t.value;var c=r(e),l=String(this);if(!c.global)return s(c,l);var u=c.unicode;c.lastIndex=0;for(var d,f=[],h=0;null!==(d=s(c,l));){var v=String(d[0]);f[h]=v,""===v&&(c.lastIndex=o(l,i(c.lastIndex),u)),h++}return 0===h?null:f}]}))},function(e,t,n){"use strict";var r=n(1),i=n(9),o=n(6),s=n(21),a=n(89),c=n(59),l=Math.max,u=Math.min,d=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,h=/\$([$&`']|\d\d?)/g;n(60)("replace",2,(function(e,t,n,v){return[function(r,i){var o=e(this),s=null==r?void 0:r[t];return void 0!==s?s.call(r,o,i):n.call(String(o),r,i)},function(e,t){var i=v(n,e,this,t);if(i.done)return i.value;var d=r(e),f=String(this),h="function"==typeof t;h||(t=String(t));var m=d.global;if(m){var g=d.unicode;d.lastIndex=0}for(var y=[];;){var _=c(d,f);if(null===_)break;if(y.push(_),!m)break;""===String(_[0])&&(d.lastIndex=a(f,o(d.lastIndex),g))}for(var S,C="",E=0,I=0;I<y.length;I++){_=y[I];for(var T=String(_[0]),R=l(u(s(_.index),f.length),0),b=[],O=1;O<_.length;O++)b.push(void 0===(S=_[O])?S:String(S));var k=_.groups;if(h){var A=[T].concat(b,R,f);void 0!==k&&A.push(k);var w=String(t.apply(void 0,A))}else w=p(T,f,R,b,k,t);R>=E&&(C+=f.slice(E,R)+w,E=R+T.length)}return C+f.slice(E)}];function p(e,t,r,o,s,a){var c=r+e.length,l=o.length,u=h;return void 0!==s&&(s=i(s),u=f),n.call(a,u,(function(n,i){var a;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(c);case"<":a=s[i.slice(1,-1)];break;default:var u=+i;if(0===u)return n;if(u>l){var f=d(u/10);return 0===f?n:f<=l?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):n}a=o[u-1]}return void 0===a?"":a}))}}))},function(e,t,n){"use strict";var r=n(1),i=n(103),o=n(59);n(60)("search",1,(function(e,t,n,s){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=s(n,e,this);if(t.done)return t.value;var a=r(e),c=String(this),l=a.lastIndex;i(l,0)||(a.lastIndex=0);var u=o(a,c);return i(a.lastIndex,l)||(a.lastIndex=l),null===u?-1:u.index}]}))},function(e,t,n){"use strict";var r=n(57),i=n(1),o=n(52),s=n(89),a=n(6),c=n(59),l=n(88),u=n(3),d=Math.min,f=[].push,h="length",v=!u((function(){RegExp(4294967295,"y")}));n(60)("split",2,(function(e,t,n,u){var p;return p="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[h]||2!="ab".split(/(?:ab)*/)[h]||4!=".".split(/(.?)(.?)/)[h]||".".split(/()()/)[h]>1||"".split(/.?/)[h]?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(i,e,t);for(var o,s,a,c=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,v=void 0===t?4294967295:t>>>0,p=new RegExp(e.source,u+"g");(o=l.call(p,i))&&!((s=p.lastIndex)>d&&(c.push(i.slice(d,o.index)),o[h]>1&&o.index<i[h]&&f.apply(c,o.slice(1)),a=o[0][h],d=s,c[h]>=v));)p.lastIndex===o.index&&p.lastIndex++;return d===i[h]?!a&&p.test("")||c.push(""):c.push(i.slice(d)),c[h]>v?c.slice(0,v):c}:"0".split(void 0,0)[h]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,r){var i=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,i,r):p.call(String(i),n,r)},function(e,t){var r=u(p,e,this,t,p!==n);if(r.done)return r.value;var l=i(e),f=String(this),h=o(l,RegExp),m=l.unicode,g=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(v?"y":"g"),y=new h(v?l:"^(?:"+l.source+")",g),_=void 0===t?4294967295:t>>>0;if(0===_)return[];if(0===f.length)return null===c(y,f)?[f]:[];for(var S=0,C=0,E=[];C<f.length;){y.lastIndex=v?C:0;var I,T=c(y,v?f:f.slice(C));if(null===T||(I=d(a(y.lastIndex+(v?0:C)),f.length))===S)C=s(f,C,m);else{if(E.push(f.slice(S,C)),E.length===_)return E;for(var R=1;R<=T.length-1;R++)if(E.push(T[R]),E.length===_)return E;C=S=I}}return E.push(f.slice(S)),E}]}))},function(e,t,n){"use strict";var r,i,o,s,a=n(29),c=n(2),l=n(19),u=n(45),d=n(0),f=n(4),h=n(10),v=n(39),p=n(40),m=n(52),g=n(90).set,y=n(91)(),_=n(92),S=n(118),C=n(61),E=n(119),I=c.TypeError,T=c.process,R=T&&T.versions,b=R&&R.v8||"",O=c.Promise,k="process"==u(T),A=function(){},w=i=_.f,M=!!function(){try{var e=O.resolve(1),t=(e.constructor={})[n(5)("species")]=function(e){e(A,A)};return(k||"function"==typeof PromiseRejectionEvent)&&e.then(A)instanceof t&&0!==b.indexOf("6.6")&&-1===C.indexOf("Chrome/66")}catch(e){}}(),P=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},D=function(e,t){if(!e._n){e._n=!0;var n=e._c;y((function(){for(var r=e._v,i=1==e._s,o=0,s=function(t){var n,o,s,a=i?t.ok:t.fail,c=t.resolve,l=t.reject,u=t.domain;try{a?(i||(2==e._h&&L(e),e._h=1),!0===a?n=r:(u&&u.enter(),n=a(r),u&&(u.exit(),s=!0)),n===t.promise?l(I("Promise-chain cycle")):(o=P(n))?o.call(n,c,l):c(n)):l(r)}catch(e){u&&!s&&u.exit(),l(e)}};n.length>o;)s(n[o++]);e._c=[],e._n=!1,t&&!e._h&&N(e)}))}},N=function(e){g.call(c,(function(){var t,n,r,i=e._v,o=x(e);if(o&&(t=S((function(){k?T.emit("unhandledRejection",i,e):(n=c.onunhandledrejection)?n({promise:e,reason:i}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=k||x(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},x=function(e){return 1!==e._h&&0===(e._a||e._c).length},L=function(e){g.call(c,(function(){var t;k?T.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},F=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),D(t,!0))},V=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw I("Promise can't be resolved itself");(t=P(e))?y((function(){var r={_w:n,_d:!1};try{t.call(e,l(V,r,1),l(F,r,1))}catch(e){F.call(r,e)}})):(n._v=e,n._s=1,D(n,!1))}catch(e){F.call({_w:n,_d:!1},e)}}};M||(O=function(e){v(this,O,"Promise","_h"),h(e),r.call(this);try{e(l(V,this,1),l(F,this,1))}catch(e){F.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(41)(O.prototype,{then:function(e,t){var n=w(m(this,O));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=k?T.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&D(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=l(V,e,1),this.reject=l(F,e,1)},_.f=w=function(e){return e===O||e===s?new o(e):i(e)}),d(d.G+d.W+d.F*!M,{Promise:O}),n(44)(O,"Promise"),n(38)("Promise"),s=n(18).Promise,d(d.S+d.F*!M,"Promise",{reject:function(e){var t=w(this);return(0,t.reject)(e),t.promise}}),d(d.S+d.F*(a||!M),"Promise",{resolve:function(e){return E(a&&this===s?O:this,e)}}),d(d.S+d.F*!(M&&n(58)((function(e){O.all(e).catch(A)}))),"Promise",{all:function(e){var t=this,n=w(t),r=n.resolve,i=n.reject,o=S((function(){var n=[],o=0,s=1;p(e,!1,(function(e){var a=o++,c=!1;n.push(void 0),s++,t.resolve(e).then((function(e){c||(c=!0,n[a]=e,--s||r(n))}),i)})),--s||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=w(t),r=n.reject,i=S((function(){p(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(e,t,n){"use strict";var r=n(124),i=n(42);n(62)("WeakSet",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,"WeakSet"),e,!0)}},r,!1,!0)},function(e,t,n){"use strict";var r=n(0),i=n(63),o=n(93),s=n(1),a=n(35),c=n(6),l=n(4),u=n(2).ArrayBuffer,d=n(52),f=o.ArrayBuffer,h=o.DataView,v=i.ABV&&u.isView,p=f.prototype.slice,m=i.VIEW;r(r.G+r.W+r.F*(u!==f),{ArrayBuffer:f}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(e){return v&&v(e)||l(e)&&m in e}}),r(r.P+r.U+r.F*n(3)((function(){return!new f(2).slice(1,void 0).byteLength})),"ArrayBuffer",{slice:function(e,t){if(void 0!==p&&void 0===t)return p.call(s(this),e);for(var n=s(this).byteLength,r=a(e,n),i=a(void 0===t?n:t,n),o=new(d(this,f))(c(i-r)),l=new h(this),u=new h(o),v=0;r<i;)u.setUint8(v++,l.getUint8(r++));return o}}),n(38)("ArrayBuffer")},function(e,t,n){var r=n(0);r(r.G+r.W+r.F*!n(63).ABV,{DataView:n(93).DataView})},function(e,t,n){n(27)("Int8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0)},function(e,t,n){n(27)("Int16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Uint16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Int32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Uint32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Float32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Float64",8,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){var r=n(0),i=n(10),o=n(1),s=(n(2).Reflect||{}).apply,a=Function.apply;r(r.S+r.F*!n(3)((function(){s((function(){}))})),"Reflect",{apply:function(e,t,n){var r=i(e),c=o(n);return s?s(r,t,c):a.call(r,t,c)}})},function(e,t,n){var r=n(0),i=n(36),o=n(10),s=n(1),a=n(4),c=n(3),l=n(104),u=(n(2).Reflect||{}).construct,d=c((function(){function e(){}return!(u((function(){}),[],e)instanceof e)})),f=!c((function(){u((function(){}))}));r(r.S+r.F*(d||f),"Reflect",{construct:function(e,t){o(e),s(t);var n=arguments.length<3?e:o(arguments[2]);if(f&&!d)return u(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(l.apply(e,r))}var c=n.prototype,h=i(a(c)?c:Object.prototype),v=Function.apply.call(e,h,t);return a(v)?v:h}})},function(e,t,n){var r=n(8),i=n(0),o=n(1),s=n(23);i(i.S+i.F*n(3)((function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,n){o(e),t=s(t,!0),o(n);try{return r.f(e,t,n),!0}catch(e){return!1}}})},function(e,t,n){var r=n(0),i=n(16).f,o=n(1);r(r.S,"Reflect",{deleteProperty:function(e,t){var n=i(o(e),t);return!(n&&!n.configurable)&&delete e[t]}})},function(e,t,n){"use strict";var r=n(0),i=n(1),o=function(e){this._t=i(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};n(79)(o,"Object",(function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}})),r(r.S,"Reflect",{enumerate:function(e){return new o(e)}})},function(e,t,n){var r=n(16),i=n(17),o=n(14),s=n(0),a=n(4),c=n(1);s(s.S,"Reflect",{get:function e(t,n){var s,l,u=arguments.length<3?t:arguments[2];return c(t)===u?t[n]:(s=r.f(t,n))?o(s,"value")?s.value:void 0!==s.get?s.get.call(u):void 0:a(l=i(t))?e(l,n,u):void 0}})},function(e,t,n){var r=n(16),i=n(0),o=n(1);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return r.f(o(e),t)}})},function(e,t,n){var r=n(0),i=n(17),o=n(1);r(r.S,"Reflect",{getPrototypeOf:function(e){return i(o(e))}})},function(e,t,n){var r=n(0);r(r.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,n){var r=n(0),i=n(1),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(e){return i(e),!o||o(e)}})},function(e,t,n){var r=n(0);r(r.S,"Reflect",{ownKeys:n(126)})},function(e,t,n){var r=n(0),i=n(1),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(e){i(e);try{return o&&o(e),!0}catch(e){return!1}}})},function(e,t,n){var r=n(8),i=n(16),o=n(17),s=n(14),a=n(0),c=n(32),l=n(1),u=n(4);a(a.S,"Reflect",{set:function e(t,n,a){var d,f,h=arguments.length<4?t:arguments[3],v=i.f(l(t),n);if(!v){if(u(f=o(t)))return e(f,n,a,h);v=c(0)}if(s(v,"value")){if(!1===v.writable||!u(h))return!1;if(d=i.f(h,n)){if(d.get||d.set||!1===d.writable)return!1;d.value=a,r.f(h,n,d)}else r.f(h,n,c(0,a));return!0}return void 0!==v.set&&(v.set.call(h,a),!0)}})},function(e,t,n){var r=n(0),i=n(72);i&&r(r.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},function(e,t,n){"use strict";var r=n(0),i=n(53)(!0);r(r.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(31)("includes")},function(e,t,n){"use strict";var r=n(0),i=n(127),o=n(9),s=n(6),a=n(10),c=n(85);r(r.P,"Array",{flatMap:function(e){var t,n,r=o(this);return a(e),t=s(r.length),n=c(r,0),i(n,r,r,t,0,1,e,arguments[1]),n}}),n(31)("flatMap")},function(e,t,n){"use strict";var r=n(0),i=n(127),o=n(9),s=n(6),a=n(21),c=n(85);r(r.P,"Array",{flatten:function(){var e=arguments[0],t=o(this),n=s(t.length),r=c(t,0);return i(r,t,t,n,0,void 0===e?1:a(e)),r}}),n(31)("flatten")},function(e,t,n){"use strict";var r=n(0),i=n(56)(!0),o=n(3)((function(){return"𠮷"!=="𠮷".at(0)}));r(r.P+r.F*o,"String",{at:function(e){return i(this,e)}})},function(e,t,n){"use strict";var r=n(0),i=n(128),o=n(61),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*s,"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){"use strict";var r=n(0),i=n(128),o=n(61),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*s,"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){"use strict";n(46)("trimLeft",(function(e){return function(){return e(this,1)}}),"trimStart")},function(e,t,n){"use strict";n(46)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},function(e,t,n){"use strict";var r=n(0),i=n(24),o=n(6),s=n(57),a=n(51),c=RegExp.prototype,l=function(e,t){this._r=e,this._s=t};n(79)(l,"RegExp String",(function(){var e=this._r.exec(this._s);return{value:e,done:null===e}})),r(r.P,"String",{matchAll:function(e){if(i(this),!s(e))throw TypeError(e+" is not a regexp!");var t=String(this),n="flags"in c?String(e.flags):a.call(e),r=new RegExp(e.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=o(e.lastIndex),new l(r,t)}})},function(e,t,n){n(68)("asyncIterator")},function(e,t,n){n(68)("observable")},function(e,t,n){var r=n(0),i=n(126),o=n(15),s=n(16),a=n(83);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=o(e),c=s.f,l=i(r),u={},d=0;l.length>d;)void 0!==(n=c(r,t=l[d++]))&&a(u,t,n);return u}})},function(e,t,n){var r=n(0),i=n(129)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},function(e,t,n){var r=n(0),i=n(129)(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(10),s=n(8);n(7)&&r(r.P+n(64),"Object",{__defineGetter__:function(e,t){s.f(i(this),e,{get:o(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(10),s=n(8);n(7)&&r(r.P+n(64),"Object",{__defineSetter__:function(e,t){s.f(i(this),e,{set:o(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(23),s=n(17),a=n(16).f;n(7)&&r(r.P+n(64),"Object",{__lookupGetter__:function(e){var t,n=i(this),r=o(e,!0);do{if(t=a(n,r))return t.get}while(n=s(n))}})},function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(23),s=n(17),a=n(16).f;n(7)&&r(r.P+n(64),"Object",{__lookupSetter__:function(e){var t,n=i(this),r=o(e,!0);do{if(t=a(n,r))return t.set}while(n=s(n))}})},function(e,t,n){var r=n(0);r(r.P+r.R,"Map",{toJSON:n(130)("Map")})},function(e,t,n){var r=n(0);r(r.P+r.R,"Set",{toJSON:n(130)("Set")})},function(e,t,n){n(65)("Map")},function(e,t,n){n(65)("Set")},function(e,t,n){n(65)("WeakMap")},function(e,t,n){n(65)("WeakSet")},function(e,t,n){n(66)("Map")},function(e,t,n){n(66)("Set")},function(e,t,n){n(66)("WeakMap")},function(e,t,n){n(66)("WeakSet")},function(e,t,n){var r=n(0);r(r.G,{global:n(2)})},function(e,t,n){var r=n(0);r(r.S,"System",{global:n(2)})},function(e,t,n){var r=n(0),i=n(20);r(r.S,"Error",{isError:function(e){return"Error"===i(e)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{clamp:function(e,t,n){return Math.min(n,Math.max(t,e))}})},function(e,t,n){var r=n(0);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(e,t,n){var r=n(0),i=180/Math.PI;r(r.S,"Math",{degrees:function(e){return e*i}})},function(e,t,n){var r=n(0),i=n(132),o=n(111);r(r.S,"Math",{fscale:function(e,t,n,r,s){return o(i(e,t,n,r,s))}})},function(e,t,n){var r=n(0);r(r.S,"Math",{iaddh:function(e,t,n,r){var i=e>>>0,o=n>>>0;return(t>>>0)+(r>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},function(e,t,n){var r=n(0);r(r.S,"Math",{isubh:function(e,t,n,r){var i=e>>>0,o=n>>>0;return(t>>>0)-(r>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},function(e,t,n){var r=n(0);r(r.S,"Math",{imulh:function(e,t){var n=+e,r=+t,i=65535&n,o=65535&r,s=n>>16,a=r>>16,c=(s*o>>>0)+(i*o>>>16);return s*a+(c>>16)+((i*a>>>0)+(65535&c)>>16)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(e,t,n){var r=n(0),i=Math.PI/180;r(r.S,"Math",{radians:function(e){return e*i}})},function(e,t,n){var r=n(0);r(r.S,"Math",{scale:n(132)})},function(e,t,n){var r=n(0);r(r.S,"Math",{umulh:function(e,t){var n=+e,r=+t,i=65535&n,o=65535&r,s=n>>>16,a=r>>>16,c=(s*o>>>0)+(i*o>>>16);return s*a+(c>>>16)+((i*a>>>0)+(65535&c)>>>16)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}})},function(e,t,n){"use strict";var r=n(0),i=n(18),o=n(2),s=n(52),a=n(119);r(r.P+r.R,"Promise",{finally:function(e){var t=s(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return a(t,e()).then((function(){return n}))}:e,n?function(n){return a(t,e()).then((function(){throw n}))}:e)}})},function(e,t,n){"use strict";var r=n(0),i=n(92),o=n(118);r(r.S,"Promise",{try:function(e){var t=i.f(this),n=o(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){var r=n(28),i=n(1),o=r.key,s=r.set;r.exp({defineMetadata:function(e,t,n,r){s(e,t,i(n),o(r))}})},function(e,t,n){var r=n(28),i=n(1),o=r.key,s=r.map,a=r.store;r.exp({deleteMetadata:function(e,t){var n=arguments.length<3?void 0:o(arguments[2]),r=s(i(t),n,!1);if(void 0===r||!r.delete(e))return!1;if(r.size)return!0;var c=a.get(t);return c.delete(n),!!c.size||a.delete(t)}})},function(e,t,n){var r=n(28),i=n(1),o=n(17),s=r.has,a=r.get,c=r.key,l=function(e,t,n){if(s(e,t,n))return a(e,t,n);var r=o(t);return null!==r?l(e,r,n):void 0};r.exp({getMetadata:function(e,t){return l(e,i(t),arguments.length<3?void 0:c(arguments[2]))}})},function(e,t,n){var r=n(122),i=n(131),o=n(28),s=n(1),a=n(17),c=o.keys,l=o.key,u=function(e,t){var n=c(e,t),o=a(e);if(null===o)return n;var s=u(o,t);return s.length?n.length?i(new r(n.concat(s))):s:n};o.exp({getMetadataKeys:function(e){return u(s(e),arguments.length<2?void 0:l(arguments[1]))}})},function(e,t,n){var r=n(28),i=n(1),o=r.get,s=r.key;r.exp({getOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:s(arguments[2]))}})},function(e,t,n){var r=n(28),i=n(1),o=r.keys,s=r.key;r.exp({getOwnMetadataKeys:function(e){return o(i(e),arguments.length<2?void 0:s(arguments[1]))}})},function(e,t,n){var r=n(28),i=n(1),o=n(17),s=r.has,a=r.key,c=function(e,t,n){if(s(e,t,n))return!0;var r=o(t);return null!==r&&c(e,r,n)};r.exp({hasMetadata:function(e,t){return c(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},function(e,t,n){var r=n(28),i=n(1),o=r.has,s=r.key;r.exp({hasOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:s(arguments[2]))}})},function(e,t,n){var r=n(28),i=n(1),o=n(10),s=r.key,a=r.set;r.exp({metadata:function(e,t){return function(n,r){a(e,t,(void 0!==r?i:o)(n),s(r))}}})},function(e,t,n){var r=n(0),i=n(91)(),o=n(2).process,s="process"==n(20)(o);r(r.G,{asap:function(e){var t=s&&o.domain;i(t?t.bind(e):e)}})},function(e,t,n){"use strict";var r=n(0),i=n(2),o=n(18),s=n(91)(),a=n(5)("observable"),c=n(10),l=n(1),u=n(39),d=n(41),f=n(11),h=n(40),v=h.RETURN,p=function(e){return null==e?void 0:c(e)},m=function(e){var t=e._c;t&&(e._c=void 0,t())},g=function(e){return void 0===e._o},y=function(e){g(e)||(e._o=void 0,m(e))},_=function(e,t){l(e),this._c=void 0,this._o=e,e=new S(this);try{var n=t(e),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:c(n),this._c=n)}catch(t){return void e.error(t)}g(this)&&m(this)};_.prototype=d({},{unsubscribe:function(){y(this)}});var S=function(e){this._s=e};S.prototype=d({},{next:function(e){var t=this._s;if(!g(t)){var n=t._o;try{var r=p(n.next);if(r)return r.call(n,e)}catch(e){try{y(t)}finally{throw e}}}},error:function(e){var t=this._s;if(g(t))throw e;var n=t._o;t._o=void 0;try{var r=p(n.error);if(!r)throw e;e=r.call(n,e)}catch(e){try{m(t)}finally{throw e}}return m(t),e},complete:function(e){var t=this._s;if(!g(t)){var n=t._o;t._o=void 0;try{var r=p(n.complete);e=r?r.call(n,e):void 0}catch(e){try{m(t)}finally{throw e}}return m(t),e}}});var C=function(e){u(this,C,"Observable","_f")._f=c(e)};d(C.prototype,{subscribe:function(e){return new _(e,this._f)},forEach:function(e){var t=this;return new(o.Promise||i.Promise)((function(n,r){c(e);var i=t.subscribe({next:function(t){try{return e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:n})}))}}),d(C,{from:function(e){var t="function"==typeof this?this:C,n=p(l(e)[a]);if(n){var r=l(n.call(e));return r.constructor===t?r:new t((function(e){return r.subscribe(e)}))}return new t((function(t){var n=!1;return s((function(){if(!n){try{if(h(e,!1,(function(e){if(t.next(e),n)return v}))===v)return}catch(e){if(n)throw e;return void t.error(e)}t.complete()}})),function(){n=!0}}))},of:function(){for(var e=0,t=arguments.length,n=new Array(t);e<t;)n[e]=arguments[e++];return new("function"==typeof this?this:C)((function(e){var t=!1;return s((function(){if(!t){for(var r=0;r<n.length;++r)if(e.next(n[r]),t)return;e.complete()}})),function(){t=!0}}))}}),f(C.prototype,a,(function(){return this})),r(r.G,{Observable:C}),n(38)("Observable")},function(e,t,n){var r=n(2),i=n(0),o=n(61),s=[].slice,a=/MSIE .\./.test(o),c=function(e){return function(t,n){var r=arguments.length>2,i=!!r&&s.call(arguments,2);return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,n)}};i(i.G+i.B+i.F*a,{setTimeout:c(r.setTimeout),setInterval:c(r.setInterval)})},function(e,t,n){var r=n(0),i=n(90);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(e,t,n){for(var r=n(87),i=n(34),o=n(12),s=n(2),a=n(11),c=n(47),l=n(5),u=l("iterator"),d=l("toStringTag"),f=c.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},v=i(h),p=0;p<v.length;p++){var m,g=v[p],y=h[g],_=s[g],S=_&&_.prototype;if(S&&(S[u]||a(S,u,f),S[d]||a(S,d,g),c[g]=f,y))for(m in r)S[m]||o(S,m,r[m],!0)}},function(e,t,n){(function(t){!function(t){"use strict";var n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag",c="object"==typeof e,l=t.regeneratorRuntime;if(l)c&&(e.exports=l);else{(l=t.regeneratorRuntime=c?e.exports:{}).wrap=p;var u={},d={};d[o]=function(){return this};var f=Object.getPrototypeOf,h=f&&f(f(b([])));h&&h!==n&&r.call(h,o)&&(d=h);var v=_.prototype=g.prototype=Object.create(d);y.prototype=v.constructor=_,_.constructor=y,_[a]=y.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(v),e},l.awrap=function(e){return{__await:e}},S(C.prototype),C.prototype[s]=function(){return this},l.AsyncIterator=C,l.async=function(e,t,n,r){var i=new C(p(e,t,n,r));return l.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(v),v[a]="Generator",v[o]=function(){return this},v.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},l.values=b,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:b(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}}}function p(e,t,n,r){var i=t&&t.prototype instanceof g?t:g,o=Object.create(i.prototype),s=new R(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=E(s,n);if(a){if(a===u)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=m(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,s),o}function m(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function g(){}function y(){}function _(){}function S(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function C(e){function n(t,i,o,s){var a=m(e[t],e,i);if("throw"!==a.type){var c=a.arg,l=c.value;return l&&"object"==typeof l&&r.call(l,"__await")?Promise.resolve(l.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):Promise.resolve(l).then((function(e){c.value=e,o(c)}),s)}s(a.arg)}var i;"object"==typeof t.process&&t.process.domain&&(n=t.process.domain.bind(n)),this._invoke=function(e,t){function r(){return new Promise((function(r,i){n(e,t,r,i)}))}return i=i?i.then(r,r):r()}}function E(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=m(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function b(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,n(96))},function(e,t,n){n(333),e.exports=n(18).RegExp.escape},function(e,t,n){var r=n(0),i=n(334)(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(e){return i(e)}})},function(e,t){e.exports=function(e,t){var n=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,n)}}},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"shimGetUserMedia",(function(){return b})),n.d(r,"shimGetDisplayMedia",(function(){return O})),n.d(r,"shimMediaStream",(function(){return k})),n.d(r,"shimOnTrack",(function(){return A})),n.d(r,"shimGetSendersWithDtmf",(function(){return w})),n.d(r,"shimGetStats",(function(){return M})),n.d(r,"shimSenderReceiverGetStats",(function(){return P})),n.d(r,"shimAddTrackRemoveTrackWithNative",(function(){return D})),n.d(r,"shimAddTrackRemoveTrack",(function(){return N})),n.d(r,"shimPeerConnection",(function(){return x})),n.d(r,"fixNegotiationNeeded",(function(){return L}));var i={};n.r(i),n.d(i,"shimGetUserMedia",(function(){return F})),n.d(i,"shimGetDisplayMedia",(function(){return V})),n.d(i,"shimOnTrack",(function(){return j})),n.d(i,"shimPeerConnection",(function(){return U})),n.d(i,"shimSenderGetStats",(function(){return G})),n.d(i,"shimReceiverGetStats",(function(){return H})),n.d(i,"shimRemoveStream",(function(){return q})),n.d(i,"shimRTCDataChannel",(function(){return B})),n.d(i,"shimAddTransceiver",(function(){return W})),n.d(i,"shimGetParameters",(function(){return K})),n.d(i,"shimCreateOffer",(function(){return z})),n.d(i,"shimCreateAnswer",(function(){return J}));var o={};n.r(o),n.d(o,"shimLocalStreamsAPI",(function(){return Y})),n.d(o,"shimRemoteStreamsAPI",(function(){return Q})),n.d(o,"shimCallbacksAPI",(function(){return $})),n.d(o,"shimGetUserMedia",(function(){return X})),n.d(o,"shimConstraints",(function(){return Z})),n.d(o,"shimRTCIceServerUrls",(function(){return ee})),n.d(o,"shimTrackEventTransceiver",(function(){return te})),n.d(o,"shimCreateOfferLegacy",(function(){return ne})),n.d(o,"shimAudioContext",(function(){return re}));var s={};n.r(s),n.d(s,"shimRTCIceCandidate",(function(){return se})),n.d(s,"shimMaxMessageSize",(function(){return ae})),n.d(s,"shimSendThrowTypeError",(function(){return ce})),n.d(s,"shimConnectionState",(function(){return le})),n.d(s,"removeExtmapAllowMixed",(function(){return ue})),n.d(s,"shimAddIceCandidateNullOrEmpty",(function(){return de})),n.d(s,"shimParameterlessSetLocalDescription",(function(){return fe}));var a={PING:1,AUTHEN:2,MESSAGE_TYPE_RATING:14,CALL_START:26,CALL_SDP_CANDIDATE:27,CALL_STOP:28,CALL_SDP_CANDIDATE_FROM_SERVER:29,CALL_STOP_FROM_SERVER:30,CALL_STATE:31,CALL_STATE_FROM_SERVER:32,CALL_START_FROM_SERVER:33,CALL_DTMF:34,CALL_DTMF_FROM_SERVER:35,CALL_INFO:36,CALL_INFO_FROM_SERVER:37,MSG_FROM_OTHER_DEVICE:38,PUSH_DEVICE_TOKEN_REGISTER:39,PUSH_DEVICE_TOKEN_UNREGISTER:40,CHAT_CREATE_CONVERSATION:41,CHAT_MESSAGE:42,CHAT_MESSAGE_FROM_SERVER:45,CHAT_MESSAGE_REPORT:46,CHAT_MESSAGE_REPORT_FROM_SERVER:47,CHAT_CONVERSATION_LOAD:48,CHAT_MESSAGES_LOAD:50,CHAT_CONVERSATION_CLEAR_HISTORY:51,CHAT_DELETE_CONVERSATION:52,CUSTOM_MESSAGE:54,CUSTOM_MESSAGE_FROM_SERVER:55,CHAT_GET_USERS_INFO:56,CHAT_GET_CONVERSATIONS_INFO:57,CHAT_ADD_PARTICIPANT:58,CHAT_ADD_PARTICIPANT_FROM_SERVER:59,CHAT_REMOVE_PARTICIPANT:60,CHAT_REMOVE_PARTICIPANT_FROM_SERVER:61,CHAT_DELETE_MESSAGE:62,CHAT_UPDATE_CONVERSATION:63,CHAT_ROUTE_TO_AGENT:64,CHAT_AGENT_RESPONSE:65,TIMEOUT_ROUTE_TO_AGENT:66,TIMEOUT_ROUTE_TO_QUEUE:67,END_CHAT:68,RATE_CHAT:69,UPDATE_USER_INFO:70,SEND_EMAIL_TRANSCRIPT:71,GET_CHAT_SERVICES:72,VIEW_CHAT:73,JOIN_CHAT_CUSTOMER_CARE:74,CHAT_TRANSFER_TO_ANOTHER_AGENT:77,CHAT_UNREAD_CONVERSATION_COUNT:76,CHAT_CONFIRM_TRANSFER_REQUEST:78,CHAT_TRANSFER_REQUEST_FROM_ANOTHER_AGENT:79,UPDATE_USER_INFO_NOTIFICATION:81,CHAT_USER_BEGIN_TYPING:84,CHAT_USER_END_TYPING:85,CHAT_USER_BEGIN_TYPING_NOTIFICATION:86,CHAT_USER_END_TYPING_NOTIFIACTION:87,CHAT_AGENT_RESOLVE_CONVERSATION:94,CHAT_CONVERSATION_ATTACHMENT:95,CHAT_LOAD_ALL_MESSAGES_FOR_CONVERSATIONS:97,CHAT_CONVERSATION_ENDED_NOTIFICATION:98,CHAT_REQUEST_LOAD:99,HOLD:100,TRANSFER:101,SUBSCRIBE_FROM_SERVER:102,CHANGE_ATTRIBUTE:103,OTHER_DEVICE_AUTHEN:104,CHAT_BLOCK_USER:105,CHAT_JOIN_OA_CONVERSATION:200,VIDEO_ENDPOINT_SDP:108,VIDEO_ENDPOINT_CANDIDATE:109,VIDEO_ENDPOINT_SDP_FROM_SERVER:110,VIDEO_ENDPOINT_CANDIDATE_FROM_SERVER:111,VIDEO_ENDPOINT_MAKE_ROOM:112,VIDEO_ENDPOINT_JOIN_ROOM:115,VIDEO_LEFT_ROOM:116,VIDEO_PUBLISH_TRACK:117,VIDEO_UNPUBLISH_TRACK:118,VIDEO_SUBSCRIBE_TRACK:119,VIDEO_UNSUBSCRIBE_TRACK:120,VIDEO_TRACK_ADDED_FROM_SERVER:121,VIDEO_TRACK_REMOVED_FROM_SERVER:122,VIDEO_ROOM_JOINED_FROM_SERVER:124,VIDEO_ROOM_LEFT_FROM_SERVER:125,VIDEO_ROOM_SEND_MSG:126,VIDEO_ROOM_MSG_FROM_SERVER:127,VIDEO_ROOM_MAKE_CALL:128,VIDEO_ROOM_CALL_INVITE:129,VIDEO_ROOM_CALL_INVITE_CANCEL:130,VIDEO_ROOM_CALL_STATE:131,VIDEO_ROOM_END_CALL:132,VIDEO_ROOM_END_CALL_FROM_SERVER:133,VIDEO_ROOM_CALL_STATE_FROM_SERVER:134,VIDEO_ROOM_TRANSFER_CALL:135,VIDEO_ROOM_HOLD:136,VIDEO_ROOM_ENABLE_DISABLE_AUDIO_VIDEO:138,VIDEO_ROOM_ENABLE_DISABLE_AUDIO_VIDEO_FROM_SERVER:139,VIDEO_ROOM_ENABLE_DISABLE_AUDIO_VIDEO_NOTIFICATION:140,VIDEO_ROOM_RENDER_LAYOUT_INFO:141,VIDEO_ROOM_JOIN_CALL2:142};var c=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=[];return t.size=function(){return this.length},t.isEmpty=function(){return 0===this.length},t.containsKey=function(e){e+="";for(var t=0;t<this.length;t++)if(this[t].key===e)return t;return-1},t.get=function(e){e+="";var t=this.containsKey(e);if(t>-1)return this[t].value},t.put=function(e,t){if(e+="",-1!==this.containsKey(e))return this.get(e);this.push({key:e,value:t})},t.allKeys=function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t].key);return e},t.allIntKeys=function(){for(var e=[],t=0;t<this.length;t++)e.push(parseInt(this[t].key));return e},t.remove=function(e){e+="";var t=this.containsKey(e);t>-1&&this.splice(t,1)},t.clear=function(){for(var e=this.allKeys(),t=0;t<e.length;t++){var n=e[t];this.remove(n)}},t},l=1,u=2,d=3,f=5,h=6;let v=!0,p=!0;function m(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function g(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);const o=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,o),i.apply(this,[e,o])};const o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function y(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(v=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function _(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(p=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function S(){if("object"==typeof window){if(v)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function C(e,t){p&&console.warn(e+" is deprecated, please use "+t+" instead.")}function E(e){return"[object Object]"===Object.prototype.toString.call(e)}function I(e){return E(e)?Object.keys(e).reduce((function(t,n){const r=E(e[n]),i=r?I(e[n]):e[n],o=r&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[n]:i})}),{}):e}function T(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const o=[];return e.forEach(e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(t=>{e.forEach(n=>{n.type===r&&n.trackId===t.id&&function e(t,n,r){n&&!r.has(n.id)&&(r.set(n.id,n),Object.keys(n).forEach(i=>{i.endsWith("Id")?e(t,t.get(n[i]),r):i.endsWith("Ids")&&n[i].forEach(n=>{e(t,t.get(n),r)})}))}(e,n,i)})}),i}const R=S;function b(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"==typeof r.ideal?(e[i("min",n)]=r.ideal,t.optional.push(e),e={},e[i("max",n)]=r.ideal,t.optional.push(e)):(e[i("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const s=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then(n=>{let s=(n=n.filter(e=>"videoinput"===e.kind)).find(e=>t.some(t=>e.label.toLowerCase().includes(t)));return!s&&n.length&&t.includes("back")&&(s=n[n.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=r(e.video),R("chrome: "+JSON.stringify(e)),i(e)})}e.video=r(e.video)}return R("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,e=>{n.webkitGetUserMedia(e,t,e=>{r&&r(o(e))})})}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return i(t,t=>e(t).then(e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(e=>{e.stop()}),new DOMException("","NotFoundError");return e},e=>Promise.reject(o(e))))}}}function O(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(t=>{const r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function k(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function A(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.track.id):{track:n.track};const i=new Event("track");i.track=n.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)}),t.stream.getTracks().forEach(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.id):{track:n};const i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else g(e,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function w(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(e=>{this._senders.push(t(this,e))})};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach(e=>{const t=this._senders.find(t=>t.track===e);t&&this._senders.splice(this._senders.indexOf(t),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function M(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,r]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const i=function(e){const t={};return e.result().forEach(e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(t=>{n[t]=e.stat(t)}),t[n.id]=n}),t},o=function(e){return new Map(Object.keys(e).map(t=>[t,e[t]]))};if(arguments.length>=2){const r=function(e){n(o(i(e)))};return t.apply(this,[r,e])}return new Promise((e,n)=>{t.apply(this,[function(t){e(o(i(t)))},n])}).then(n,r)}}function P(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>T(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),g(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>T(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach(n=>{n.track===e&&(t?r=!0:t=n)}),this.getReceivers().forEach(t=>(t.track===e&&(n?r=!0:n=t),t.track===e)),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function D(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")});const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter(e=>-1===t.indexOf(e));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),i.apply(this,arguments)}}function N(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return D(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(e=>this._reverseStreams[e.id])};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}function s(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const i=this.getSenders().find(e=>e.track===t);if(i)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find(e=>e.track===t)},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then(e=>o(this,e))}};e.RTCPeerConnection.prototype[t]=r[t]}));const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=s(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=c.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach(n=>{this._streams[n].getTracks().find(t=>e.track===t)&&(t=this._streams[n])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function x(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}))}function L(e,t){g(e,"negotiationneeded",e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e})}function F(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){C("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function V(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function j(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function U(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,o]=arguments;return r.apply(this,[e||null]).then(e=>{if(t.version<53&&!i)try{e.forEach(e=>{e.type=n[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(i,o)}}function G(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function H(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),g(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function q(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){C("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function B(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function W(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach(e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(n).then(()=>{delete t.sendEncodings}).catch(()=>{delete t.sendEncodings})))}return r})}function K(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function z(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function J(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function Y(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(n=>t.call(this,n,e)),e.getVideoTracks().forEach(n=>t.call(this,n,e))},e.RTCPeerConnection.prototype.addTrack=function(e,...n){return n&&n.forEach(e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach(e=>{n.includes(e.track)&&this.removeTrack(e)})})}}function Q(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach(e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)})}),t.apply(e,arguments)}}}function $(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};let a=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=a,a=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=a,a=function(e,t,n){const r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=a}function X(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(Z(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function Z(e){return e&&void 0!==e.video?Object.assign({},e,{video:I(e.video)}):e}function ee(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(C("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function te(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ne(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find(e=>"audio"===e.receiver.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find(e=>"video"===e.receiver.track.kind);!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}function re(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var ie=n(43),oe=n.n(ie);function se(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),r=oe.a.parseCandidate(e.candidate),i=Object.assign(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,g(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function ae(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=function(e){if(!e||!e.sdp)return!1;const t=oe.a.splitSections(e.sdp);return t.shift(),t.some(e=>{const t=oe.a.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})},r=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n},i=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},o=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const i=oe.a.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const e=r(arguments[0]),t=i(e),n=o(arguments[0],e);let s;s=0===t&&0===n?Number.POSITIVE_INFINITY:0===t||0===n?Math.max(t,n):Math.min(t,n);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>s}),this._sctp=a}return s.apply(this,arguments)}}function ce(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},g(e,"datachannel",e=>(t(e.channel,e.target),e))}function le(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function ue(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter(e=>"a=extmap-allow-mixed"!==e.trim()).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function de(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function fe(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}if(e.sdp||"offer"!==e.type&&"answer"!==e.type)return n.apply(this,[e]);const t="offer"===e.type?this.createOffer:this.createAnswer;return t.apply(this).then(e=>n.apply(this,[e]))})}!function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=S,a=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=m(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=m(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=m(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),c={browserDetails:a,commonShim:s,extractVersion:m,disableLog:y,disableWarnings:_,sdp:ie};switch(a.browser){case"chrome":if(!r||!x||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),c;if(null===a.version)return n("Chrome shim can not determine version, not shimming."),c;n("adapter.js shimming chrome."),c.browserShim=r,de(e,a),fe(e),b(e,a),k(e),x(e,a),A(e),N(e,a),w(e),M(e),P(e),L(e,a),se(e),le(e),ae(e,a),ce(e),ue(e,a);break;case"firefox":if(!i||!U||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),c;n("adapter.js shimming firefox."),c.browserShim=i,de(e,a),fe(e),F(e,a),U(e,a),j(e),q(e),G(e),H(e),B(e),W(e),K(e),z(e),J(e),se(e),le(e),ae(e,a),ce(e);break;case"safari":if(!o||!t.shimSafari)return n("Safari shim is not included in this adapter release."),c;n("adapter.js shimming safari."),c.browserShim=o,de(e,a),fe(e),ee(e),ne(e),$(e),Y(e),Q(e),te(e),X(e),re(e),se(e),ae(e,a),ce(e),ue(e,a);break;default:n("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window});function he(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var pe=function(){function e(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;he(this,e),this.client=t,this.fromNumber=n,this.toNumber=r,this.custom="",this.customDataFromYourServer="",this.fromAlias=n,this.toAlias=r,this.fromInternal=!0,this.answeredOnAnotherDevice=!1,this.isVideoCall=i,this.isIncomingCall=!1,this.isAnswered=!1,this.isOnHold=!1,this.ended=!1,this.callId="",this._iceServers=null,this.toType="",this.muted=!1,this.localVideoEnabled=i,this._onMethods=new c,this.client._stringeeCalls.push(this),this.videoResolution=null,o&&(console.log("create call object with encryptPhone:",o),this.encryptPhone=o),this._pc=null,this._localStream=null,this._remoteStream=null,this._localSdp=null,this._remoteSdps=new c,this._mapListCandidates=new c,this._answeredDeviceId=null,this._setRemoteSdpOk=!1,this._mediaConnected=!1,this.microphones=[],this.speakers=[],this.cameras=[],this.audioDeviceId=null,this.videoDeviceId=null}var t,n,r;return t=e,(n=[{key:"makeCall",value:function(e){if(this.isIncomingCall)console.log("could not make call, this is a incoming call");else{var t=this,n={fromNumber:this.fromNumber,toNumber:this.toNumber,video:this.isVideoCall,custom:t.custom};t.encryptPhone&&(console.log("passing custom data(encrypted phone number)",t.encryptPhone),n.encryptPhone=t.encryptPhone),this.client._sendMessage(a.CALL_START,n,(function(n){var r=n.r,i=n.iceServers;delete n.iceServers,0===r?(t.callId=n.callId,t._iceServers=i,t.toType=n.toType,t.customDataFromYourServer=n.customDataFromYourServer,t._initPeerConnection(!0,e,n)):(t.ended=!0,e.call(t,n))}))}}},{key:"answer",value:function(e){var t=this;if(this.isIncomingCall)if(this.isAnswered)console.log("Error: call has been answered");else if(this.answeredOnAnotherDevice)console.log("Error: call has been answered on other device");else{this.isAnswered=!0;var n={callId:this.callId,code:200};this.client._sendMessage(a.CALL_STATE,n,(function(n){e&&e.call(t,{r:n.r})})),t.fromInternal||t._onRemoteSDP(),t._checkAndAddCandidateFromQueue()}else console.log("Error: could not answer call, this is a outgoing call")}},{key:"reject",value:function(e){var t=this;if(this.isIncomingCall){t.ended=!0;var n={callId:this.callId,code:486};this.client._sendMessage(a.CALL_STATE,n,(function(n){e&&e.call(t,{r:n.r})})),this._freeResource(),this.onRemove()}else console.log("could not reject call, this is a outgoing call")}},{key:"onRemove",value:function(){var e=this.client._stringeeCalls.indexOf(this);e>-1&&this.client._stringeeCalls.splice(e,1)}},{key:"ringing",value:function(e){var t=this;if(this.isIncomingCall){var n={callId:this.callId,code:180};this.client._sendMessage(a.CALL_STATE,n,(function(n){e&&e.call(t,{r:n.r})}))}else console.log("could not send ringing signal, this is a outgoing call")}},{key:"hangup",value:function(e){var t=this;if(t.ended=!0,t._pc||!e){var n={callId:this.callId};this.client._sendMessage(a.CALL_STOP,n,(function(n){0===n.r&&(t._freeResource(),t.onRemove()),e&&e.call(t,{r:n.r})}))}else e.call(t,{r:-1})}},{key:"sendInfo",value:function(e,t){var n=this,r={callId:this.callId,info:e};this.client._sendMessage(a.CALL_INFO,r,(function(e){t&&t.call(n,{r:e.r})}))}},{key:"sendDtmf",value:function(e,t){var n=this,r={callId:this.callId,digits:e};this.client._sendMessage(a.CALL_DTMF,r,(function(e){t&&t.call(n,{r:e.r})}))}},{key:"sendHold",value:function(e,t){var n=this,r={callId:this.callId,hold:!0,musicOnHold:e};this.client._sendMessage(a.HOLD,r,(function(e){return t&&t.call(n,{r:e.r}),0===e.r&&(n.isOnHold=!0,!0)}))}},{key:"sendUnHold",value:function(e){var t=this,n={callId:this.callId,hold:!1};this.client._sendMessage(a.HOLD,n,(function(n){return e&&e.call(t,{r:n.r}),0===n.r&&(t.isOnHold=!1,!0)}))}},{key:"sendTransfer",value:function(e,t){var n=this,r={callId:this.callId,to:{number:e,type:"internal",alias:e}};this.client._sendMessage(a.TRANSFER,r,(function(e){t&&t.call(n,{r:e.r})}))}},{key:"_initPeerConnection",value:function(e,t,n){var r=this,i={audio:!0,video:r._buildVideoConstraints(!1)};navigator.mediaDevices.getUserMedia(i).then((function(i){t&&t.call(r,n);try{var o={iceServers:r._iceServers},s=new RTCPeerConnection(o);s.onicecandidate=function(e){r._onicecandidate(e)},s.oniceconnectionstatechange=function(e){"connected"===s.iceConnectionState?(r._mediaConnected=!0,r._callOnEvent("mediastate",{reason:"Connected",code:1})):"disconnected"===s.iceConnectionState&&r._callOnEvent("mediastate",{reason:"Disconnected",code:2})},s.ontrack=function(e){r._ontrack(e)},i.getTracks().forEach((function(e){s.addTrack(e,i)})),i.onremovetrack=function(e){console.log("=========localStream1.onremovetrack======",e)},r._pc=s,r._localStream=i,r._callOnEvent("addlocalstream",r._localStream),e?s.createOffer((function(e){r._onCreateLocalSdpSuccess(e)}),r._onCreateLocalSdpError):r._remoteSdps.size()>0&&r._onRemoteSDP(),r.ended&&(r._freeResource(),r.onRemove())}catch(e){console.log(e),r._freeResource(),r.onRemove();var c={callId:r.callId};r.client._sendMessage(a.CALL_STOP,c,(function(e){})),r._callOnEvent("error",{reason:"CREATE_PEER_CONNECTION_ERROR",code:1001,moreInfo:e})}return navigator.mediaDevices.enumerateDevices()})).then((function(e){var t=1;r.microphones=[],r.speakers=[],r.cameras=[];for(var n=0;n<e.length;++n){var i=e[n];if(i.deviceId&&0!==i.deviceId.length)if("audioinput"===i.kind){var o=i.label||"Microphone ".concat(t++);r.microphones.push({label:o,deviceId:i.deviceId})}else"audiooutput"===i.kind?(o=i.label||"Speaker ".concat(t++),r.speakers.push({label:o,deviceId:i.deviceId})):"videoinput"===i.kind&&(o=i.label||"Camera ".concat(t++),r.cameras.push({label:o,deviceId:i.deviceId}))}})).catch((function(e){t&&(n.r=1e3,n.message="GET_USER_MEDIA_ERROR",n.moreInfo=e,t.call(r,n)),r._getUserMediaError(e)}))}},{key:"hold",value:function(){var e=this;return e._pc?e.isAnswered?e.isOnHold?(console.log("Call is on hold"),!1):(e._pc.createOffer((function(t){var n=t.sdp.replace("a=sendrecv","a=sendonly"),r={type:t.type,sdp:n},i=new RTCSessionDescription(r);e._onCreateLocalSdpSuccess(i)}),e._onCreateLocalSdpError),e.isOnHold=!0,!0):(console.log("Call not answered"),!1):(console.log("RTCPeerConnection not created"),!1)}},{key:"unhold",value:function(){var e=this;return e._pc?e.isAnswered?e.isOnHold?(e._pc.createOffer((function(t){var n=t.sdp.replace("a=sendonly","a=sendrecv");n=n.replace("a=inactive","a=sendrecv");var r={type:t.type,sdp:n},i=new RTCSessionDescription(r);e._onCreateLocalSdpSuccess(i)}),e._onCreateLocalSdpError),e.isOnHold=!1,!0):(console.log("Call is not on hold"),!1):(console.log("Call not answered"),!1):(console.log("RTCPeerConnection not created"),!1)}},{key:"_onRemoteSDP",value:function(){var e,t=this,n=!1;0!==t._remoteSdps.size()&&t._pc&&(e=t._remoteSdps.get(t._remoteSdps.allKeys()[0]),null!==t._answeredDeviceId&&void 0!==t._answeredDeviceId||(t._answeredDeviceId=""),"offer"===e.type&&t.fromInternal&&(n=!0),!t.fromInternal&&t.isAnswered&&(n=!0),"answer"===e.type&&t.isAnswered&&(n=!0,e=t._remoteSdps.get(t._answeredDeviceId)),t.isIncomingCall||"external"!==t.toType||(n=!0),n&&e&&(t._pc.setRemoteDescription(e,(function(){t._setRemoteSdpOk=!0,t._checkAndAddCandidateFromQueue(),"offer"===e.type&&t._pc.createAnswer().then((function(e){t._onCreateLocalSdpSuccess(e)}),t._onCreateLocalSdpError)}),(function(e){console.log("setRemoteDescription error",e)})),t._remoteSdps.clear()))}},{key:"_getUserMediaError",value:function(e){this.isIncomingCall?this._callOnEvent("error",{reason:"GET_USER_MEDIA_ERROR",code:1e3,moreInfo:e}):this.client._sendMessage(a.CALL_STOP,{callId:this.callId},(function(e){}))}},{key:"upgradeToVideoCall",value:function(){this.isVideoCall||this._renegotiateForChangeDevice()}},{key:"switchCamera",value:function(){return!(!this.isVideoCall||this.cameras.length<2||(this.videoDeviceId?this.videoDeviceId=null:this.videoDeviceId=this.cameras[1].deviceId,this._renegotiateForChangeDevice(),0))}},{key:"_renegotiateForChangeDevice",value:function(){var e=this,t={audio:!0,video:e._buildVideoConstraints(!0)};navigator.mediaDevices.getUserMedia(t).then((function(t){e._localStream.getTracks().forEach((function(e){e.stop()})),t.getTracks().forEach((function(n){e._pc.addTrack(n,t)})),e._localStream=t,e._callOnEvent("addlocalstream",e._localStream),e._pc.createOffer((function(t){e._onCreateLocalSdpSuccess(t)}),e._onCreateLocalSdpError),e.isVideoCall=!0,e.localVideoEnabled=!0})).catch((function(t){e._getUserMediaError(t)}))}},{key:"_buildVideoConstraints",value:function(e){if(!e&&!this.isVideoCall)return!1;var t={deviceId:this.videoDeviceId?{exact:this.videoDeviceId}:void 0};return e?this.videoResolution?this.videoDeviceId?{width:{exact:this.videoResolution.width},height:{exact:this.videoResolution.height},deviceId:{exact:this.videoDeviceId}}:{width:{exact:this.videoResolution.width},height:{exact:this.videoResolution.height}}:t:this.isVideoCall&&this.videoResolution?this.videoDeviceId?{width:{exact:this.videoResolution.width},height:{exact:this.videoResolution.height},deviceId:{exact:this.videoDeviceId}}:{width:{exact:this.videoResolution.width},height:{exact:this.videoResolution.height}}:t}},{key:"_checkAndAddCandidateFromQueue",value:function(){if(this.isAnswered&&this._pc&&this._setRemoteSdpOk){this._answeredDeviceId||(this._answeredDeviceId=this._mapListCandidates.allKeys()[0]);var e=this._mapListCandidates.get(""+this._answeredDeviceId);if(e)for(;;){var t=e.pop();if(!t)break;this._pc.addIceCandidate(t)}}}},{key:"_onicecandidate",value:function(e){if(e.candidate){var t=e.candidate;this._sendCallSdpCandidate(this.callId,"candidate",t)}}},{key:"_ontrack",value:function(e){this._remoteStream=e.streams[0],this._callOnEvent("addremotestream",this._remoteStream)}},{key:"_onCreateLocalSdpSuccess",value:function(e){var t=this;this._localSdp=e,this._pc.setLocalDescription(e,(function(){t._sendCallSdpCandidate(t.callId,"sdp",e)}),(function(e){console.log("+++++++++ setLocalDescription error",e)}))}},{key:"_onCreateLocalSdpError",value:function(e){console.log(e)}},{key:"_sendCallSdpCandidate",value:function(e,t,n){var r={callId:e,type:t,data:n};this.client._sendMessage(a.CALL_SDP_CANDIDATE,r,(function(e){}))}},{key:"_freeResource",value:function(){if(this._pc){var e=this;this._pc.close(),this._pc=null,this._localStream&&this._localStream.getTracks().forEach((function(t){t.stop(),e._localStream.removeTrack(t)})),this._localStream=null,this._remoteStream=null}}},{key:"mute",value:function(e){var t=this;t._localStream.getAudioTracks().forEach((function(n){e?(n.enabled=!1,t.muted=!0):(n.enabled=!0,t.muted=!1)}))}},{key:"enableLocalVideo",value:function(e){var t=this,n=!1;return t._localStream.getVideoTracks().forEach((function(r){n=!0,r.enabled=e,t.localVideoEnabled=e})),n}},{key:"on",value:function(e,t){this._onMethods.put(e,t)}},{key:"_callOnEvent",value:function(e,t){var n=this._onMethods.get(e);n?t?n.call(this,t):n.call(this):console.log("Please implement StringeeCall event: "+e)}},{key:"restartIce",value:function(){var e=this;if(!e._pc)return console.log("RTCPeerConnection not created"),!1;console.log("restartIce+++++");var t={offerToReceiveAudio:1,offerToReceiveVideo:1,iceRestart:!0};return e._setLocalSdpOk||!e.isIncomingCall?(console.log("=====create offer==="),e._pc.createOffer((function(t){e._onCreateLocalSdpSuccess(t)}),e._onCreateLocalSdpError,t)):(console.log("=====create Answer==="),e._pc.createAnswer().then((function(t){e._onCreateLocalSdpSuccess(t)}),e._onCreateLocalSdpError,t)),!0}}])&&ve(t.prototype,n),r&&ve(t,r),e}();var me=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t,this.msg=n,this.jsError=r};function ge(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function ye(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){ge(o,r,i,s,a,"next",e)}function a(e){ge(o,r,i,s,a,"throw",e)}s(void 0)}))}}function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(94),n(95);var Se=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.localId=we.genLocalPeerConnectionId(),this.serverId="",this.pc=null,this.eventHandler=null,this.mediaConnected=!1,this.localStream=null,this.remoteStream=null,this.stopped=!1,this.iceServers=t,this.localSdp=null,this.localCandidates=new Array,this.muted=!1,this.localVideoEnabled=!1,this.localAudioEnabled=!1,this.localConstraints=null}var t,n,r,i,o,s,a;return t=e,(n=[{key:"initPeerConnection",value:(a=ye(regeneratorRuntime.mark((function e(t,n,r,i){var o,s,a,c,l,u,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=d.length>4&&void 0!==d[4]?d[4]:null,s=!(d.length>5&&void 0!==d[5])||d[5],a=null,c=this,this.eventHandler=r,this.localConstraints=n,null!==o||!s){e.next=36;break}if(e.prev=7,!n.screen){e.next=26;break}if(!navigator.getDisplayMedia){e.next=15;break}return e.next=12,navigator.getDisplayMedia({video:!0,audio:n.screenAudio});case 12:a=e.sent,e.next=24;break;case 15:if(!navigator.mediaDevices.getDisplayMedia){e.next=21;break}return e.next=18,navigator.mediaDevices.getDisplayMedia({video:!0,audio:n.screenAudio});case 18:a=e.sent,e.next=24;break;case 21:return e.next=23,navigator.mediaDevices.getUserMedia({video:{mediaSource:"screen"}});case 23:a=e.sent;case 24:e.next=29;break;case 26:return e.next=28,navigator.mediaDevices.getUserMedia(n);case 28:a=e.sent;case 29:e.next=34;break;case 31:throw e.prev=31,e.t0=e.catch(7),new me(1,"getUserMediaError",e.t0);case 34:e.next=37;break;case 36:a=o;case 37:if(e.prev=37,(l=new RTCPeerConnection({iceServers:c.iceServers})).onicecandidate=function(e){e.candidate&&c.localCandidates.push(e.candidate),r.onCandidate(e.candidate)},l.oniceconnectionstatechange=function(e){"connected"===l.iceConnectionState?(c.mediaConnected=!0,r.onIceConnectionStateChange(c.mediaConnected)):"disconnected"===l.iceConnectionState&&(c.mediaConnected=!1,r.onIceConnectionStateChange(c.mediaConnected))},l.ontrack=function(e){if(e.streams.length>0){c.remoteStream=e.streams[0];var t="";e.track&&(t=e.track.kind),r.onTrack(e,t)}},a&&(a.getTracks().forEach((function(e){n.screen&&(e.onended=function(){r.onTrackEnded()}),l.addTrack(e,a)})),c.localVideoEnabled=a.getVideoTracks().length>0,c.localAudioEnabled=a.getAudioTracks().length>0,c.localAudioEnabled||(this.muted=!0),c.localStream=a,n.video||l.addTransceiver("video"),n.audio||l.addTransceiver("audio")),c.pc=l,!t){e.next=65;break}return e.prev=45,e.next=48,l.createOffer(i);case 48:return u=e.sent,c.localSdp=u,e.prev=50,e.next=53,c.pc.setLocalDescription(u);case 53:e.next=59;break;case 55:throw e.prev=55,e.t1=e.catch(50),c.freeResource(),new me(4,"setLocalDescriptionError",e.t1);case 59:e.next=65;break;case 61:throw e.prev=61,e.t2=e.catch(45),c.freeResource(),new me(3,"createOfferError",e.t2);case 65:return c.stopped&&c.freeResource(),e.abrupt("return",c);case 69:throw e.prev=69,e.t3=e.catch(37),c.freeResource(),new me(2,"peerConnectionError",e.t3);case 73:case"end":return e.stop()}}),e,this,[[7,31],[37,69],[45,61],[50,55]])}))),function(e,t,n,r){return a.apply(this,arguments)})},{key:"changeDevice",value:function(e,t){var n=this;return new Promise((function(r,i){"audio"==e?n.localConstraints.audio=t.audio:"video"==e?(t.video||(t.video=!0),n.localConstraints.video=t.video):"both"==e&&(n.localConstraints=t),navigator.mediaDevices.getUserMedia(t).then((function(t){var i=null,o=null;t.getTracks().forEach((function(e){"audio"===e.kind?i=e:"video"===e.kind&&(o=e)})),n.muted&&i&&(i.enabled=!1);var s=null,a=null,c=null;n.pc.getSenders().forEach((function(e){e.track&&"audio"===e.track.kind?s=e:e.track&&"video"===e.track.kind?a=e:null==e.track&&(c=e)})),i&&(s?s.replaceTrack(i):c&&c.replaceTrack(i)),o&&(a?a.replaceTrack(o):c&&c.replaceTrack(o)),n.localStream.getTracks().forEach((function(t){e!==t.kind&&"both"!==e||(t.stop(),n.localStream.removeTrack(t))})),i&&n.localStream.addTrack(i),o&&n.localStream.addTrack(o),r()})).catch((function(e){i(e)}))}))}},{key:"initPeerConnectionNoAccessDevice",value:(s=ye(regeneratorRuntime.mark((function e(t,n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.initPeerConnection(t,null,r,n,void 0,!1));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"freeResource",value:function(){this.pc&&(this.pc.close(),this.pc=null);var e=this;this.localStream&&this.localStream.getTracks().forEach((function(t){t.stop(),e.localStream.removeTrack(t)})),this.localStream=null,this.remoteStream=null,this.eventHandler.onWebRtcClose()}},{key:"onReceiveSdp",value:function(e){this.pc.setRemoteDescription(e,(function(){}),(function(e){console.log("setRemoteDescription error",e)}))}},{key:"onReceiveCandidate",value:function(e){this.pc.addIceCandidate(e)}},{key:"mute",value:(o=ye(regeneratorRuntime.mark((function e(t){var n,r,i,o,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:null,!((r=this).localStream.getAudioTracks().length>0)){e.next=6;break}r.localStream.getAudioTracks().forEach((function(e){t?(e.enabled=!1,r.muted=!0):(e.enabled=!0,r.muted=!1)})),e.next=19;break;case 6:if(t){e.next=19;break}return i=n?{audio:{deviceId:{exact:n}},video:!1}:{audio:!0},o=r.muted,e.prev=9,r.muted=!1,e.next=13,r.changeDevice("audio",i);case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(9),r.muted=o,console.log("StringeeVideoTrack this.webrtc.changeDevice error ===========",e.t0);case 19:case"end":return e.stop()}}),e,this,[[9,15]])}))),function(e){return o.apply(this,arguments)})},{key:"enableLocalVideo",value:(i=ye(regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,r=!1,t){e.next=6;break}n.localStream.getVideoTracks().forEach((function(e){r=!0,e.stop(),n.localStream.removeTrack(e),n.localVideoEnabled=!1})),e.next=18;break;case 6:return i={audio:!1,video:n.localConstraints.video},e.prev=7,e.next=10,n.changeDevice("video",i);case 10:r=!0,n.localVideoEnabled=!0,e.next=18;break;case 14:e.prev=14,e.t0=e.catch(7),console.log("StringeeVideoTrack this.webrtc.changeDevice error ===========",e.t0),r=!1;case 18:return e.abrupt("return",r);case 19:case"end":return e.stop()}}),e,this,[[7,14]])}))),function(e){return i.apply(this,arguments)})}])&&_e(t.prototype,n),r&&_e(t,r),e}();function Ce(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function Ee(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){Ce(o,r,i,s,a,"next",e)}function a(e){Ce(o,r,i,s,a,"throw",e)}s(void 0)}))}}function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(94),n(95);var Te=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isLocal=!0,this.roomConnected=null,this.localSdpToSend=null,this.localCandidatesForSend=new Array,this.serverId="",this.serverPeerConnectionId="",this.stringeeClient=t,this.audio=!1,this.video=!1,this.screen=!1,this.screenAudio=!1,this.mobileCamera,this.userData=null,this.constraints={},n.audio?(this.constraints.audio=!0,this.audio=!0):n.audioDeviceId=null,n.screen&&(this.constraints.screen=!0,this.screen=!0,n.screenAudio?(this.screenAudio=!0,this.constraints.screenAudio=!0,this.constraints.audio=!0,this.audio=!0):(this.screenAudio=!1,this.constraints.screenAudio=!1),this.video=!1),n.video?(this.video=!0,this.constraints.video=!0):(n.videoDeviceId=null,n.videoDimensions=null),n.videoDimensions&&(this.constraints.video=n.videoDimensions),n.videoDeviceId?(this.videoDeviceId=n.videoDeviceId,n.videoDimensions?this.constraints.video.deviceId={exact:n.videoDeviceId}:this.constraints.video={deviceId:{exact:n.videoDeviceId}}):this.videoDeviceId=null,this.constraints.video&&n.mobileCamera&&(!0===this.constraints.video&&(this.constraints.video={}),"front"==n.mobileCamera?(this.constraints.video.facingMode="user",this.mobileCamera="front"):"back"==n.mobileCamera?(this.constraints.video.facingMode="environment",this.mobileCamera="back"):""!=n.mobileCamera&&null!=n.mobileCamera&&(this.mobileCamera=null,console.log('options.mobileCamera must be: "front" or "back"'))),n.audioDeviceId?(this.audioDeviceId=n.audioDeviceId,this.constraints.audio={deviceId:{exact:n.audioDeviceId}}):this.audioDeviceId=null,this.webrtc=new Se(t.ice_servers),this.localId=this.webrtc.localId,this.onMethods=new c,this.elements=[],this.callOnReady=!1,this.muted=!1,this.localVideoEnabled=!1,this.localAudioEnabled=!1,this.audioDeviceId=null,this.speakerDeviceId=null,this.lastAudioBytesSent=-1,this.lastVideoBytesSent=-1,this.lastAudioBytesReceived=-1,this.lastVideoBytesReceived=-1,this.lastTimestampGetBytes=-1}var t,n,r,i,o,s;return t=e,(n=[{key:"getBW",value:function(){var e=this;return new Promise((function(t,n){var r={audioSent:0,videoSent:0,audioReceived:0,videoReceived:0};e.getStats((function(n){var i=(new Date).getTime(),o=i-e.lastTimestampGetBytes;for(var s in e.lastTimestampGetBytes=i,n){var a=n[s];"audio"===a.mediaType&&a.bytesSent&&(e.lastAudioBytesSent>-1&&(r.audioSent=Math.round(8*(a.bytesSent-e.lastAudioBytesSent)/o)),e.lastAudioBytesSent=a.bytesSent),"video"===a.mediaType&&a.bytesSent&&(e.lastVideoBytesSent>-1&&(r.videoSent=Math.round(8*(a.bytesSent-e.lastVideoBytesSent)/o)),e.lastVideoBytesSent=a.bytesSent),"audio"===a.mediaType&&a.bytesReceived&&(e.lastAudioBytesReceived>-1&&(r.audioReceived=Math.round(8*(a.bytesReceived-e.lastAudioBytesReceived)/o)),e.lastAudioBytesReceived=a.bytesReceived),"video"===a.mediaType&&a.bytesReceived&&(e.lastVideoBytesReceived>-1&&(r.videoReceived=Math.round(8*(a.bytesReceived-e.lastVideoBytesReceived)/o)),e.lastVideoBytesReceived=a.bytesReceived)}t(r)}))}))}},{key:"buildConstraints",value:function(e){var t={};return e.audio?(t.audio=!0,e.audioDeviceId&&(t.audio={deviceId:{exact:e.audioDeviceId}})):e.audioDeviceId=null,e.video?t.video=!0:(e.videoDeviceId=null,e.videoDimensions=null),e.videoDimensions&&(t.video=e.videoDimensions),e.videoDeviceId&&(e.videoDimensions?t.video.deviceId={exact:e.videoDeviceId}:t.video={deviceId:{exact:e.videoDeviceId}}),t.video&&e.mobileCamera&&(!0===t.video&&(t.video={}),"front"==e.mobileCamera?t.video.facingMode="user":"back"==e.mobileCamera?t.video.facingMode="environment":""!=e.mobileCamera&&null!=e.mobileCamera&&console.log('options.mobileCamera must be: "front" or "back"')),t}},{key:"init",value:(s=Ee(regeneratorRuntime.mark((function e(){var t,n,r,i,o,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:null,r={onTrack:function(e,t){var r=e.streams[0];n.onRemoteStream(r,t)},onIceConnectionStateChange:function(e){var t={isConnected:e,localId:n.localId,roomId:n.roomConnected.roomId,serverPcId:n.webrtc.serverId,isLocal:n.isLocal,serverTrackId:n.serverId};n.callOnEvent("mediastate",t)},onCandidate:function(e){n.localCandidatesForSend.push(e),n.processSendSdpCandidate()},onTrackEnded:function(){n.callOnEvent("trackended")},onWebRtcClose:function(){}},!(n=this).isLocal){e.next=9;break}return i={offerToReceiveAudio:1,offerToReceiveVideo:1},e.next=7,n.webrtc.initPeerConnection(!0,n.constraints,r,i,t,!0);case 7:e.next=14;break;case 9:return(i={}).offerToReceiveAudio=1,i.offerToReceiveVideo=1,e.next=14,n.webrtc.initPeerConnectionNoAccessDevice(!0,i,r);case 14:return n.localSdpToSend=n.webrtc.localSdp,n.processSendSdpCandidate(),e.prev=16,e.next=19,navigator.mediaDevices.enumerateDevices();case 19:o=e.sent,n._gotDevices(o),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(16),console.log("++++++++ error enumerateDevices ++++++++",e.t0);case 26:return n.localVideoEnabled=n.webrtc.localVideoEnabled,n.localAudioEnabled=n.webrtc.localAudioEnabled,n.localAudioEnabled||(this.muted=!0),e.abrupt("return",this);case 30:case"end":return e.stop()}}),e,this,[[16,23]])}))),function(){return s.apply(this,arguments)})},{key:"switchCamera",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!this.screen){var t=this;"front"==this.mobileCamera||""==this.mobileCamera||null==this.mobileCamera?this.mobileCamera="back":this.mobileCamera="front",this.videoDeviceId=null;var n=t.webrtc.localStream;n.getTracks().forEach((function(e){e.stop(),n.removeTrack(e)}));var r={audio:!0,video:!0,screen:!1,videoDimensions:e,videoDeviceId:null,mobileCamera:t.mobileCamera};t.changeDevice("both",null,r)}}},{key:"_gotDevices",value:function(e){var t=1;we.microphones=[],we.speakers=[],we.cameras=[];for(var n=0;n<e.length;++n){var r=e[n];if(r.deviceId&&0!==r.deviceId.length)if("audioinput"===r.kind){var i=r.label||"Microphone ".concat(t++);we.microphones.push({label:i,deviceId:r.deviceId,groupId:r.groupId})}else"audiooutput"===r.kind?(i=r.label||"Speaker ".concat(t++),we.speakers.push({label:i,deviceId:r.deviceId,groupId:r.groupId})):"videoinput"===r.kind&&(i=r.label||"Camera ".concat(t++),we.cameras.push({label:i,deviceId:r.deviceId,groupId:r.groupId}))}this.onMethods.get("gotDevicesInfo")&&this.callOnEvent("gotDevicesInfo",{microphones:we.microphones,speakers:we.speakers,cameras:we.cameras})}},{key:"onRemoteStream",value:function(e,t){this.callOnReady||(this.callOnReady=!0,this.callOnEvent("ready",t))}},{key:"processSendSdpCandidate",value:function(){if(this.roomConnected&&this.webrtc){if(this.localSdpToSend){var e={data:this.localSdpToSend,roomId:this.roomConnected.roomId,serverPcId:this.webrtc.serverId,isLocal:this.isLocal,serverTrackId:this.serverId};this.stringeeClient._sendMessage(a.VIDEO_ENDPOINT_SDP,e,(function(e){})),this.localSdpToSend=null}for(;this.localCandidatesForSend.length>0;){var t=this.localCandidatesForSend.pop();t&&(e={data:t,roomId:this.roomConnected.roomId,serverPcId:this.webrtc.serverId,isLocal:this.isLocal,serverTrackId:this.serverId},this.stringeeClient._sendMessage(a.VIDEO_ENDPOINT_CANDIDATE,e,(function(e){})))}}}},{key:"attach",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n="video";t&&(n="audio");var r=document.createElement(n);return r.classList.add("stringee-video-track-"+this.localId),r.srcObject=null,this.isLocal?r.srcObject=this.webrtc.localStream:r.srcObject=this.webrtc.remoteStream,r.setAttribute("autoplay","true"),r.setAttribute("playsinline","true"),this.isLocal&&(r.muted=!0),this.speakerDeviceId&&r.setSinkId(this.speakerDeviceId).then().catch((function(t){e.speakerDeviceId=null})),this.elements.push(r),r}},{key:"routeAudioToSpeaker",value:function(e){var t=!1,n=this;return this.speakerDeviceId=e,this.elements.forEach((function(r){void 0!==r.sinkId?r.setSinkId(e).then().catch((function(e){n.speakerDeviceId=null})):(this.speakerDeviceId=null,t=!1)})),t}},{key:"changeDevice",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this;if(n=r?this.buildConstraints(r):Object.assign({},this.constraints),"video"==e)n.audio=!1,n.video||(n.video={}),r||(!0===n.video&&(n.video={}),n.video.deviceId={exact:t});else if("audio"==e)n.video=!1,n.audio||(n.audio={}),r||(!0===n.audio&&(n.audio={}),n.audio.deviceId={exact:t});else if("both"!=e)return void console.log('type must be "audio", "video" or "both"');this.webrtc.changeDevice(e,n).then((function(){"video"==e?i.videoDeviceId=t:i.audioDeviceId=t,i.callOnEvent("changedevice",{type:e,newDeiceId:t,newOptions:r})})).catch((function(e){console.log("StringeeVideoTrack this.webrtc.changeDevice error ===========",e)}))}},{key:"detach",value:function(){return this.elements}},{key:"detachAndRemove",value:function(){this.elements.forEach((function(e){e.remove()}))}},{key:"getMediaStream",value:function(){return this.webrtc?this.isLocal?this.webrtc.localStream:this.webrtc.remoteStream:null}},{key:"onSdpFromServer",value:function(e){this.webrtc&&this.webrtc.onReceiveSdp(e)}},{key:"onCandidateFromServer",value:function(e){this.webrtc&&this.webrtc.onReceiveCandidate(e)}},{key:"close",value:function(){this.webrtc.freeResource()}},{key:"mute",value:(o=Ee(regeneratorRuntime.mark((function e(t){var n,r,i,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:null,r=!(o.length>2&&void 0!==o[2])||o[2],e.next=4,this.webrtc.mute(t,n);case 4:if(this.muted=this.webrtc.muted,this.audio=!this.muted,r&&this.roomConnected){e.next=8;break}return e.abrupt("return");case 8:i={roomId:this.roomConnected.roomId,mediaType:1,enable:!t,serverTrackId:this.serverId},this.stringeeClient._sendMessage(a.VIDEO_ROOM_ENABLE_DISABLE_AUDIO_VIDEO,i,(function(e){}));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"enableLocalVideo",value:(i=Ee(regeneratorRuntime.mark((function e(t){var n,r,i,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(o.length>1&&void 0!==o[1])||o[1],e.next=3,this.webrtc.enableLocalVideo(t);case 3:return r=e.sent,this.localVideoEnabled=this.webrtc.localVideoEnabled,this.video=this.localVideoEnabled,r&&n&&this.roomConnected&&(i={roomId:this.roomConnected.roomId,mediaType:2,enable:t,serverTrackId:this.serverId},this.stringeeClient._sendMessage(a.VIDEO_ROOM_ENABLE_DISABLE_AUDIO_VIDEO,i,(function(e){}))),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"disableRemoteVideo",value:function(){var e=this;return new Promise((function(t,n){if(e.roomConnected&&e.stringeeClient){console.log("disableRemoteVideo111");var r={roomId:e.roomConnected.roomId,mediaType:2,enable:!1,serverTrackId:e.serverId,disableRemote:!0};e.stringeeClient._sendMessage(a.VIDEO_ROOM_ENABLE_DISABLE_AUDIO_VIDEO,r,(function(e){console.log("this1.stringeeClient._sendMessage(VIDEO_ROOM_ENABLE_DISABLE_AUDIO_VIDEO ++++++++ = ",e),0==e.r?t():n(e)}))}else n("not connected to room")}))}},{key:"disableRemoteAudio",value:function(){var e=this;return new Promise((function(t,n){if(e.roomConnected&&e.stringeeClient){console.log("disableRemoteAudio111");var r={roomId:e.roomConnected.roomId,mediaType:1,enable:!1,serverTrackId:e.serverId,disableRemote:!0};e.stringeeClient._sendMessage(a.VIDEO_ROOM_ENABLE_DISABLE_AUDIO_VIDEO,r,(function(e){console.log("this1.stringeeClient._sendMessage(VIDEO_ROOM_ENABLE_DISABLE_AUDIO_VIDEO ++++++++ = ",e),0==e.r?t():n(e)}))}else n("not connected to room")}))}},{key:"on",value:function(e,t){var n=this.onMethods.get(e);n||(n=new Array,this.onMethods.put(e,n)),n.push(t)}},{key:"callOnEvent",value:function(e,t){var n=this,r=this.onMethods.get(e);r?r.forEach((function(e){t?e.call(n,t):e.call(n)})):console.log("Please implement StringeeVideoTrack event: "+e)}},{key:"getStats",value:function(e){if(this.webrtc&&this.webrtc.pc)if(navigator.mozGetUserMedia){var t=this.webrtc.getReceivers().find((function(e){return"audio"==e.kind}));this.webrtc.getStats(t).then((function(t){var n={};t.forEach((function(e){if(("inboundrtp"==e.type||"outboundrtp"==e.type||"inbound-rtp"==e.type||"outbound-rtp"==e.type)&&(e.id.startsWith("inbound_rtp")||e.id.startsWith("outbound_rtp"))){var t={};for(var r in e)"bytesSent"!=r&&"packetsSent"!=r&&"mediaType"!=r&&"bytesReceived"!=r&&"packetsReceived"!=r&&"packetsLost"!=r||(t[r]=e[r]);n[e.id]=t}})),e(n)})).catch((function(e){console.log(e)}))}else this.webrtc.pc.getStats((function(t){var n={};t.result().forEach((function(e){if("ssrc"==e.type){var t={};e.names().forEach((function(n){"bytesSent"!=n&&"packetsSent"!=n&&"mediaType"!=n&&"bytesReceived"!=n&&"packetsReceived"!=n&&"packetsLost"!=n||(t[n]=e.stat(n))})),n[e.id]=t}})),e(n)}));else e("PC closed")}}])&&Ie(t.prototype,n),r&&Ie(t,r),e}();function Re(e){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Oe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stringeeClient=t,this.roomId=null,this.tracks=new c,this.mapServerIdTracks=new c,this.onMethods=new c,this.permissionSubscribe=!1,this.permissionPublish=!1,this.permissionControlRoom=!1}var t,n,r;return t=e,(n=[{key:"publish",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=new Promise((function(r,i){if(e.isLocal){var o={roomId:n.roomId,localPcId:e.webrtc.localId,audio:!!e.audio,video:!!e.video,screen:!!e.constraints.screen};t&&("object"===Re(t)?(o.userData=t,e.userData=t):console.log("userData is not object, ignore it")),n.stringeeClient._sendMessage(a.VIDEO_PUBLISH_TRACK,o,(function(t){0==t.r?(e.serverId=t.serverTrackId,e.webrtc.serverId=t.serverPcId,n.tracks.put(e.localId,e),n.mapServerIdTracks.put(e.serverId,e),e.roomConnected=n,r(),e.processSendSdpCandidate(),e.on("trackended",(function(){n.unpublish(e)}))):i(t)}))}else i("Could not publish remote track")}));return r}},{key:"unpublish",value:function(e){if(e.isLocal){var t={roomId:e.roomConnected.roomId,serverTrackId:e.serverId};this.stringeeClient._sendMessage(a.VIDEO_UNPUBLISH_TRACK,t,(function(e){0==e.r&&console.info("VIDEO_UNPUBLISH_TRACK",e)}))}else console.info("Could not unpublish remote track")}},{key:"subscribe",value:function(e,t){var n=this;return t||(t={audio:!0,video:!0,screen:!1}),new Promise((function(r,i){var o=n.mapServerIdTracks.get(e);if(o)r(o);else{var s=we.genLocalPeerConnectionId(),c={roomId:n.roomId,localPcId:s,subscribeTrackId:e};n.stringeeClient._sendMessage(a.VIDEO_SUBSCRIBE_TRACK,c,(function(o){if(0==o.r){o.trackScreenSharing&&(t.video=!0);var a=new Te(n.stringeeClient,t);a.serverId=e,a.isLocal=!1,a.roomConnected=n,a.localId=s,a.webrtc.localId=s,a.webrtc.serverId=o.serverPcId,a.audio=o.trackAudioEnable&&t.audio,a.video=o.trackVideoEnable&&t.video,a.screen=o.trackScreenSharing&&t.video,a.userPublish=o.userPublish,a.stringeeClientPublish=o.stringeeClientPublish,n.tracks.put(a.localId,a),n.mapServerIdTracks.put(a.serverId,a),r(a),a.init(),a.processSendSdpCandidate()}else i(o)}))}}))}},{key:"unsubscribe",value:function(e){var t=this,n={roomId:t.roomId,serverTrackId:e.serverId,serverPcId:e.webrtc.serverId};t.stringeeClient._sendMessage(a.VIDEO_UNSUBSCRIBE_TRACK,n,(function(n){0==n.r&&(console.log("unsubscribe serverTrackId OK: "+e.serverId),e.close(),t.tracks.remove(e.localId),t.mapServerIdTracks.remove(e.serverId))}))}},{key:"leave",value:function(e){var t=this;return t.tracks.forEach((function(e){e.value.close(),t.tracks.remove(e.localId),t.mapServerIdTracks.remove(e.serverId)})),new Promise((function(n,r){var i={roomId:t.roomId,allStringeeClient:e};t.stringeeClient._sendMessage(a.VIDEO_LEFT_ROOM,i,(function(e){we.rooms.remove(t.roomId),0==e.r?n():r(e)}))}))}},{key:"sendMessage",value:function(e){var t=this;return new Promise((function(n,r){var i={roomId:t.roomId,msg:e};t.stringeeClient._sendMessage(a.VIDEO_ROOM_SEND_MSG,i,(function(e){0==e.r?n():r(e)}))}))}},{key:"onReceiveSdp1",value:function(e,t,n){var r=this.tracks.get(e);r?r.onSdpFromServer(n):console.log("StringeeVideoRoom onReceiveSdp1: Could not found localTrackId="+e)}},{key:"onReceiveCandidate1",value:function(e,t,n){var r=this.tracks.get(e);r?r.onCandidateFromServer(n):console.log("StringeeVideoRoom onReceiveCandidate1: Could not found localTrackId="+e)}},{key:"clearAllOnMethos",value:function(){this.onMethods.clear()}},{key:"on",value:function(e,t){var n=this.onMethods.get(e);n||(n=new Array,this.onMethods.put(e,n)),n.push(t)}},{key:"callOnEvent",value:function(e,t){var n=this,r=this.onMethods.get(e);r?r.forEach((function(e){t?e.call(n,t):e.call(n)})):console.log("Please implement StringeeVideoRoom event: "+e)}},{key:"onTrackAdded",value:function(e){var t={info:e};this.callOnEvent("addtrack",t)}},{key:"onTrackRemoved",value:function(e){var t=this.mapServerIdTracks.get(e.track.serverId),n={info:e};t&&(n.track=t,t.close(),this.mapServerIdTracks.remove(e.track.serverId)),this.callOnEvent("removetrack",n)}},{key:"onRoomJoined",value:function(e){var t={info:e};this.callOnEvent("joinroom",t)}},{key:"onRoomLeft",value:function(e){var t={info:e};this.callOnEvent("leaveroom",t)}},{key:"onRoomMsg",value:function(e){var t={info:e};this.callOnEvent("message",t)}},{key:"onTrackChangeAudioVideoEnableDisable",value:function(e){var t=this.mapServerIdTracks.get(e.track.serverId);if(t){1==e.mediaType?t.audio=e.enable:2==e.mediaType&&(t.video=e.enable),e.disableRemote&&t.isLocal&&(1!=e.mediaType||e.enable?2!=e.mediaType||e.enable||t.enableLocalVideo(!1,!1):t.mute(!0,null,!1));var n={track:t,enable:e.enable,mediaChange:1==e.mediaType?"audio":"video"};this.callOnEvent("trackmediachange",n)}}},{key:"sendRenderLayoutInfo",value:function(e,t){var n=this;return new Promise((function(r,i){var o={roomId:n.roomId,layout:e,subscribedTracks:t};n.stringeeClient._sendMessage(a.VIDEO_ROOM_RENDER_LAYOUT_INFO,o,(function(e){0==e.r?r(e):i(e)}))}))}}])&&be(t.prototype,n),r&&be(t,r),e}();function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var we=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"genLocalTrackId",value:function(){if(0==e.ID_GEN){var t=new Date;e.ID_GEN=t.getTime()}return e.ID_GEN++,"track-"+e.ID_GEN}},{key:"genLocalPeerConnectionId",value:function(){if(0==e.ID_GEN){var t=new Date;e.ID_GEN=t.getTime()}return e.ID_GEN++,"pc-"+e.ID_GEN}},{key:"makeCall",value:function(t,n,r,i,o){return new Promise((function(s,c){var l={fromNumber:n,toNumber:r,video:i,custom:o};t._sendMessage(a.VIDEO_ROOM_MAKE_CALL,l,(function(n){if(console.log("res",n),0==n.r){var r=new Oe(t);r.roomId=n.roomId,e.rooms.put(r.roomId,r);var i={room:r,roomToken:n.roomToken,callId:n.callId};s(i)}else c(n)}))}))}},{key:"createRoom",value:function(t){return new Promise((function(n,r){t._sendMessage(a.VIDEO_ENDPOINT_MAKE_ROOM,{},(function(i){if(0==i.r){var o=new Oe(t);o.roomId=i.roomId,e.rooms.put(o.roomId,o),n(o)}else r(i)}))}))}},{key:"joinRoom",value:function(t,n){return new Promise((function(r,i){var o={roomToken:n};t._sendMessage(a.VIDEO_ENDPOINT_JOIN_ROOM,o,(function(n){if(0==n.r){var o=e.rooms.get(n.roomId);o||(o=new Oe(t)),o.roomId=n.roomId,o.permissionSubscribe=n.permissionSubscribe,o.permissionPublish=n.permissionPublish,o.permissionControlRoom=n.permissionControlRoom,o.record=n.record,e.rooms.put(o.roomId,o);var s={room:o,listTracksInfo:n.tracks,listUsersInfo:n.users,listStringeeClients:n.listStringeeClients};r(s)}else i(n)}))}))}},{key:"createLocalVideoTrack",value:function(e,t){var n,r=new Te(e,t);return r.isLocal=!0,n=r.init(),r.on("changedevice",(function(e){console.log("++++++++++localTrack changedevice",e),("both"===e.type||"video"===e.type)&&r.detach().forEach((function(e){e.srcObject=null,e.srcObject=r.webrtc.localStream}))})),n}},{key:"getDevicesInfo",value:function(){return new Promise((function(t,n){navigator.mediaDevices.enumerateDevices().then((function(n){var r=1;e.microphones=[],e.speakers=[],e.cameras=[];for(var i=0;i<n.length;++i){var o=n[i];if(o.deviceId&&0!==o.deviceId.length)if("audioinput"===o.kind){var s=o.label||"Microphone ".concat(r++);e.microphones.push({label:s,deviceId:o.deviceId,groupId:o.groupId})}else"audiooutput"===o.kind?(s=o.label||"Speaker ".concat(r++),e.speakers.push({label:s,deviceId:o.deviceId,groupId:o.groupId})):"videoinput"===o.kind&&(s=o.label||"Camera ".concat(r++),e.cameras.push({label:s,deviceId:o.deviceId,groupId:o.groupId}))}t({microphones:e.microphones,speakers:e.speakers,cameras:e.cameras})})).catch((function(e){console.log("+++++++++++++++++++++++ error enumerateDevices +++++++++++++++++++++++",e),n()}))}))}}],(n=null)&&ke(t.prototype,n),r&&ke(t,r),e}();function Me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Ae(we,"rooms",new c),Ae(we,"ID_GEN",0),Ae(we,"microphones",[]),Ae(we,"speakers",[]),Ae(we,"cameras",[]);var Pe=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.client=t,this.fromNumber=n,this.toNumber=r,this.custom="",this.customDataFromYourServer="",this.fromAlias=n,this.toAlias=r,this.fromInternal=!0,this.answeredOnAnotherDevice=!1,this.isVideoCall=i,this.isIncomingCall=!1,this.isAnswered=!1,this.isOnHold=!1,this._answeredDeviceId="",this.ended=!1,this.callId="",this.room=null,this.roomToken="",this.localTracks=[],this.subscribedTracks=[],this.toType="",this.muted=!1,this.localVideoEnabled=i,this._onMethods=new c,this.client._stringeeCalls2.push(this),this.videoResolution=null,this.audioDeviceId=null,this.videoDeviceId=null,this.mobileCamera=null}var t,n,r;return t=e,r=[{key:"joinCall",value:function(t,n){return new Promise((function(r,i){var o={callid:n};t._sendMessage(a.VIDEO_ROOM_JOIN_CALL2,o,(function(o){var s;0==o.r?((s=t.findCall2ByCallId(n))||((s=new e(t,o.fromNumber,o.toNumber,!0)).callId=n,s.isIncomingCall=!0,s.fromAlias=o.fromAlias,s.toAlias=o.toAlias,s.customDataFromYourServer=o.customDataFromYourServer,s.roomToken=o.roomToken),r(s)):i(o)}))}))}}],(n=[{key:"makeCall",value:function(e){if(this.isIncomingCall)console.log("could not make call, this is a incoming call");else{var t=this,n={fromNumber:this.fromNumber,toNumber:this.toNumber,video:this.isVideoCall,custom:t.custom};t.client._sendMessage(a.VIDEO_ROOM_MAKE_CALL,n,(function(n){0==n.r&&(t.roomToken=n.roomToken,delete n.roomToken,delete n.roomId,t.callId=n.callId,t.toType=n.toType,t.customDataFromYourServer=n.customDataFromYourServer,t._createLocalVideoTrack()),e.call(t,n)}))}}},{key:"transferCall",value:function(e,t,n,r){var i=this,o={fromNumber:this.fromNumber,toNumber:e,toType:t,transferType:n,callId:i.callId};i.client._sendMessage(a.VIDEO_ROOM_TRANSFER_CALL,o,(function(e){r&&r.call(i,e)}))}},{key:"sendHold",value:function(){var e=arguments.length>1?arguments[1]:void 0,t=this,n={hold:!0,callId:t.callId};t.client._sendMessage(a.VIDEO_ROOM_HOLD,n,(function(n){return e.call(t,n),0===n.r&&(t.isOnHold=!0,!0)}))}},{key:"sendUnHold",value:function(e){var t=this,n={hold:!1,callId:t.callId};t.client._sendMessage(a.VIDEO_ROOM_HOLD,n,(function(n){return e.call(t,n),0===n.r&&(t.isOnHold=!1,!0)}))}},{key:"leaveRoom",value:function(){this.room.leave(!0)}},{key:"switchCameraOld",value:function(){var e=this;return we.cameras.length<2?(console.log("StringeeVideo.cameras.length: "+we.cameras.length),!1):("front"==this.mobileCamera||""==this.mobileCamera||null==this.mobileCamera?this.mobileCamera="back":this.mobileCamera="front",this.videoDeviceId=null,e.localTracks.forEach((function(t){t.screen||(e.room.unpublish(t),t.detachAndRemove())})),e.localTracks=e.localTracks.filter((function(e){return 1==e.screen})),e._createLocalVideoTrack(),!0)}},{key:"switchCamera",value:function(){var e=this;return we.cameras.length<2?(console.log("StringeeVideo.cameras.length: "+we.cameras.length),!1):("front"==this.mobileCamera||""==this.mobileCamera||null==this.mobileCamera?this.mobileCamera="back":this.mobileCamera="front",this.videoDeviceId=null,e.localTracks.forEach((function(e){if(!e.screen){var t=e.webrtc.localStream;t.getTracks().forEach((function(e){e.stop(),t.removeTrack(e)}))}})),e.localTracks.forEach((function(t){if(!t.screen){var n=null;e.videoResolution&&(n={width:{min:e.videoResolution.width,max:e.videoResolution.width},height:{min:e.videoResolution.height,max:e.videoResolution.height}});var r={audio:!0,video:!0,screen:!1,videoDimensions:n,videoDeviceId:null,mobileCamera:e.mobileCamera};t.changeDevice("both",null,r)}})),!0)}},{key:"answer",value:function(e){var t=this;if(this.isIncomingCall)if(this.isAnswered)console.log("Error: call has been answered");else if(this.answeredOnAnotherDevice)console.log("Error: call has been answered on other device");else{this.isAnswered=!0;var n={callId:this.callId,code:200};this.client._sendMessage(a.VIDEO_ROOM_CALL_STATE,n,(function(n){0==n.r&&t._createLocalVideoTrack(),e&&e.call(t,{r:n.r})}))}else console.log("Error: could not answer call, this is a outgoing call")}},{key:"reject",value:function(e){var t=this;if(this.isIncomingCall){t.ended=!0;var n={callId:this.callId,code:486};this.client._sendMessage(a.VIDEO_ROOM_CALL_STATE,n,(function(n){e&&e.call(t,{r:n.r})})),this.onRemove()}else console.log("could not reject call, this is a outgoing call")}},{key:"ringing",value:function(e){var t=this;if(this.isIncomingCall){var n={callId:this.callId,code:180};this.client._sendMessage(a.VIDEO_ROOM_CALL_STATE,n,(function(n){e&&e.call(t,{r:n.r})}))}else console.log("could not send ringing signal, this is a outgoing call")}},{key:"sendInfo",value:function(e,t){var n=this;("string"==typeof e||e instanceof String)&&(e={info:e}),n.room.sendMessage(e).then((function(){t.call(n,{r:0})})).catch((function(e){t.call(n,{r:1})}))}},{key:"hangup",value:function(e){var t=this;t.ended=!0;var n={callId:this.callId};this.client._sendMessage(a.VIDEO_ROOM_END_CALL,n,(function(n){0===n.r&&t.onRemove(),e&&e.call(t,{r:n.r})}))}},{key:"_joinRoom",value:function(){var e=this;return new Promise((function(t,n){we.joinRoom(e.client,e.roomToken).then((function(n){var r=n.room;e.room=r,r.clearAllOnMethos(),r.on("joinroom",(function(e){})),r.on("leaveroom",(function(e){})),r.on("addtrack",(function(t){var n=!1;if(e.localTracks.forEach((function(e){e.serverId===t.info.track.serverId&&(n=!0)})),!n){for(var r=0;r<e.subscribedTracks.length;r++)if(e.subscribedTracks[r].serverId==t.info.track.serverId)return;e._subscribe(t.info.track)}})),r.on("removetrack",(function(t){var n=t.track;if(n){n.isLocal?(e.localTracks=e.localTracks.filter((function(e){return e.localId!==n.localId})),e._callOnEvent("removelocaltrack",n)):(e.subscribedTracks=e.subscribedTracks.filter((function(e){return e.localId!==n.localId})),e._callOnEvent("removeremotetrack",n)),n.detach().forEach((function(e){e.remove()}));for(var r=0;r<e.subscribedTracks.length;r++)e.subscribedTracks[r].serverId==n.serverId&&(e.subscribedTracks.splice(r,1),r--)}})),r.on("message",(function(t){e._callOnEvent("info",t.info)})),n.listTracksInfo.forEach((function(t){e._subscribe(t)})),t(r)})).catch((function(e){console.log("join room ERROR: ",e),n()}))}))}},{key:"_createLocalVideoTrack",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=null;this.videoResolution&&(t={width:{min:this.videoResolution.width,max:this.videoResolution.width},height:{min:this.videoResolution.height,max:this.videoResolution.height}});var n={audio:e,video:!0,screen:!1,videoDimensions:t,videoDeviceId:this.videoDeviceId,mobileCamera:this.mobileCamera};/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(n.mobileCamera="front");var r=this;r.createLocalVideoTrack(n).catch((function(e){console.log("create Local Video Track ERROR: ",e.name),"NotFoundError"===e.name?we.getDevicesInfo().then((function(e){0===e.cameras.length&&(n.video=!1),0===e.microphones.length&&(n.audio=!1),r.createLocalVideoTrack(n).catch((function(e){console.log("create Local Video Track ERROR: ",e.name),r._callOnEvent("signalingstate",{reason:"WebRTC_"+e.name,code:-1,sipCode:-1,sipReason:""}),r.hangup()}))})):"NotReadableError"===e.name?(n.videoDimensions=-1,r.createLocalVideoTrack(n).catch((function(e){console.log("create Local Video Track ERROR: ",e.name),r._callOnEvent("signalingstate",{reason:"WebRTC_"+e.name,code:-1,sipCode:-1,sipReason:""}),r.hangup()}))):"NotAllowedError"===e.name?(n.video=!1,r.createLocalVideoTrack(n).catch((function(e){"NotAllowedError"===e.name&&console.log("Audio NotAllowedError"),r._callOnEvent("signalingstate",{reason:"WebRTC_"+e.name,code:-1,sipCode:-1,sipReason:""}),r.hangup()}))):("OverconstrainedError"===e.name&&console.log("Camera không hỗ trợ độ phân giải này, vui lòng chọn độ phân giải khác"),r._callOnEvent("signalingstate",{reason:"WebRTC_"+e.name,code:-1,sipCode:-1,sipReason:""}),r.hangup())}))}},{key:"createLocalVideoTrack",value:function(e){var t=this;return new Promise((function(n,r){we.createLocalVideoTrack(t.client,e).then((function(e){t.localTracks.push(e),t._callOnEvent("addlocalstream",e.webrtc.localStream,e),t._callOnEvent("addlocaltrack",e),t.room?t.room.publish(e).then((function(){})).catch((function(e){console.log("publish Local Video Track ERROR: ",e)})):t._joinRoom().then((function(t){t.publish(e).then((function(){})).catch((function(e){console.log("publish Local Video Track ERROR: ",e)}))})).catch((function(){})),n()})).catch((function(e){r(e)}))}))}},{key:"startShareScreen",value:function(){var e=this;we.createLocalVideoTrack(e.client,{audio:!0,video:!0,screen:!0,videoDimensions:null,videoDeviceId:null}).then((function(t){e.localTracks.push(t),console.log("=====websdk addlocalstream share screen=====",t.webrtc.localStream),console.log("=====websdk addlocaltrack share screen=====",t),e._callOnEvent("addlocalstream",t.webrtc.localStream,t),e._callOnEvent("addlocaltrack",t),e.room.publish(t).then((function(){})).catch((function(e){console.log("publish Local Video Track ERROR: ",e)}))})).catch((function(e){console.log("create Local Video Track ERROR: ",e)}))}},{key:"_subscribe",value:function(e){var t=this;t.room.subscribe(e.serverId,{audio:!0,video:!0}).then((function(e){t.subscribedTracks.push(e),e.on("ready",(function(){t._callOnEvent("addremotestream",e.webrtc.remoteStream,e),t._callOnEvent("addremotetrack",e)})),e.on("mediastate",(function(e){t._callOnEvent("mediastate",e)}))})).catch((function(e){console.log("subscribe ERROR: ",e)}))}},{key:"_unsubscribe",value:function(e){this.room.unsubscribe(e)}},{key:"on",value:function(e,t){this._onMethods.put(e,t)}},{key:"_callOnEvent",value:function(e){var t=this._onMethods.get(e);if(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];r?t.call.apply(t,[this].concat(r)):t.call(this)}else console.log("Please implement StringeeCall event: "+e)}},{key:"onRemove",value:function(){var e=this.client._stringeeCalls2.indexOf(this);e>-1&&this.client._stringeeCalls2.splice(e,1)}},{key:"mute",value:function(e){this.localTracks.forEach((function(t){t.mute(e)})),this.muted=e}},{key:"enableLocalVideo",value:function(e){var t=this;t.localTracks.forEach((function(n){n.screen||n.enableLocalVideo(e)&&(t.localVideoEnabled=e)}))}}])&&Me(t.prototype,n),r&&Me(t,r),e}();function De(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ne=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"_callSdpCandidateFromServer",value:function(e,t){var n=e.findCallByCallId(t.callId);if(n)if(n.answeredOnAnotherDevice)console.log("answeredOnAnotherDevice");else{var r=t.deviceId;if(r||(r=""),"sdp"===t.type){var i=t.data.sdp,o=i.match(/a=candidate([^\r\n]+)/g);o&&-1===i.indexOf("typ srflx")&&o.forEach((function(e){var t;t=(t=(t=(t=e.replace(" generation 0","")).replace("typ host","typ srflx")).replace("typ host","typ srflx")).replace("\n",""),t+=" raddr 172.20.1.2 rport 57527 generation 0";var n=i.indexOf(e);n>-1&&(i=[i.slice(0,n),t+"\n",i.slice(n)].join(""))}));var s={type:t.data.type,sdp:i},a=new RTCSessionDescription(s);n._remoteSdps.put(r+"",a),n._pc&&n._onRemoteSDP()}else if("candidate"===t.type){var l=new RTCIceCandidate(t.data),u=n._mapListCandidates.get(r+"");u||(u=new c,n._mapListCandidates.put(r+"",u)),u.push(l),n._checkAndAddCandidateFromQueue()}}else console.log("error could not found call for: "+t.callId)}},{key:"_callStateFromServer",value:function(e,t){var n=e.findCallByCallId(t.callId);if(n){var r=-1,i="",o=t.deviceId;o||(o=""),100===t.code?(r=l,i="Calling"):180===t.code||183===t.code?(r=u,i="Ringing"):486===t.code||603===t.code?(r=f,i="Busy here"):t.code>=400?(r=h,i="Ended"):200===t.code&&(r=d,i="Answered",n._answeredDeviceId=o),t.code>=400?n.ended=!0:200===t.code&&(n.isAnswered=!0),r>-1?n._callOnEvent("signalingstate",{reason:i,code:r,sipCode:t.code,sipReason:t.reason}):console.log("error: unknow code: "+t.code),t.code>=400?(n._freeResource(),n.onRemove()):200===t.code&&(n._pc&&n._onRemoteSDP(),n._checkAndAddCandidateFromQueue())}else console.log("error could not found call for: "+t.callId)}},{key:"_callStopFromServer",value:function(e,t){var n=e.findCallByCallId(t.callId);n?(n.ended=!0,n._freeResource(),n.onRemove(),n._callOnEvent("signalingstate",{reason:"Ended",code:h,sipCode:-1,sipReason:"Bye"})):console.log("error could not found call for: "+t.callId)}},{key:"_callStartFromServer",value:function(e,t){var n=new pe(e,t.fromNumber,t.toNumber,t.video,t.customData);n._iceServers=t.iceServers,n.callId=t.callId,n.isIncomingCall=!0,n.fromAlias=t.fromAlias,n.toAlias=t.toAlias,n.fromInternal=t.fromInternal,n.customDataFromYourServer=t.customDataFromYourServer,n._initPeerConnection(!1),e._callOnEvent("incomingcall",n)}},{key:"_callInfoFromServer",value:function(e,t){var n=e.findCallByCallId(t.callId);n?n._callOnEvent("info",t.info):console.log("error could not found call for: "+t.callId)}},{key:"_videoEndPointSdpFromServer",value:function(e,t){var n=new RTCSessionDescription({type:t.data.type,sdp:t.data.sdp}),r=t.localTrackId,i=t.serverTrackId,o=we.rooms.get(t.roomId);o?o.onReceiveSdp1(r,i,n):console.log("room not found: "+t.roomId)}},{key:"_videoEndPointCandidateFromServer",value:function(e,t){var n=new RTCIceCandidate(JSON.parse(t.data)),r=t.localTrackId,i=t.serverTrackId,o=we.rooms.get(t.roomId);o?o.onReceiveCandidate1(r,i,n):console.log("room not found: "+t.roomId)}},{key:"_videoTrackAddedFromServer",value:function(e,t){var n=we.rooms.get(t.roomId);n?n.onTrackAdded(t):console.log("room not found: "+t.roomId)}},{key:"_videoTrackRemovedFromServer",value:function(e,t){var n=we.rooms.get(t.roomId);n?n.onTrackRemoved(t):console.log("room not found: "+t.roomId)}},{key:"_videoRoomJoinedFromServer",value:function(e,t){var n=we.rooms.get(t.roomId);n?n.onRoomJoined(t):console.log("room not found: "+t.roomId)}},{key:"_videoRoomLeftFromServer",value:function(e,t){var n=we.rooms.get(t.roomId);n?n.onRoomLeft(t):console.log("room not found: "+t.roomId)}},{key:"_videoRoomMsgFromServer",value:function(e,t){var n=we.rooms.get(t.roomId);n?n.onRoomMsg(t):console.log("room not found: "+t.roomId)}},{key:"_videoRoomCallInviteFromServer",value:function(e,t){var n=new Pe(e,t.fromNumber,t.toNumber,t.video);n.callId=t.callId,n.isIncomingCall=!0,n.fromAlias=t.fromAlias,n.toAlias=t.toAlias,n.customDataFromYourServer=t.customDataFromYourServer,n.roomToken=t.roomToken,e._callOnEvent("incomingcall2",n)}},{key:"_videoRoomCallInviteCancelFromServer",value:function(t,n){e._call2EndFromServer(t,n)}},{key:"_call2StateFromServer",value:function(e,t){var n=e.findCall2ByCallId(t.callId);if(n){var r=-1,i="",o=t.deviceId;o||(o=""),100===t.code?(r=l,i="Calling"):180===t.code||183===t.code?(r=u,i="Ringing"):486===t.code||603===t.code?(r=f,i="Busy here"):t.code>=400?(r=h,i="Ended"):200===t.code&&(r=d,i="Answered",n._answeredDeviceId=o),t.code>=400?n.ended=!0:200===t.code&&(n.isAnswered=!0),r>-1?n._callOnEvent("signalingstate",{reason:i,code:r,sipCode:t.code,sipReason:t.reason}):console.log("error: unknow code: "+t.code),t.code>=400&&n.onRemove()}else console.log("error could not found call for: "+t.callId)}},{key:"_call2EndFromServer",value:function(e,t){var n=e.findCall2ByCallId(t.callId);if(n){var r=t.deviceId;r||(r="");var i=h;n.ended=!0,n._callOnEvent("signalingstate",{reason:"Ended",code:i,sipCode:t.code,sipReason:t.reason}),n.onRemove(),n.subscribedTracks.forEach((function(e){n.room.unsubscribe(e),e.detachAndRemove()}))}else console.log("error could not found call for: "+t.callId)}},{key:"_videoRoomEnableDisableAudioVideoNotification",value:function(e,t){var n=we.rooms.get(t.roomId);n?n.onTrackChangeAudioVideoEnableDisable(t):console.log("room not found: "+t.roomId)}}],(n=null)&&De(t.prototype,n),r&&De(t,r),e}();function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Le=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"_routeChatToAgent",value:function(e,t){console.log("_routeChatToAgent: "+JSON.stringify(t)),e._callOnEvent("incommingchat",t)}}],(n=null)&&xe(t.prototype,n),r&&xe(t,r),e}();function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ve=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.serverAddr=t,this._onMethods=new c,this.userDisconnect=!1,this.timeoutReconnectMethod=null,this.socket=null,this.serverAddressIsDead=!1,this.alreadyTried=!1;var r=this;this.healthCheckInterval=setInterval((function(){r.serverAddressIsDead?r.clearHealthCheckInterval():!n.socket||n.socket.readyState!==WebSocket.CLOSED&&n.socket.readyState!==WebSocket.CLOSING||(n.alreadyTried=!1,r.connect())}),2e3)}var t,n,r;return t=e,(n=[{key:"clearHealthCheckInterval",value:function(){try{clearInterval(this.healthCheckInterval)}catch(e){console.log("clearing health check interval inside SSWS failed",e)}}},{key:"open",value:function(){this.connect()}},{key:"connect",value:function(){this.alreadyTried?console.log("SSWS: already tried, wait for 3 seconds"):(this.alreadyTried=!0,this.userDisconnect=!1,this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.close(),this.socket=null),this.socket=new WebSocket(this.serverAddr),this.bindSocketEvents(this.socket))}},{key:"bindSocketEvents",value:function(e){var t=this;e.onopen=function(e){var n=t._onMethods.get("connect");n&&n(e)},e.onmessage=function(e){var n=t._onMethods.get("EventPacket");n&&n(e.data)},e.onclose=function(e){var n=t._onMethods.get("disconnect");n&&n(e)},e.onerror=function(n){console.log("Native websocket error",n),this.serverAddressIsDead=!0,t.clearHealthCheckInterval();var r=t._onMethods.get("error");r?r(n):console.log("StringeeWebSocket on error",n),e.close()}}},{key:"reconnect",value:function(){console.log("SSWS: on reconnect"),this.disconnect();var e=this;this.userCallReconnectMethod&&clearTimeout(this.userCallReconnectMethod),this.userCallReconnectMethod=setTimeout((function(){e.connect()}),1e3)}},{key:"disconnect",value:function(){this.clearHealthCheckInterval(),this.userDisconnect=!0,this.timeoutReconnectMethod&&clearTimeout(this.timeoutReconnectMethod),this.socket.close()}},{key:"close",value:function(){this.disconnect()}},{key:"on",value:function(e,t){this._onMethods.put(e,t)}},{key:"send",value:function(e){if(this.socket.readyState===WebSocket.OPEN){var t=JSON.stringify(e);this.socket.send(t)}else console.log("Socket is not open. not sending anything",this.socket.readyState)}},{key:"emit",value:function(e,t){this.send(t)}}])&&Fe(t.prototype,n),r&&Fe(t,r),e}();var je=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.conv=t,this.role=n.role,this.user=n.user,this.lastMsgSeqReceived=n.lastMsgSeqReceived,this.lastMsgSeqSeen=n.lastMsgSeqSeen};function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var He=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stringeeClient=t,this.messages=new c,this.id=n.convId,this.name=n.convName,this.isGroup=n.isGroup,this.lastUpdate=n.lastUpdate,this.created=n.created,this.unread=n.unread,this.creator=n.creator,this.pinMsgId=n.pinMsgId,this.ended=n.ended;var r=this;if(this.participants=n.participants.map((function(e){return new je(r,e)})),this.lastTimeNewMsg=n.lastTimeNewMsg,this.chatStatus=n.chatStatus,this.channelType=n.channelType,this.resolved=n.resolved,this.lastSeq=n.convLastSeq,n.lastMsg){var i=new qe(this,null);i.content=n.lastMsg,i.type=n.lastMsgType,i.id=n.lastMsgId,i.sender=n.lastMsgSender,i.channelType=n.channelType,i.seq=n.convLastSeq,this.lastMessage=i}"customData"in n&&(this.customData=n.customData),"oaId"in n&&(this.oaId=n.oaId)}var t,n,r;return t=e,(n=[{key:"getMessages",value:function(e,t,n,r){var i=this;return new Promise((function(o,s){if(!i.id||n<=0||t<0)s({r:-1,msg:"Params are invalid."});else if(i.stringeeClient.hasConnected){var a={seqGreater:e,seqSmaller:t,limit:n,sort:r,convId:i.id};i.stringeeClient._sendMessage(StringeeServiceType.CHAT_MESSAGES_LOAD,a,(function(e){var t=e.r;if(0==t){var n=e.msgs;null!=n&&(n=n.map((function(e){var t=new qe(i,e);return i.addMsg(t,!1),t}))),o(n)}else s({r:t,msg:e.message})}))}else s({r:-2,msg:"StringeeClient is not connected to Stringee server."})}))}},{key:"addMsg",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this;r.messages.put(e.id,e),t&&e.sender!=r.stringeeClient.userId&&(n&&r.unread++,r.markParticipantRead(e)),(null==r.lastMessage||r.lastMessage.seq<e.seq)&&(r.lastMessage=e,r.lastSeq=e.seq)}},{key:"sendMessage",value:function(e,t){var n=this;return new Promise((function(r,i){if(n.stringeeClient.hasConnected&&null!=n.stringeeClient.userId)if("object"===Ue(t)){var o=n.stringeeClient.userId,s=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),a="web-"+o+"-"+s+"-"+Date.now().toString(),c={message:t,type:e,convId:n.id,localDbId:a};n.stringeeClient._sendMessage(StringeeServiceType.CHAT_MESSAGE,c,(function(s){var a=s.r;if(0==a){var c=new qe(n,null);c.created=s.created,c.id=s.msgId,c.channelType=s.channelType,c.localDbId=s.localDbId,c.seq=s.seq,c.content=t,c.type=e,c.sender=o,n.addMsg(c),r(c)}else i({r:a,msg:s.message})}))}else i({r:-2,msg:"info.message is not Object."});else i({r:-1,msg:"StringeeClient is not connected to Stringee server."})}))}},{key:"markReceived",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this;return new Promise((function(r,i){if(n.stringeeClient.hasConnected&&null!=n.stringeeClient.userId){var o={lastMsgSeq:e.seq,lastMsgTimestamp:e.created,status:t,convId:n.id};n.stringeeClient._sendMessage(StringeeServiceType.CHAT_MESSAGE_REPORT,o,(function(e){var t=e.r;0==t?r(e):i({r:t,msg:e.message})}))}else i({r:-1,msg:"StringeeClient is not connected to Stringee server."})}))}},{key:"getMsgBySeq",value:function(e){for(var t=0;t<this.messages.size();t++){var n=this.messages[t].value;if(n.seq===e)return n}return null}},{key:"markParticipantRead",value:function(e){console.log("====markParticipantRead");var t={convId:e.conv.id,from:e.sender,status:2,lastMsgSeq:e.seq};this.stringeeClient._callOnEvent("chatmessagestate",t)}},{key:"markRead",value:function(e){var t=this;if(this.participants.forEach((function(n){var r=0;n.user==t.stringeeClient.userId&&e.seq>n.lastMsgSeqSeen&&(r=n.lastMsgSeqSeen,n.lastMsgSeqReceived=e.seq,n.lastMsgSeqSeen=e.seq,t.stringeeClient._callOnEvent("changemessagestate",{oldLastMsgSeqSeen:r,participant:n,status:"MsgSeen"}))})),e.sender!=t.stringeeClient.userId)return e.seq>=t.lastMessage.seq&&(t.unread=0),this.markReceived(e,2)}},{key:"endChat",value:function(){var e=this,t={convId:this.id};return new Promise((function(n,r){e.stringeeClient._sendMessage(StringeeServiceType.END_CHAT,t,(function(e){var t=e.r;0==t?n(e):r({r:t,msg:e.message})}))}))}},{key:"transfer",value:function(e,t){var n=this,r={convId:this.id,customerId:t.customerId,customerName:t.customerName,toUserId:e};return new Promise((function(e,t){n.stringeeClient._sendMessage(StringeeServiceType.CHAT_TRANSFER_TO_ANOTHER_AGENT,r,(function(n){var r=n.r;0==r?e(n):t({r:r,msg:n.message})}))}))}},{key:"sendChatTranscriptTo",value:function(e,t){var n=this,r={convId:this.id,email:e,domain:t};return new Promise((function(e,t){n.stringeeClient._sendMessage(StringeeServiceType.SEND_EMAIL_TRANSCRIPT,r,(function(n){var r=n.r;0==r?e(n):t({r:r,msg:n.message})}))}))}},{key:"beginTyping",value:function(){var e=this,t={userId:this.stringeeClient.userId,convId:this.id};return new Promise((function(n,r){e.stringeeClient._sendMessage(StringeeServiceType.CHAT_USER_BEGIN_TYPING,t,(function(e){var t=e.r;0==t?n(e):r({r:t,msg:e.message})}))}))}},{key:"endTyping",value:function(){var e=this,t={userId:this.stringeeClient.userId,convId:this.id};return new Promise((function(n,r){e.stringeeClient._sendMessage(StringeeServiceType.CHAT_USER_END_TYPING,t,(function(e){var t=e.r;0==t?n(e):r({r:t,msg:e.message})}))}))}},{key:"joinOaConversation",value:function(){var e=this,t={convId:this.id};return new Promise((function(n,r){e.stringeeClient._sendMessage(StringeeServiceType.CHAT_JOIN_OA_CONVERSATION,t,(function(e){var t=e.r;0==t?n(e):r({r:t,msg:e.message})}))}))}}])&&Ge(t.prototype,n),r&&Ge(t,r),e}();var qe=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stringeeClient=t.stringeeClient,this.conv=t,n&&(this.created=n.created,this.localDbId=n.localDbId,this.channelType=n.channelType,this.id=n.id,this.type=n.type,this.sender=n.user,this.seq=n.seq,this.content=n.content,this.deletedStatus=n.deletedStatus)};function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var We=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stringeeClient=t,this.convId=n.convId,this.customerId=n.customerId,this.customerName=n.customerName,this.channelType=n.channelType,this.type=n.type}var t,n,r;return t=e,(n=[{key:"acceptRequest",value:function(){var e=this;return new Promise((function(t,n){var r={answer:!0,channelType:e.channelType,convId:e.convId},i=a.CHAT_AGENT_RESPONSE;"transfer"===e.type&&(i=a.CHAT_CONFIRM_TRANSFER_REQUEST),e.stringeeClient._sendMessage(i,r,(function(e){var r=e.r;0==r?t(e):n({r:r,msg:e.message})}))}))}},{key:"rejectRequest",value:function(){var e=this;return new Promise((function(t,n){var r={answer:!1,channelType:e.channelType,convId:e.convId},i=a.CHAT_AGENT_RESPONSE;"transfer"===e.type&&(i=a.CHAT_CONFIRM_TRANSFER_REQUEST),e.stringeeClient._sendMessage(i,r,(function(e){var r=e.r;0==r?t(e):n({r:r,msg:e.message})}))}))}}])&&Be(t.prototype,n),r&&Be(t,r),e}();function Ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Je=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getListConversations",value:function(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return new Promise((function(s,c){if(i<=0||r<=0)c({r:-2,msg:"Params are invalid."});else if(t.hasConnected){var l={lastUpdateGreater:n,lastUpdateSmaller:r,limit:i};o&&(l.oaId=o),t._sendMessage(a.CHAT_CONVERSATION_LOAD,l,(function(n){var r=n.r;if(0==r){var i=n.listConvs;null!=i&&(i=i.map((function(n){var r=new He(t,n);return e.conversations.put(r.id,r),r}))),s(i)}else c({r:r,msg:n.message})}))}else c({r:-1,msg:"StringeeClient is not connected to Stringee server."})}))}},{key:"getConversationsByIds",value:function(t,n){return new Promise((function(r,i){if(n)if(t.hasConnected){var o={convIds:n.join(",")};t._sendMessage(a.CHAT_GET_CONVERSATIONS_INFO,o,(function(n){var o=n.r;if(0==o){var s=n.listConvs;null!=s&&(s=s.map((function(n){var r=new He(t,n);return e.conversations.put(r.id,r),r}))),r(s)}else i({r:o,msg:n.message})}))}else i({r:-1,message:"StringeeClient is not connected to Stringee server."});else i({r:-1,message:"Conversaion's Id is invalid"})}))}},{key:"init",value:function(t){t.on("chatmessage",(function(n){var r=e.conversations.get(n.convId);if(r){var i=new qe(r,null);i.created=n.createdTime,i.sender=n.from,i.id=n.msgId,i.channelType=n.channelType,i.type=n.type,i.seq=n.seq,i.content=n.message,r.addMsg(i),t._callOnEvent("addchatmessage",i)}else e.getConversationsByIds(t,[n.convId]).then((function(i){console.log("StringeeChat2.getConversationsByIds",i),r=i[0],e.conversations.put(r.id,r);var o=new qe(r,null);o.created=n.createdTime,o.sender=n.from,o.id=n.msgId,o.channelType=n.channelType,o.type=n.type,o.seq=n.seq,o.content=n.message,r.addMsg(o,!0,!1),t._callOnEvent("addchatmessage",o)})).catch((function(e){console.log(e)}))})),t.on("chatmessagestate",(function(n){console.log("chatmessagestate===",n);var r=e.conversations.get(n.convId);if(r)for(var i=0;i<r.participants.length;i++){var o=r.participants[i];if(o.user===n.from){if(1==n.status&&n.lastMsgSeq>o.lastMsgSeqReceived){var s=o.lastMsgSeqReceived;o.lastMsgSeqReceived=n.lastMsgSeq,t._callOnEvent("changemessagestate",{oldLastMsgSeqReceived:s,participant:o,type:"MsgReceived"})}else if(2==n.status&&n.lastMsgSeq>o.lastMsgSeqSeen){var a=o.lastMsgSeqSeen;o.lastMsgSeqSeen=n.lastMsgSeq,t._callOnEvent("changemessagestate",{oldLastMsgSeqSeen:a,participant:o,status:"MsgSeen"})}break}}})),t.on("incommingchat",(function(n){var r={convId:n.convId,customerId:n.customerId,customerName:n.customerName,channelType:n.channelType,type:"normal"},i=e.createChatRequest(t,r);i&&(t._callOnEvent("receiveChatRequest",i),e.chatRequests.put(n.convId,i))})),t.on("transferChatRequest",(function(n){var r={convId:n.convId,customerId:n.customerId,customerName:n.customerName,channelType:n.channelType,type:"transfer"},i=e.createChatRequest(t,r);i&&(t._callOnEvent("receiveTransferChatRequest",i),e.chatRequests.put(n.convId,i))})),t.on("chatAgentResponse",(function(t){0===t.r&&e.chatRequests.remove(t.convId)})),t.on("chatConfirmTransferResponse",(function(t){0===t.r&&e.chatRequests.remove(t.convId)}))}},{key:"createConversation",value:function(e,t,n){var r=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);return new Promise((function(i,o){if(void 0!==t&&null!=t)if(e.hasConnected){var s;s=null==n.name||0===n.name.length?"":n.name;var c={distinct:n.isDistinct,isGroup:n.isGroup,name:s,participants:t,customField:{},localDbId:r};n.customData&&(c.customData=n.customData),n.oaId&&(c.oaId=n.oaId),e._sendMessage(a.CHAT_CREATE_CONVERSATION,c,(function(t){var n=t.r;if(0==n||2==n){t.convName=s,t.created=Date.now(),t.unread=0,t.creator=e.userId,t.convLastSeq=t.lastMsg.seq;var r=t.lastMsg;t.lastMsg=null;var a=new He(e,t),c=new qe(a,null);c.content=r.content,c.type=r.type,c.id=r.id,c.seq=r.seq,c.created=r.created,c.sender=r.user,c.channelType=r.channelType,c.localDbId=r.localDbId,a.lastMessage=c,i(a)}else o({r:n,msg:t.message})}))}else o({r:-2,message:"StringeeClient is not connected to Stringee server."});else o({r:-1,message:"UserIds are invalid"})}))}},{key:"createLiveChatConversation",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!n)return new Promise((function(e,t){t()}));var o={isDistinct:!1,isGroup:!0,name:n,customData:r,oaId:i};return e.createConversation(t,[],o)}},{key:"updateUserInfo",value:function(e,t){return new Promise((function(n,r){e.hasConnected?e._sendMessage(a.UPDATE_USER_INFO,t,(function(e){var t=e.r;0==t?n(e):r({r:t,msg:e.message})})):r({r:-2,message:"StringeeClient is not connected to Stringee server."})}))}},{key:"getMessages",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"DESC",o=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;return new Promise((function(c,l){if(o<=0||r<=0)l({r:-2,msg:"Params are invalid."});else if(t.hasConnected){s=s.join(",");var u={createdGreater:n,createdSmaller:r,sort:i,limit:o,convIds:s};t._sendMessage(a.CHAT_LOAD_ALL_MESSAGES_FOR_CONVERSATIONS,u,(function(t){var n=t.r;if(0==n){var r=t.msgs,i=[];null!=r&&(i=r.map((function(t){var n=e.conversations.get(t.convId);return new qe(n,t)}))),c(i)}else l({r:n,msg:t.message})}))}else l({r:-1,msg:"StringeeClient is not connected to Stringee server."})}))}},{key:"createChatRequest",value:function(e,t){if(!t.convId||!t.channelType)return!1;var n=t.convId,r=t.customerId,i=t.customerName,o=t.channelType,s=t.type;return new We(e,{convId:n,customerId:r,customerName:i,channelType:o,type:s})}},{key:"loadAllChatRequest",value:function(t){return new Promise((function(n,r){t._sendMessage(a.CHAT_REQUEST_LOAD,{},(function(i){var o=i.r;if(0==o){var s=i.chatRequests;console.log("chatRequests",s),console.log("chatRequests",e.chatRequests.size());var a=[];null!=s&&s.forEach((function(n){if(-1===e.chatRequests.containsKey(n.convId)){var r=new We(t,n);e.chatRequests.put(n.convId,r),a.push(r)}})),n(a)}else r({r:o,msg:i.message})}))}))}}],(n=null)&&Ke(t.prototype,n),r&&Ke(t,r),e}();function Ye(e){return function(e){if(Array.isArray(e))return Qe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qe(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}ze(Je,"conversations",new c),ze(Je,"chatRequests",new c);var Ze=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["wss://v1.stringee.com:6899/","wss://v2.stringee.com:6899/"];$e(this,e),this.socket=null,this.hasConnected=!1,this.disconnectByUser=!1,this.timeoutToReconnect=0,this.lastTimeStampReceivedPacket=0,this.allClients=[],this.allClientsOfThisBrowser=[],this.masterServer=null,this.stringeeServerAddrs=t,this.stringeeServerAddrIndex=-1,this._stringeeServerAddr=this.stringeeServerAddrs[0],this._currentRequestId=1,this._callbacks=new c,this.accessToken="",this._onMethods=new c,this._stringeeCalls=[],this._stringeeCalls2=[],this.ice_servers=[],this.deviceId="web-"+this._genUuid(),this.browserId=localStorage.getItem("stringee_browser_id"),this.browserId||(this.browserId="browser-"+this._genUuid(),localStorage.setItem("stringee_browser_id",this.browserId)),this.sessionId="session-"+this._genUuid(),this.alreadyTried=!1;var n=this;this.healtcheckInterval=setInterval((function(){return n.alreadyTried&&(n.alreadyTried=!1),n.disconnectByUser?(console.log("StringeeClient: Socket disconnected by user. Stop trying to connect"),void n._cleanHouse()):null==n.socket?(console.log("StringeeClient: Socket is null"),void(n.accessToken&&(console.log("StringeeClient: create a new socket",n.socket),n.createNewStringeeWebSocket(n.accessToken)))):void(n.socket&&n.socket.socket&&n.socket.socket.readyState>1&&n.accessToken&&(console.log("StringeeClient: Socket is closed or about to close, create a new socket instance",n.socket.socket.readyState,n._stringeeServerAddr),n.createNewStringeeWebSocket(n.accessToken)))}),1e4)}var t,n,r;return t=e,(n=[{key:"_cleanHouse",value:function(){this.healtcheckInterval&&clearInterval(this.healtcheckInterval)}},{key:"getClientId",value:function(){return this.deviceId}},{key:"getBrowserId",value:function(){return this.browserId}},{key:"setThisClientIsActive",value:function(e){e?localStorage.setItem("active_client_id",this.deviceId):localStorage.removeItem("active_client_id")}},{key:"isActiveClient",value:function(){var e=localStorage.getItem("active_client_id");return this.deviceId===e}},{key:"findCallByCallId",value:function(e){for(var t=0;t<this._stringeeCalls.length;t++){var n=this._stringeeCalls[t];if(n.callId===e)return n}return null}},{key:"findCall2ByCallId",value:function(e){for(var t=0;t<this._stringeeCalls2.length;t++){var n=this._stringeeCalls2[t];if(n.callId===e)return n}return null}},{key:"_pushCallback",value:function(e,t){if(t){var n=this._callbacks.get(e);n||(n=[]),n.push(t),this._callbacks.put(e,n)}}},{key:"_callCallback",value:function(e,t){var n=!1,r=this._callbacks.get(e);if(r){var i=r.pop();i&&(i.call(this,t),n=!0)}return n}},{key:"getURLToConnect",value:function(){if(null!==this.masterServer){console.log("Master server is set ",this.masterServer,". Stop alternating to other server");var e=this.masterServer;return this.masterServer=null,e}return this.tempWebsocketURL&&0!==this.tempWebsocketURL.length||(this.tempWebsocketURL=Ye(this.stringeeServerAddrs)),this.tempWebsocketURL.shift()}},{key:"createNewStringeeWebSocket",value:function(e){this._stringeeServerAddr=this.getURLToConnect();try{this.socket&&this.socket.clearHealthCheckInterval()}catch(e){console.log("failed clearing interval of StringeeWebSocket",e)}this.socket=null,this.socket=new Ve(this._stringeeServerAddr),this.bindSocketEvents(this.socket,e),this.accessToken=e,this.socket.open()}},{key:"bindSocketEvents",value:function(e,t){var n=this;e.on("connect",(function(){n._callOnEvent("connect"),n.numberOfRetryConnect=0;var e=screen.width,r=screen.height,i=localStorage.getItem("stringee_browser_id");i||(i="browser-"+n._genUuid(),localStorage.setItem("stringee_browser_id",i));var o={accesstoken:t,deviceId:n.deviceId,browserId:n.browserId,sessionId:n.sessionId,platform:3,platformVersion:"",deviceName:navigator.userAgent,screenSize:e+"x"+r,sdkVersion:"2.6.0"};n._sendMessage(a.AUTHEN,o,(function(e){0===e.r?(n.ice_servers=e.ice_servers,n.hasConnected=!0,e.clients.forEach((function(e){n.allClients.push(e.clientId),e.browserId===n.getBrowserId()&&n.allClientsOfThisBrowser.push(e.clientId),n.allClients.sort(),n.allClientsOfThisBrowser.sort()})),n.userId=e.userId,n.timeoutToReconnect=e.ping_after_ms+15e3,void 0!==e.chatAgent&&e.chatAgent&&Je.loadAllChatRequest(n).then((function(e){e.forEach((function(e){"normal"===e.type?n._callOnEvent("receiveChatRequest",e):"transfer"===e.type&&n._callOnEvent("receiveTransferChatRequest",e)}))}))):n.hasConnected=!1,15!==e.r?(n._callOnEvent("authen",e),6===e.r&&n._callOnEvent("requestnewtoken")):(console.log("CURRENT_SERVER_IS_SLAVE, please change to: "+e.change_to_server),e.change_to_server?(n.masterServer=e.change_to_server,n.socket.disconnect(),n.alreadyTried=!1,n.connect(n.accessToken)):setTimeout((function(){n.socket.disconnect()}),2e3))}))})),e.on("disconnect",(function(){n.hasConnected=!1,n._callOnEvent("disconnect")})),e.on("error",(function(e){console.log("socket error",e)})),e.on("EventPacket",(function(e){try{var t=JSON.parse(e);if(!t||!t.service)return void console.log("could not decode data, error=1, ",e);try{n._packetReceived(t.service,t.body)}catch(e){console.log("error when process packet",e)}}catch(t){console.log("could not decode data, error=2, ",e)}}))}},{key:"connect",value:function(e){this.alreadyTried?console.log("StringeeClient: There is a recent attempt to connect to "+this._stringeeServerAddr+". Please wait"):(this.alreadyTried=!0,this.disconnectByUser=!1,this.socket&&(this.socket.disconnect(),this.socket=null),this.createNewStringeeWebSocket(e))}},{key:"disconnect",value:function(){console.log("StringeeClient: disconnected by user"),this.alreadyTried=!1,this.tempWebsocketURL=null,this.disconnectByUser=!0,this.socket&&(this.socket.close(),this.socket=null)}},{key:"sendCustomMessage",value:function(e,t,n){var r=this,i={toUser:e,message:t};this._sendMessage(a.CUSTOM_MESSAGE,i,(function(e){n&&n.call(r,e)}))}},{key:"changeAttribute",value:function(e,t,n){var r=this,i={attribute:e,value:t};this._sendMessage(a.CHANGE_ATTRIBUTE,i,(function(e){n&&n.call(r,e)}))}},{key:"_sendMessage",value:function(e,t,n){if(t.requestId||(t.requestId=this._currentRequestId),n){var r="packet_"+e+"_"+t.requestId;this._pushCallback(r,n)}var i={service:e,body:t};this.socket.emit("EventPacket",i),this._currentRequestId++}},{key:"_packetReceived",value:function(e,t){var n,r=!1;if(this.lastTimeStampReceivedPacket=Date.now(),t.requestId){var i="packet_"+e+"_"+t.requestId;n=this._callCallback(i,t)}e===a.CALL_SDP_CANDIDATE_FROM_SERVER?Ne._callSdpCandidateFromServer(this,t):e===a.CALL_STATE_FROM_SERVER?Ne._callStateFromServer(this,t):e===a.CALL_STOP_FROM_SERVER?Ne._callStopFromServer(this,t):e===a.CALL_START_FROM_SERVER?Ne._callStartFromServer(this,t):e===a.PING?this._sendMessage(a.PING,{}):e===a.CALL_INFO_FROM_SERVER?Ne._callInfoFromServer(this,t):e===a.MSG_FROM_OTHER_DEVICE?this._msgFromOtherDevice(t):e===a.CUSTOM_MESSAGE_FROM_SERVER?this._callOnEvent("custommessage",t):e===a.OTHER_DEVICE_AUTHEN?this._otherDeviceAuthen(t):e===a.CHAT_MESSAGE_FROM_SERVER?this._callOnEvent("chatmessage",t):e===a.CHAT_MESSAGE_REPORT_FROM_SERVER?this._callOnEvent("chatmessagestate",t):e===a.CHAT_ROUTE_TO_AGENT?Le._routeChatToAgent(this,t):e===a.SUBSCRIBE_FROM_SERVER?this._callOnEvent("messagefromtopic",t):e===a.TIMEOUT_ROUTE_TO_QUEUE?this._callOnEvent("timeoutInQueue",t):e===a.TIMEOUT_ROUTE_TO_AGENT?this._callOnEvent("timeoutAnswerChat",t):e===a.CHAT_PIN_MESSAGE_FROM_SERVER?this._callOnEvent("pinMsgFromServer",t):e===a.CHAT_EDIT_MESSAGE_FROM_SERVER?this._callOnEvent("editMsgFromServer",t):e===a.CHAT_REVOKE_MESSAGE_FROM_SERVER?this._callOnEvent("revokeMsgFromServer",t):e===a.CHAT_REMOVE_PARTICIPANT_FROM_SERVER?this._callOnEvent("removeParticipantFromServer",t):e===a.CHAT_ADD_PARTICIPANT_FROM_SERVER?this._callOnEvent("addParticipantFromServer",t):e===a.CHAT_USER_BEGIN_TYPING_NOTIFICATION?this._callOnEvent("userBeginTypingListener",t):e===a.CHAT_USER_END_TYPING_NOTIFIACTION?this._callOnEvent("userEndTypingListener",t):e===a.UPDATE_USER_INFO_NOTIFICATION?this._callOnEvent("updateUserInfoMsg",t):e===a.CHAT_CONVERSATION_ATTACHMENT?this._callOnEvent("chatConversationAttachment",t):e===a.CHAT_AGENT_RESPONSE?this._callOnEvent("chatAgentResponse",t):e===a.CHAT_CONFIRM_TRANSFER_REQUEST?this._callOnEvent("chatConfirmTransferResponse",t):e===a.END_CHAT?this._callOnEvent("endChat",t):e===a.CHAT_CONVERSATION_ENDED_NOTIFICATION?this._callOnEvent("conversationEnded",t):e===a.CHAT_TRANSFER_REQUEST_FROM_ANOTHER_AGENT?this._callOnEvent("transferChatRequest",t):e===a.CHAT_LOAD_ALL_MESSAGES_FOR_CONVERSATIONS?this._callOnEvent("loadAllChatMessages",t):e===a.VIDEO_ENDPOINT_SDP_FROM_SERVER?Ne._videoEndPointSdpFromServer(this,t):e===a.VIDEO_ENDPOINT_CANDIDATE_FROM_SERVER?Ne._videoEndPointCandidateFromServer(this,t):e===a.VIDEO_TRACK_ADDED_FROM_SERVER?Ne._videoTrackAddedFromServer(this,t):e===a.VIDEO_TRACK_REMOVED_FROM_SERVER?Ne._videoTrackRemovedFromServer(this,t):e===a.VIDEO_ROOM_JOINED_FROM_SERVER?Ne._videoRoomJoinedFromServer(this,t):e===a.VIDEO_ROOM_LEFT_FROM_SERVER?Ne._videoRoomLeftFromServer(this,t):e===a.VIDEO_ROOM_MSG_FROM_SERVER?Ne._videoRoomMsgFromServer(this,t):e===a.VIDEO_ROOM_CALL_INVITE?Ne._videoRoomCallInviteFromServer(this,t):e===a.VIDEO_ROOM_CALL_INVITE_CANCEL?Ne._videoRoomCallInviteCancelFromServer(this,t):e===a.VIDEO_ROOM_CALL_STATE_FROM_SERVER?Ne._call2StateFromServer(this,t):e===a.VIDEO_ROOM_END_CALL_FROM_SERVER?Ne._call2EndFromServer(this,t):e===a.VIDEO_ROOM_ENABLE_DISABLE_AUDIO_VIDEO_NOTIFICATION?Ne._videoRoomEnableDisableAudioVideoNotification(this,t):r=!0,n&&(r=!1),r&&console.log("===Packet received: service="+e+"; body="+JSON.stringify(t))}},{key:"_otherDeviceAuthen",value:function(e){if("disconnected"===e.status){for(var t=0;t<this.allClients.length;t++)this.allClients[t]===e.clientId&&this.allClients.splice(t,1);if(e.browserId===this.getBrowserId())for(t=0;t<this.allClientsOfThisBrowser.length;t++)this.allClientsOfThisBrowser[t]===e.clientId&&this.allClientsOfThisBrowser.splice(t,1)}else this.allClients.push(e.clientId),e.browserId===this.getBrowserId()&&this.allClientsOfThisBrowser.push(e.clientId),this.allClients.sort(),this.allClientsOfThisBrowser.sort();this._callOnEvent("otherdeviceauthen",e)}},{key:"_msgFromOtherDevice",value:function(e){var t=e.data;if("CALL_STATE"===e.type)(n=this.findCallByCallId(t.callId))&&(200===t.code&&(n.answeredOnAnotherDevice=!0),n._callOnEvent("otherdevice",{type:"CALL_STATE",code:t.code}),486===t.code||603===t.code?(n.ended=!0,n._freeResource(),n.onRemove()):200===t.code&&n._freeResource());else if("CALL_END"===e.type)(n=this.findCallByCallId(t.callId))&&(n.ended=!0,n._callOnEvent("otherdevice",{type:"CALL_END"}));else if("CALL2_STATE"===e.type){var n;(n=this.findCall2ByCallId(t.callId))&&(200===t.code&&(n.answeredOnAnotherDevice=!0),n._callOnEvent("otherdevice",{type:"CALL2_STATE",code:t.code}),486===t.code||603===t.code?(n.ended=!0,n.onRemove()):200===t.code&&(n.isAnswered=!0,n.onRemove()))}else console.log("===_msgFromOtherDevice: body="+JSON.stringify(e))}},{key:"sendChatOneToOneMsg",value:function(){}},{key:"on",value:function(e,t){this._onMethods.put(e,t)}},{key:"_callOnEvent",value:function(e,t){var n=this._onMethods.get(e);n?t?n.call(this,t):n.call(this):console.log("Please implement StringeeClient event: "+e)}},{key:"_genUuid",value:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}])&&Xe(t.prototype,n),r&&Xe(t,r),e}(),et=0,tt=1;var nt=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=t,this.userId=n,this.body=r,this.callback=i,this.expireTime=Date.now()+36e5},rt=0,it=1,ot=2,st=0,at=1,ct=2,lt=3,ut=4;var dt=function e(t,n,r,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),0===n?(this.id=t.id,this.localId=t.localDbId,this.convId=t.convId,this.sender=t.user,this.created=t.created,this.seq=t.seq,this.type=t.type,this.content=t.content,i>=t.seq?this.state=ut:r>=t.seq?this.state=lt:this.state=ct):1===n?(this.id=t.msgId,this.localId=t.localDbId,this.convId=t.convId,this.sender=t.from,this.created=t.createdTime,this.seq=t.seq,this.type=t.type,this.content=t.message,this.state=lt):2===n?(this.id=t.msgId,this.convId=t.convId,this.created=t.created,this.seq=t.seq,this.state=ct):3==n&&(0==o?(this.id=t.lastMsg.id,this.localId="",this.convId=t.convId,this.sender=t.lastMsg.user,this.created=t.lastMsg.created,this.seq=1,this.type=t.lastMsg.type,this.content=t.lastMsg.content,this.state=ut):1==o?(this.id=null!=t.lastMsgId?t.lastMsgId:"",this.localId="",this.convId=t.convId,this.sender=t.lastMsgSender,this.created=t.lastTimeNewMsg,this.seq=t.lastMsgSeqReceived,this.type=t.lastMsgType,this.content=t.lastMsg,t.lastMsgSeqReceived>t.lastMsgSeqSeen?this.state=lt:this.state=ut):2==o&&(this.id=null!=t.lastMsgId?t.lastMsgId:"",this.localId="",this.convId=t.convId,this.sender=null!=t.lastMsgSender?t.lastMsgSender:"",this.created=t.lastTimeNewMsg,this.seq=t.lastMsgSeqReceived,this.type=t.lastMsgType,this.content=t.lastMsg,t.lastMsgSeqReceived>t.lastMsgSeqSeen?this.state=lt:this.state=ut))};var ft=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.userId=t.user,this.name=t.displayName,this.avatar=t.avatarUrl,null!=t.lastMsgSeqReceived&&(this.lastMsgSeqReceived=t.lastMsgSeqReceived),null!=t.lastMsgSeqSeen&&(this.lastMsgSeqSeen=t.lastMsgSeqSeen)};var ht=function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),0===n){this.id=t.convId,this.name=t.lastMsg.content.groupName,this.isGroup=t.isGroup,this.updatedAt=t.lastUpdate,this.unreadCount=0,this.creator=t.lastMsg.content.creator,this.created=t.lastTimeNewMsg,this.pinMsgId=t.pinMsgId;var r=[];t.participants.forEach((function(e){var t=new ft(e);r.push(t)})),this.participants=r,this.lastMessage=new dt(t,3,0,0,n)}else if(1===n){this.id=t.convId,this.name=t.convName,this.isGroup=t.isGroup,this.updatedAt=t.lastUpdate,this.unreadCount=t.unread,this.creator=t.creator,this.created=t.created,this.pinMsgId=t.pinMsgId;r=[];t.participants.forEach((function(e){var t=new ft(e);r.push(t)})),this.participants=r,this.lastMessage=new dt(t,3,0,0,n)}else{this.id=t.convId,this.name=t.info.name,this.isGroup=t.info.isGroup,this.updatedAt=t.lastUpdate,this.unreadCount=0,this.creator=t.info.creator,this.created=t.info.created,this.pinMsgId=t.pinMsgId;r=[];t.participants.forEach((function(e){var t=new ft(e);r.push(t)})),this.participants=r,this.lastMessage=new dt(t,3,0,0,n)}};function vt(e){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){gt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _t=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;n.realTimeEvent="onObjectChange",n.pinMsgFromServerEvent="pinMsgFromServer",n.editMsgFromServerEvent="editMsgFromServer",n.userBeginTypingEvent="userBeginTypingListener",n.userEndTypingEvent="userEndTypingListener",n.revokeMsgFromServerEvent="revokeMsgFromServer",n.removeParticipantFromServerEvent="removeParticipantFromServer",n.addParticipantFromServerEvent="addParticipantFromServer",n.created=!1,n.client=t,n._onMethods=new c,n.trackingMap=new c,n.msgQueue=[],setInterval((function(){var e=Date.now();n.msgQueue=n.msgQueue.filter((function(t){return t.expireTime>e}))}),1e3),n.setupChatClient(n)}var t,n,r;return t=e,(n=[{key:"setupChatClient",value:function(e){e.client.on("authensuccess",(function(t){e.sendMessageQueue()})),e.client.on("chatmessage",(function(t){var n=new dt(t,1),r={lastMsgSeq:n.sequence,lastMsgTimestamp:n.createdAt,status:1,convId:n.conversationId};e.client._sendMessage(a.CHAT_MESSAGE_REPORT,r,(function(e){})),e.trackMsg(n),e.fireObjectChangeEvent(tt,[n],rt),null!=n.conversationId&&n.conversationId.length>0&&e.getConversationById(n.conversationId,(function(t,n,r,i){t&&null!=i&&e.fireObjectChangeEvent(et,[i],it)}))})),e.client.on("chatmessagestate",(function(t){var n=t.lastMsgSeq,r=t.status,i=(t.convId,e.trackingMap.allValues()),o=[];i.forEach((function(t){if(n>=t.sequence)if(2===r){t.state=ut,o.push(t);var i=e.keyForMsg(t);e.trackingMap.remove(i)}else 1===r&&t.state!==ut&&t.state!==lt&&(t.state=lt,o.push(t))})),o.length>0&&e.fireObjectChangeEvent(tt,o,it)})),e.client.on("pinMsgFromServer",(function(t){var n=t.convId,r=t.msgId,i=t.isPin;e._callOnEvent(e.pinMsgFromServerEvent,{convId:n,msgId:r,isPin:i})})),e.client.on("editMsgFromServer",(function(t){var n=t.convId,r=t.msgId;e._callOnEvent(e.editMsgFromServerEvent,{convId:n,msgId:r})})),e.client.on("revokeMsgFromServer",(function(t){var n=t.convId,r=t.msgIds;e._callOnEvent(e.revokeMsgFromServerEvent,{convId:n,msgIds:r})})),e.client.on("userBeginTypingListener",(function(t){e._callOnEvent(e.userBeginTypingEvent,t)})),e.client.on("userEndTypingListener",(function(t){e._callOnEvent(e.userEndTypingEvent,t)})),e.client.on(e.removeParticipantFromServerEvent,(function(t){e._callOnEvent(e.removeParticipantFromServerEvent,t)})),e.client.on(e.addParticipantFromServerEvent,(function(t){e._callOnEvent(e.addParticipantFromServerEvent,t)}))}},{key:"createConversation",value:function(e,t,n){var r=this;return new Promise((function(i,o){if(r.created)o({r:-1,message:"Could not create conversation, conversation is created"});else{if(void 0===e||null==e||null==e.length||0===e.length)return o({r:-1,message:"UserIds are invalid"}),void n.call(r.client,!1,-2,"UserIds are invalid",null);if(!r.client.hasConnected)return o({r:-1,message:"StringeeClient is not connected to Stringee server."}),void n.call(r.client,!1,-1,"StringeeClient is not connected to Stringee server.",null);var s;s=null==t.name||0===t.name.length?"":t.name;var c={distinct:t.isDistinct,isGroup:t.isGroup,name:s,participants:e};r.client._sendMessage(a.CHAT_CREATE_CONVERSATION,c,(function(e){var t=e.r,s=0===t||2===t;s&&(r.created=!0);var a=s?"Success":null!=e.message&&e.message.length>0?e.message:"Generic error.",c=s?new ht(e,t):null,l=0===t||2===t?0:e.r;n&&n.call(r.client,s,l,a,c),s||o(t),0===e.r?(e.objectType=et,e.objectChanges=[c],e.changeType=rt,i(e),r.fireObjectChangeEvent(et,[c],rt)):2===e.r&&(e.objectType=et,e.objectChanges=[c],e.changeType=it,i(e),r.fireObjectChangeEvent(et,[c],it))}))}}))}},{key:"getLastConversations",value:function(e,t,n){var r=this;if(e<=0)n.call(r.client,!1,-2,"Params are invalid.",null);else if(r.client.hasConnected){var i={lastUpdateGreater:0,lastUpdateSmaller:Number.MAX_SAFE_INTEGER,limit:e};r.client._sendMessage(a.CHAT_CONVERSATION_LOAD,i,(function(e){if(n){var i=0===e.r,o=e.r,s=i?"Success":null!=e.message&&e.message.length>0?e.message:"Generic error.",a=e.listConvs;return null!=a&&(a=t?a.reverse().map((function(e){return new ht(e,1)})):a.map((function(e){return new ht(e,1)}))),void n.call(r.client,i,o,s,a)}}))}else n.call(r.client,!1,-1,"StringeeClient is not connected to Stringee server.",null)}},{key:"getConversationsAfter",value:function(e,t,n,r){var i=this;if(t<=0||e<=0)r.call(i.client,!1,-2,"Params are invalid.",null);else if(i.client.hasConnected){var o={lastUpdateGreater:e,lastUpdateSmaller:Number.MAX_SAFE_INTEGER,limit:t};i.client._sendMessage(a.CHAT_CONVERSATION_LOAD,o,(function(e){if(r){var t=0===e.r,o=e.r,s=t?"Success":null!=e.message&&e.message.length>0?e.message:"Generic error.",a=e.listConvs;return null!=a&&(a=n?a.reverse().map((function(e){return new ht(e,1)})):a.map((function(e){return new ht(e,1)}))),void r.call(i.client,t,o,s,a)}}))}else r.call(i.client,!1,-1,"StringeeClient is not connected to Stringee server.",null)}},{key:"getConversationsBefore",value:function(e,t,n,r){var i=this;if(t<=0||e<=0)r.call(i.client,!1,-2,"Params are invalid.",null);else if(i.client.hasConnected){var o={lastUpdateGreater:0,lastUpdateSmaller:e,limit:t};i.client._sendMessage(a.CHAT_CONVERSATION_LOAD,o,(function(e){if(r){var t=0===e.r,o=e.r,s=t?"Success":null!=e.message&&e.message.length>0?e.message:"Generic error.",a=e.listConvs;return null!=a&&(a=n?a.reverse().map((function(e){return new ht(e,1)})):a.map((function(e){return new ht(e,1)}))),void r.call(i.client,t,o,s,a)}}))}else r.call(i.client,!1,-1,"StringeeClient is not connected to Stringee server.",null)}},{key:"getListConversations",value:function(e,t,n){var r=this;return new Promise((function(i,o){if(n<=0||t<=0)o({r:-2,msg:"Params are invalid."});else if(r.client.hasConnected){var s={lastUpdateGreater:e,lastUpdateSmaller:t,limit:n};r.client._sendMessage(a.CHAT_CONVERSATION_LOAD,s,(function(e){var t=e.r;if(0==t){var n=e.listConvs;null!=n&&(n=n.map((function(e){return new ht(e,1)}))),i(n)}else o({r:t,msg:e.message})}))}else o({r:-1,msg:"StringeeClient is not connected to Stringee server."})}))}},{key:"getConversationById",value:function(e,t){var n=this;return new Promise((function(r,i){if(!e)return i({r:-1,message:"Conversaion's Id is invalid"}),void t.call(n.client,!1,-2,"Conversaion's Id is invalid",conv);if(!n.client.hasConnected)return i({r:-1,message:"StringeeClient is not connected to Stringee server."}),void t.call(n.client,!1,-2,"StringeeClient is not connected to Stringee server.",conv);var o={convIds:e};n.client._sendMessage(a.CHAT_GET_CONVERSATIONS_INFO,o,(function(e){var o,s=e.r,a=0===s,c=e.r,l=a?"Success":null!=e.message&&e.message.length>0?e.message:"Generic error.",u=e.listConvs;null!=u&&u.length>0&&(o=new ht(u[0],1)),t&&t.call(n.client,a,c,l,o),0===s?r(mt(mt({},e),{},{conversation:o})):i(mt(mt({},e),{},{conversation:o}))}))}))}},{key:"deleteConversation",value:function(e,t){var n=this;if(e)if(n.client.hasConnected){var r={convIds:e};n.client._sendMessage(a.CHAT_GET_CONVERSATIONS_INFO,r,(function(r){if(t){var i=r.listConvs;if(null!=i&&i.length>0){var o=i[0],s={seq:o.convLastSeq,convId:e};n.client._sendMessage(a.CHAT_DELETE_CONVERSATION,s,(function(e){var r=e.r,i=0===r,s=r,a=i?"Success":null!=e.message&&e.message.length>0?e.message:"Generic error.";if(t.call(n.client,i,s,a),0===e.r){var c=new ht(o,1);n.fireObjectChangeEvent(et,[c],ot)}}))}else t.call(n.client,!1,-3,"Can not get conversation's info")}}))}else t.call(n.client,!1,-1,"StringeeClient is not connected to Stringee server.");else t.call(n.client,!1,-2,"Conversaion's Id is invalid")}},{key:"updateConversation",value:function(e,t,n){var r=this;if(e)if(r.client.hasConnected){var i={convId:e,groupName:t.name,imageUrl:t.avatar};r.client._sendMessage(a.CHAT_UPDATE_CONVERSATION,i,(function(t){if(n){var i=0===t.r,o=t.r,s=i?"Success":null!=t.message&&t.message.length>0?t.message:"Generic error.";n.call(r.client,i,o,s)}if(0===t.r){var c={convIds:e};r.client._sendMessage(a.CHAT_GET_CONVERSATIONS_INFO,c,(function(e){var t=e.listConvs;if(null!=t&&t.length>0){var n=t[0],i=new ht(n,1);r.fireObjectChangeEvent(et,[i],it)}}))}}))}else n.call(r.client,!1,-1,"StringeeClient is not connected to Stringee server.");else n.call(r.client,!1,-2,"Conversation's Id is invalid")}},{key:"addParticipants",value:function(e,t,n){var r=this;return new Promise((function(i,o){if(!e)return o({r:-1,message:"Conversation ID is invalid"}),void n.call(r.client,!1,-2,"Params are invalid.",null);if(!t||!t.length)return o({r:-1,message:"List of users is empty"}),void n.call(r.client,!1,-2,"Params are invalid.",null);if(!r.client.hasConnected)return o({r:-1,message:"StringeeClient is not connected to Stringee server."}),void n.call(r.client,!1,-1,"StringeeClient is not connected to Stringee server.",null);var s={convId:e,userIds:t};r.client._sendMessage(a.CHAT_ADD_PARTICIPANT,s,(function(t){if(n){var s=t.r,c=0===s,l=s,u=c?"Success":null!=t.message&&t.message.length>0?t.message:"Generic error.",d=t.added;null!=d&&(d=d.map((function(e){return new StringeeUser(e)}))),n.call(r.client,c,l,u,d)}if(0===t.r){var f={convIds:e};r.client._sendMessage(a.CHAT_GET_CONVERSATIONS_INFO,f,(function(e){var t=e.listConvs;if(null!=t&&t.length>0){var n=t[0],i=new ht(n,1);r.fireObjectChangeEvent(et,[i],it)}})),i(t)}else o(t)}))}))}},{key:"removeParticipants",value:function(e,t,n){var r=this;return new Promise((function(i,o){if(!e)return n.call(r.client,!1,-2,"Params are invalid.",null),void o({r:-1,message:"Conversation ID is not valid"});if(!t||!t.length)return n.call(r.client,!1,-2,"Params are invalid.",null),void o({r:-1,message:"list of user is empty"});if(!r.client.hasConnected)return n.call(r.client,!1,-1,"StringeeClient is not connected to Stringee server.",null),void o({r:-1,message:"StringeeClient is not connected to Stringee server."});var s={convId:e,userIds:t};r.client._sendMessage(a.CHAT_REMOVE_PARTICIPANT,s,(function(t){if(n){var s=t.r,c=0===s,l=s,u=c?"Success":null!=t.message&&t.message.length>0?t.message:"Generic error.",d=t.removed;null!=d&&(d=d.map((function(e){return new StringeeUser(e)}))),n.call(r.client,c,l,u,d)}if(0===t.r){var f={convIds:e};r.client._sendMessage(a.CHAT_GET_CONVERSATIONS_INFO,f,(function(e){var t=e.listConvs;if(null!=t&&t.length>0){var n=t[0],i=new ht(n,1);r.fireObjectChangeEvent(et,[i],it)}})),0===t.r?i(t):o(t)}}))}))}},{key:"sendMessage",value:function(e,t){var n=this;if(e.convId)if(n.client.hasConnected&&null!=n.client.userId)if("object"===vt(e.message)){var r=n.client.userId,i=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),o="web-"+r+"-"+i+"-"+Date.now().toString(),s={message:e.message,type:e.type,convId:e.convId,localDbId:o},c=new nt(o,r,s,t);n.msgQueue.push(c),console.log("start sending message");var l=new dt({},3);l.id=null,l.localId=o,l.conversationId=e.convId,l.sender=r,l.createdAt=Date.now(),l.type=e.type,l.content=e.message,l.state=st,n.trackMsg(l),n.fireObjectChangeEvent(tt,[l],rt),l.state=at,n.fireObjectChangeEvent(tt,[l],it),console.log("requesting send message"),n.client._sendMessage(a.CHAT_MESSAGE,s,(function(i){console.log("on chat message sent",i);var s=i.r,a=0===s,c=null;if(t&&9!==s){var l=i.r,u=a?"Success":null!=i.message&&i.message.length>0?i.message:"Generic error.";(c=new dt(i,2)).localId=o,c.type=e.type,c.content=e.message,c.sender=r,t.call(n.client,a,l,u,c)}var d=i.localDbId;if(null!=d&&a&&(n.msgQueue=n.msgQueue.filter((function(e){return e.id!==d}))),null!=c){var f=n.keyForMsg(c);n.trackingMap.remove(f),n.trackingMap.put(f,c),n.fireObjectChangeEvent(tt,[c],it)}}))}else t.call(n.client,!1,-100,"info.message is not Object.");else t.call(n.client,!1,-1,"StringeeClient is not connected to Stringee server.");else t.call(n.client,!1,-2,"Conversation's Id is invalid")}},{key:"sendMsg",value:function(e){var t=this;return new Promise((function(n,r){if(e.convId)if(t.client.hasConnected&&null!=t.client.userId)if("object"===vt(e.message)){var i=t.client.userId,o="web-"+i+"-"+(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15))+"-"+Date.now().toString(),s={message:e.message,type:e.type,convId:e.convId,localDbId:o},c=new dt({},3);c.id=null,c.localId=o,c.convId=e.convId,c.sender=i,c.created=Date.now(),c.type=e.type,c.content=e.message,t.client._sendMessage(a.CHAT_MESSAGE,s,(function(e){var t=e.r;console.log("res from server: "+JSON.stringify(e)),0==t?(c.id=e.msgId,c.seq=e.seq,c.created=e.created,n(c)):r({r:t,msg:e.message})}))}else r({r:-3,msg:"info.message is not Object."});else r({r:-2,msg:"StringeeClient is not connected to Stringee server."});else r({r:-1,msg:"Conversation's Id is invalid"})}))}},{key:"sendMessageQueue",value:function(){var e=this;if(e.msgQueue.length){var t=e.msgQueue[0];if(t.userId!=e.client.userId&&null!=e.client.userId)return t.callback&&t.callback.call(e.client,!1,-3,"Generic error.",null),void e.msgQueue.shift();e.client._sendMessage(a.CHAT_MESSAGE,t.body,(function(n){var r=n.r,i=0==r,o=n.r,s=i?"Success":null!=n.message&&n.message.length>0?n.message:"Generic error.",a=n.localDbId,c=null;if(i&&((c=new dt(n,2)).localId=a,c.type=t.body.type,c.content=t.body.message,c.sender=t.userId),t.callback&&9!=r&&t.callback.call(e.client,i,o,s,c),null!=a&&i&&(e.msgQueue=e.msgQueue.filter((function(e){return e.id!=a})),e.sendMessageQueue()),null!=c){var l=stringeeChat.keyForMsg(c);e.trackingMap.remove(l),e.trackingMap.put(l,c),e.fireObjectChangeEvent(tt,[c],it)}}))}}},{key:"loadChatMessages",value:function(e,t){var n=this,r={seqGreater:e.seqGreater,limit:e.limit,sort:e.sort,convId:e.convId};n.client._sendMessage(a.CHAT_MESSAGES_LOAD,r,(function(e){t&&t.call(n.client,e)}))}},{key:"loadAllChatMessages",value:function(e,t){var n=this,r=e.createdGreater,i=e.createdSmaller,o=e.limit,s=e.sort,c=e.convIds;if(Array.isArray(c)){var l={createdGreater:r,createdSmaller:i,sort:s,limit:o,convIds:c=c.join(",")};return new Promise((function(e,r){n.client._sendMessage(a.CHAT_LOAD_ALL_MESSAGES_FOR_CONVERSATIONS,l,(function(r){console.log("got data from server, ",r),t&&(console.log("got a valid callback"),t.call(n.client,r)),e(r)}))}))}console.log("must be an array")}},{key:"getListMessages",value:function(e,t,n,r,i){var o=this;return new Promise((function(s,c){if(!e||r<=0||n<0)c({r:-1,msg:"Params are invalid."});else if(o.client.hasConnected){var l={seqGreater:t,seqSmaller:n,limit:r,sort:i,convId:e};o.client._sendMessage(a.CHAT_MESSAGES_LOAD,l,(function(t){var n=t.r;if(0==n){var r=t.msgs;if(null!=r){var i={convIds:e};o.client._sendMessage(a.CHAT_GET_CONVERSATIONS_INFO,i,(function(e){var t=e.listConvs,n=0,i=0;if(null!=t&&t.length>0){var a=t[0];n=a.lastMsgSeqReceived,i=a.lastMsgSeqSeen}r=r.reverse().map((function(e){var t=new dt(e,0,n,i);return o.trackMsg(t),t})),s(r)}))}}else c({r:n,msg:t.message})}))}else c({r:-2,msg:"StringeeClient is not connected to Stringee server."})}))}},{key:"getLastMessages",value:function(e,t,n,r){var i=this;if(!e||t<0)r.call(i.client,!1,-2,"Params are invalid.",null);else if(i.client.hasConnected){var o=null!=t?t:50,s={seqGreater:0,seqSmaller:Number.MAX_SAFE_INTEGER,limit:o,sort:"DESC",convId:e};i.client._sendMessage(a.CHAT_MESSAGES_LOAD,s,(function(t){if(r){var o=0===t.r,s=t.r,c=o?"Success":null!=t.message&&t.message.length>0?t.message:"Generic error.",l=t.msgs;if(null!=l){var u={convIds:e};i.client._sendMessage(a.CHAT_GET_CONVERSATIONS_INFO,u,(function(e){var t=e.listConvs,a=0,u=0;if(null!=t&&t.length>0){var d=t[0];a=d.lastMsgSeqReceived,u=d.lastMsgSeqSeen}l=n?l.reverse().map((function(e){var t=new dt(e,0,a,u);return i.trackMsg(t),t})):l.map((function(e){var t=new dt(e,0,a,u);return i.trackMsg(t),t})),r.call(i.client,o,s,c,l)}))}}}))}else r.call(i.client,!1,-1,"StringeeClient is not connected to Stringee server.",null)}},{key:"getMessagesAfter",value:function(e,t,n,r,i){var o=this;if(!e||t<0||n<0)i.call(o.client,!1,-2,"Params are invalid.",null);else if(o.client.hasConnected){var s=null!=n?n:50,c={seqGreater:null!=t?t:0,seqSmaller:Number.MAX_SAFE_INTEGER,limit:s,sort:"ASC",convId:e};o.client._sendMessage(a.CHAT_MESSAGES_LOAD,c,(function(t){if(i){var n=0==t.r,s=t.r,c=n?"Success":null!=t.message&&t.message.length>0?t.message:"Generic error.",l=t.msgs;if(null!=l){var u={convIds:e};o.client._sendMessage(a.CHAT_GET_CONVERSATIONS_INFO,u,(function(e){var t=e.listConvs,a=0,u=0;if(null!=t&&t.length>0){var d=t[0];a=d.lastMsgSeqReceived,u=d.lastMsgSeqSeen}l=r?l.map((function(e){var t=new dt(e,0,a,u);return o.trackMsg(t),t})):l.reverse().map((function(e){var t=new dt(e,0,a,u);return o.trackMsg(t),t})),i.call(o.client,n,s,c,l)}))}}}))}else i.call(o.client,!1,-1,"StringeeClient is not connected to Stringee server.",null)}},{key:"getMessagesBefore",value:function(e,t,n,r,i){var o=this;if(!e||t<0||n<0)i.call(o.client,!1,-2,"Params are invalid.",null);else if(o.client.hasConnected){var s={seqGreater:0,seqSmaller:t,limit:null!=n?n:50,sort:"DESC",convId:e};o.client._sendMessage(a.CHAT_MESSAGES_LOAD,s,(function(t){if(i){var n=0==t.r,s=t.r,c=n?"Success":null!=t.message&&t.message.length>0?t.message:"Generic error.",l=t.msgs;if(null!=l){var u={convIds:e};o.client._sendMessage(a.CHAT_GET_CONVERSATIONS_INFO,u,(function(e){var t=e.listConvs,a=0,u=0;if(null!=t&&t.length>0){var d=t[0];a=d.lastMsgSeqReceived,u=d.lastMsgSeqSeen}l=r?l.reverse().map((function(e){var t=new dt(e,0,a,u);return o.trackMsg(t),t})):l.map((function(e){var t=new dt(e,0,a,u);return o.trackMsg(t),t})),i.call(o.client,n,s,c,l)}))}}}))}else i.call(o.client,!1,-1,"StringeeClient is not connected to Stringee server.",null)}},{key:"deleteMessage",value:function(e,t,n){var r=this;if(e)if(t)if(r.client.hasConnected){var i={msgIds:t,convId:e};r.client._sendMessage(a.CHAT_GET_MESSAGES_INFO,i,(function(i){if(0===i.r){var o=i.listMsgs;if(null!=o&&o.length>0){var s=o[0],c=new dt(s,0),l={convId:e,messageIds:[t]};r.client._sendMessage(a.CHAT_DELETE_MESSAGE,l,(function(e){if(n){var t=e.r,i=0==t,o=t,s=i?"Success":null!=e.message&&e.message.length>0?e.message:"Generic error.";n.call(r.client,i,o,s),r.fireObjectChangeEvent(tt,[c],ot)}}))}}else n.call(r.client,!1,-3,"Message is not found.")}))}else n.call(r.client,!1,-1,"StringeeClient is not connected to Stringee server.");else n.call(r.client,!1,-2,"Params are invalid.");else n.call(r.client,!1,-2,"Params are invalid.")}},{key:"clearHistory",value:function(e,t){var n=this;if(e.convId)if(n.client.hasConnected){var r={seq:e.sequence,convId:e.convId};n.client._sendMessage(a.CHAT_CONVERSATION_CLEAR_HISTORY,r,(function(e){if(t){var r=e.r,i=0===r,o=i?"Success":"Fail";t.call(n.client,i,r,o)}}))}else t.call(n.client,!1,-1,"StringeeClient is not connected to Stringee server.");else t.call(n.client,!1,-2,"Params are invalid.")}},{key:"markMessageSeen",value:function(e,t){var n=this;if(e.convId)if(n.client.hasConnected){var r={lastMsgSeq:e.sequence,lastMsgTimestamp:e.createdAt,status:2,convId:e.convId};n.client._sendMessage(a.CHAT_MESSAGE_REPORT,r,(function(e){if(t){var r=0==e.r,i=r?0:-3,o=r?"Success":"Generic error.";t.call(n.client,r,i,o)}}))}else t.call(n.client,!1,-1,"StringeeClient is not connected to Stringee server.");else t.call(n.client,!1,-2,"Params are invalid.")}},{key:"markConversationAsRead",value:function(e,t){var n=this;if(e)if(n.client.hasConnected){var r={convIds:e};n.client._sendMessage(a.CHAT_GET_CONVERSATIONS_INFO,r,(function(r){var i=r.listConvs;if(null!=i&&i.length>0){var o=i[0],s={lastMsgSeq:o.convLastSeq,lastMsgTimestamp:o.lastTimeNewMsg,status:2,convId:e};n.client._sendMessage(a.CHAT_MESSAGE_REPORT,s,(function(r){if(t){var i=0==r.r,o=i?0:-4,s=i?"Success":"Generic error.";t.call(n.client,i,o,s)}if(0===r.r){var a=n.trackingMap.allValues(),c=[];a.forEach((function(t){if(t.conversationId===e){t.state=ut,c.push(t);var r=n.keyForMsg(t);n.trackingMap.remove(r)}})),c.length>0&&n.fireObjectChangeEvent(tt,c,it),n.getConversationById(e,(function(e,t,r,i){e&&null!=i&&n.fireObjectChangeEvent(et,[i],it)}))}}))}else t&&t.call(n.client,!1,-3,"Can not get conversation's info")}))}else t.call(n.client,!1,-1,"StringeeClient is not connected to Stringee server.");else t.call(n.client,!1,-2,"Conversation's Id is invalid")}},{key:"getUnreadConversationCount",value:function(e){var t=this;t.client.hasConnected?t.client._sendMessage(a.CHAT_UNREAD_CONVERSATION_COUNT,{},(function(n){if(e){var r=0==n.r,i=r?0:-3,o=r?"Success":"Generic error.",s=n.count;e.call(t.client,r,i,o,s)}})):e.call(t.client,!1,-1,"StringeeClient is not connected to Stringee server.",null)}},{key:"getConversationWithUser",value:function(e,t){var n=this;if(e)if(n.client.userId&&n.client.hasConnected){var r={participants:[e,n.client.userId]};n.client._sendMessage(a.CHAT_CONVERSATION_FOR_USERS,r,(function(e){if(t){var r,i=0==e.r,o=i?0:-3,s=i?"Success":"Generic error.",a=e.conversations;if(a.length>0){var c=a[0];r=new ht(c,1),t.call(n.client,i,o,s,r)}else t.call(n.client,!1,-4,"Conversation is not found.",r)}}))}else t.call(n.client,!1,-1,"StringeeClient is not connected to Stringee server");else t.call(n.client,!1,-2,"UserId is invalid")}},{key:"blockUser",value:function(e,t){var n=this;if(e){var r={userId:e};n.client._sendMessage(a.CHAT_BLOCK_USER,r,(function(e){if(t){var r=e.r,i=0==r,o=i?"Success":"Fail";t.call(n.client,i,r,o)}}))}else t.call(n.client,!1,-1,"UserId is invalid")}},{key:"blockInviteToGroup",value:function(e,t){var n=this;if(e){var r={block_group_invite:e};n.client._sendMessage(a.CHAT_BLOCK_USER,r,(function(e){if(t){var r=e.r,i=0==r,o=i?"Success":"Fail";t.call(n.client,i,r,o)}}))}else t.call(n.client,!1,-1,"Conversation's Id is invalid")}},{key:"rateChat",value:function(e,t,n,r){var i=this,o={convId:e,rating:t,comment:n};i.client._sendMessage(a.RATE_CHAT,o,(function(e){r&&r.call(i.client,e)}))}},{key:"updateUserInfo",value:function(e,t){var n=this;n.client._sendMessage(a.UPDATE_USER_INFO,e,(function(e){t&&t.call(n.client,e)}))}},{key:"getUsersInfo",value:function(e,t){var n=this;if(e&&e.length)if(n.client.userId&&n.client.hasConnected){var r="";e.forEach((function(e){0==r.length?r+=e:r+=", "+e}));var i={userIds:r};n.client._sendMessage(a.CHAT_GET_USERS_INFO,i,(function(e){if(t){var r=e.r,i=0==r,o=i?"Success":"Fail.",s=e.users,a=[];return s.forEach((function(e){var t=new StringeeUser(e);t.userId=e.userId,a.push(t)})),void t.call(n.client,i,r,o,a)}}))}else t.call(n.client,!1,-1,"StringeeClient is not connected to Stringee server",null);else t.call(n.client,!1,-2,"UserIds are invalid.",null)}},{key:"sendEmailTranscript",value:function(e,t){var n=this,r={convId:e.convId,email:e.email,domain:e.domain};n.client._sendMessage(a.SEND_EMAIL_TRANSCRIPT,r,(function(e){t&&t.call(n.client,e)}))}},{key:"getChatServices",value:function(e){var t=this;t.client._sendMessage(a.GET_CHAT_SERVICES,{},(function(n){e&&e.call(t.client,n)}))}},{key:"viewChat",value:function(e,t){var n=this,r={convId:e};n.client._sendMessage(a.VIEW_CHAT,r,(function(e){t&&t.call(n.client,e)}))}},{key:"joinChat",value:function(e,t){var n=this,r={convId:e};n.client._sendMessage(a.JOIN_CHAT_CUSTOMER_CARE,r,(function(e){t&&t.call(n.client,e)}))}},{key:"transferChat",value:function(e,t,n){var r=this,i={convId:e,customerId:t.customerId,customerName:t.customerName,toUserId:t.toUserId};r.client._sendMessage(a.CHAT_TRANSFER_TO_ANOTHER_AGENT,i,(function(e){n&&n.call(r.client,e)}))}},{key:"confirmTransferChat",value:function(e,t){var n=this,r={convId:e,answer:1};n.client._sendMessage(a.CHAT_CONFIRM_TRANSFER_REQUEST,r,(function(e){t&&t.call(n.client,e)}))}},{key:"pinMessage",value:function(e,t,n,r){var i=this;if(i.isString(e)&&i.isString(t)&&""!==e&&""!==t&&null!=n)if(i.client.userId&&i.client.hasConnected){var o={convId:e,msgId:t,isPin:n};i.client._sendMessage(a.CHAT_PIN_MESSAGE,o,(function(e){if(r){var t=e.r,n=0==t,o=e.message;r.call(i.client,n,t,o)}}))}else r.call(i.client,!1,-1,"StringeeClient is not connected to Stringee server");else r.call(i.client,!1,-2,"Params are invalid")}},{key:"editMessage",value:function(e,t,n,r){var i=this;if(i.isString(e)&&i.isString(t)&&i.isString(n)&&""!==e&&""!==t&&""!==n)if(i.client.userId&&i.client.hasConnected){var o={content:n},s={convId:e,msgId:t,newContent:JSON.stringify(o)};i.client._sendMessage(a.CHAT_EDIT_MESSAGE,s,(function(e){if(r){var t=e.r,n=0==t,o=e.message;r.call(i.client,n,t,o)}}))}else r.call(i.client,!1,-1,"StringeeClient is not connected to Stringee server");else r.call(i.client,!1,-2,"Params are invalid")}},{key:"revokeMessage",value:function(e,t,n){var r=this;if(r.isString(e)&&r.isString(t)&&""!==e&&""!==t)if(r.client.userId&&r.client.hasConnected){var i={convId:e,msgIds:[t]};r.client._sendMessage(a.CHAT_REVOKE_MESSAGE,i,(function(e){if(n){var t=e.r,i=0==t,o=e.message;n.call(r.client,i,t,o)}}))}else n.call(r.client,!1,-1,"StringeeClient is not connected to Stringee server");else n.call(r.client,!1,-2,"Params are invalid")}},{key:"userBeginTyping",value:function(e,t){var n=this,r={userId:e.userId,convId:e.convId};n.client._sendMessage(a.CHAT_USER_BEGIN_TYPING,r,(function(e){t&&t.call(n.client,e)}))}},{key:"userEndTyping",value:function(e,t){var n=this,r={userId:e.userId,convId:e.convId};n.client._sendMessage(a.CHAT_USER_END_TYPING,r,(function(e){t&&t.call(n.client,e)}))}},{key:"getAttachmentMessages",value:function(e,t,n,r,i){var o=this;if(o.isString(e)&&""!==e&&null!=t&&0!==t&&null!=r&&0!==r)if(o.client.userId&&o.client.hasConnected){var s={convId:e,msgType:t,limit:r,start:n};o.client._sendMessage(a.CHAT_CONVERSATION_ATTACHMENT,s,(function(e){if(i){var t=e.r,n=0==t,r=e.message,s=n?e.msgs:null;i.call(o.client,n,t,r,s)}}))}else i.call(o.client,!1,-1,"StringeeClient is not connected to Stringee server",null);else i.call(o.client,!1,-2,"Params are invalid",null)}},{key:"on",value:function(e,t){this._onMethods.put(e,t)}},{key:"_callOnEvent",value:function(e,t){var n=this._onMethods.get(e);n?t?n.call(this,t):n.call(this):console.log("Please implement StringeeChat event: "+e)}},{key:"fireObjectChangeEvent",value:function(e,t,n){this._callOnEvent(this.realTimeEvent,{objectType:e,objectChanges:t,changeType:n})}},{key:"trackMsg",value:function(e){if(e.state!==ut){var t=this.keyForMsg(e);this.trackingMap.put(t,e)}}},{key:"keyForMsg",value:function(e){var t=null!=e.conversationId&&e.conversationId.length>0?e.conversationId:"",n=null!=e.id&&e.id.length>0?e.id:"",r=null!=e.localId&&e.localId.length>0?e.localId:"";return t+"_"+(r.length>0?r:n)}},{key:"isString",value:function(e){var t=vt(e);return"string"===t||"object"===t&&null!=e&&!Array.isArray(e)&&"[object String]"==getTag(e)}}])&&yt(t.prototype,n),r&&yt(t,r),e}();function St(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ct=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.client=t}var t,n,r;return t=e,(n=[{key:"createConversation",value:function(e,t){this.created?console.log("Could not create conversation, conversation is created"):this.client._sendMessage(a.CHAT_CREATE_CONVERSATION,e,(function(e){t&&t.call(this.client,e)}))}},{key:"sendChatMessage",value:function(e,t){var n={message:e.message,type:e.type,convId:e.convId};this.client._sendMessage(a.CHAT_MESSAGE,n,(function(e){t&&t.call(this.client,e)}))}},{key:"loadChatMessages",value:function(e,t){var n={seqGreater:e.seqGreater,limit:e.limit,sort:e.sort,convId:e.convId};this.client._sendMessage(a.CHAT_MESSAGES_LOAD,n,(function(e){t&&t.call(this.client,e)}))}},{key:"loadAllChatMessages",value:function(e,t){var n=this,r=e.createdGreater,i=e.createdSmaller,o=e.limit,s=e.sort,c=e.convIds;if(Array.isArray(c)){var l={createdGreater:r,createdSmaller:i,sort:s,limit:o,convIds:c=c.join(",")};return new Promise((function(e,r){n.client._sendMessage(a.CHAT_LOAD_ALL_MESSAGES_FOR_CONVERSATIONS,l,(function(r){console.log("got data from server, ",r),t&&(console.log("got a valid callback"),t.call(n.client,r)),e(r)}))}))}console.log("must be an array")}},{key:"addParticipant",value:function(e,t){var n={convId:e.convId,userIds:e.userIds};this.client._sendMessage(a.CHAT_ADD_PARTICIPANT,n,(function(e){t&&t.call(this.client,e)}))}},{key:"removeParticipant",value:function(e,t){var n={convId:e.convId,userIds:e.userIds};this.client._sendMessage(a.CHAT_REMOVE_PARTICIPANT,n,(function(e){t&&t.call(this.client,e)}))}},{key:"deleteMessage",value:function(e,t){var n={convId:e.convId,messageIds:e.messageIds};this.client._sendMessage(a.CHAT_DELETE_MESSAGE,n,(function(e){t&&t.call(this.client,e)}))}},{key:"updateConversation",value:function(e,t){var n={convId:e.convId,groupName:e.name,imageUrl:e.imageUrl};this.client._sendMessage(a.CHAT_UPDATE_CONVERSATION,n,(function(e){t&&t.call(this.client,e)}))}},{key:"deleteConversation",value:function(e,t){var n={seq:e.seq,convId:e.convId};this.client._sendMessage(a.CHAT_DELETE_CONVERSATION,n,(function(e){t&&t.call(this.client,e)}))}},{key:"clearHistory",value:function(e,t){var n={seq:e.seq,convId:e.convId};this.client._sendMessage(a.CHAT_CONVERSATION_CLEAR_HISTORY,n,(function(e){t&&t.call(this.client,e)}))}},{key:"loadConversations",value:function(e,t){var n={lastUpdateGreater:e.lastUpdateGreater,lastUpdateSmaller:e.lastUpdateSmaller,limit:e.limit};this.client._sendMessage(a.CHAT_CONVERSATION_LOAD,n,(function(e){t&&t.call(this.client,e)}))}},{key:"getInfo",value:function(e,t){var n={convIds:e};this.client._sendMessage(a.CHAT_GET_CONVERSATIONS_INFO,n,(function(e){t&&t.call(this.client,e)}))}},{key:"markMessageReceived",value:function(e,t){var n={lastMsgSeq:e.seq,lastMsgTimestamp:e.createdTime,status:1,convId:e.convId};this.client._sendMessage(a.CHAT_MESSAGE_REPORT,n,(function(e){t&&t.call(this.client,e)}))}},{key:"markMessageSeen",value:function(e,t){var n={lastMsgSeq:e.seq,lastMsgTimestamp:e.createdTime,status:2,convId:e.convId};this.client._sendMessage(a.CHAT_MESSAGE_REPORT,n,(function(e){t&&t.call(this.client,e)}))}},{key:"blockUser",value:function(e,t){var n={userId:e};this.client._sendMessage(a.CHAT_BLOCK_USER,n,(function(e){t&&t.call(this.client,e)}))}},{key:"blockInviteToGroup",value:function(e,t){var n={block_group_invite:e};this.client._sendMessage(a.CHAT_BLOCK_USER,n,(function(e){t&&t.call(this.client,e)}))}},{key:"rateChat",value:function(e,t,n,r){var i={convId:e,rating:t,comment:n};this.client._sendMessage(a.RATE_CHAT,i,(function(e){r&&r.call(this.client,e)}))}},{key:"updateUserInfo",value:function(e,t){this.client._sendMessage(a.UPDATE_USER_INFO,e,(function(e){t&&t.call(this.client,e)}))}},{key:"userBeginTyping",value:function(e,t){var n={userId:e.userId,convId:e.convId};this.client._sendMessage(a.CHAT_USER_BEGIN_TYPING,n,(function(e){t&&t.call(this.client,e)}))}},{key:"userEndTyping",value:function(e,t){var n={userId:e.userId,convId:e.convId};this.client._sendMessage(a.CHAT_USER_END_TYPING,n,(function(e){t&&t.call(this.client,e)}))}},{key:"getUsersInfo",value:function(e,t){var n={userIds:e};this.client._sendMessage(a.CHAT_GET_USERS_INFO,n,(function(e){t&&t.call(this.client,e)}))}},{key:"sendEmailTranscript",value:function(e,t){var n={convId:e.convId,email:e.email,domain:e.domain};this.client._sendMessage(a.SEND_EMAIL_TRANSCRIPT,n,(function(e){t&&t.call(this.client,e)}))}},{key:"getChatServices",value:function(e){this.client._sendMessage(a.GET_CHAT_SERVICES,{},(function(t){e&&e.call(this.client,t)}))}},{key:"viewChat",value:function(e,t){var n={convId:e};this.client._sendMessage(a.VIEW_CHAT,n,(function(e){t&&t.call(this.client,e)}))}},{key:"joinChat",value:function(e,t){var n={convId:e};this.client._sendMessage(a.JOIN_CHAT_CUSTOMER_CARE,n,(function(e){t&&t.call(this.client,e)}))}},{key:"transferChat",value:function(e,t){var n={convId:e.conversationId,customerId:e.customerId,customerName:e.customerName,toUserId:e.toUserId};this.client._sendMessage(a.CHAT_TRANSFER_TO_ANOTHER_AGENT,n,(function(e){t&&t.call(this.client,e)}))}},{key:"confirmTransferChat",value:function(e,t){var n={convId:e.convId,answer:e.answer};console.log("+++ confirmTransferChat",n),this.client._sendMessage(a.CHAT_CONFIRM_TRANSFER_REQUEST,n,(function(e){t&&t.call(this.client,e)}))}},{key:"unreadConversationCount",value:function(e){this.client._sendMessage(a.CHAT_UNREAD_CONVERSATION_COUNT,{},(function(t){e&&e.call(this.client,t)}))}},{key:"resolveConversation",value:function(e,t){var n={convId:e.convId,resolved:e.resolved};console.log("+++ resolveConversation",n),this.client._sendMessage(a.CHAT_AGENT_RESOLVE_CONVERSATION,n,(function(e){t&&t.call(this.client,e)}))}}])&&St(t.prototype,n),r&&St(t,r),e}();function Et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var It=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"isWebRTCSupported",value:function(){return!(!navigator||"undefined"==typeof navigator||!navigator.mediaDevices||void 0===navigator.mediaDevices||!navigator.mediaDevices.getUserMedia||void 0===navigator.mediaDevices.getUserMedia)}},{key:"getActiveClientId",value:function(){return localStorage.getItem("active_client_id")}},{key:"version",value:function(){return{version:"2.5.5",build:"2"}}}],(n=null)&&Et(t.prototype,n),r&&Et(t,r),e}();window.StringeeChat2=Je,window.StringeeCall=pe,window.StringeeCall2=Pe,window.StringeeChat=_t,window.StringeeHashMap=c,window.DeprecatedStringeeChat=Ct,window.StringeeClient=Ze,window.StringeeUtil=It,window.StringeeServiceType=a,window.StringeeWebRtc=Se,window.StringeeVideo=we,window.StringeeVideoRoom=Oe,window.StringeeVideoTrack=Te,window.SubscribedTrackDisplay=function e(t,n,r,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.trackId=t.serverId,this.displayVideo=n,this.isMainTrack=r,this.displayView={width:i,height:o}}}]);